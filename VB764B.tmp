VERSION 5.00
Object = "{F0D2F211-CCB0-11D0-A316-00AA00688B10}#1.0#0"; "msdatlst.ocx"
Object = "{86CF1D34-0C5F-11D2-A9FC-0000F8754DA1}#2.0#0"; "mscomct2.ocx"
Object = "{38911DA0-E448-11D0-84A3-00DD01104159}#1.1#0"; "COMCT332.OCX"
Object = "{0ECD9B60-23AA-11D0-B351-00A0C9055D8E}#6.0#0"; "mshflxgd.ocx"
Object = "{C932BA88-4374-101B-A56C-00AA003668DC}#1.1#0"; "MSMASK32.OCX"
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.1#0"; "mscomctl.OCX"
Begin VB.Form FrmCompras 
   BorderStyle     =   0  'None
   Caption         =   "Form1"
   ClientHeight    =   9225
   ClientLeft      =   0
   ClientTop       =   0
   ClientWidth     =   17400
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MDIChild        =   -1  'True
   MinButton       =   0   'False
   ScaleHeight     =   9225
   ScaleWidth      =   17400
   ShowInTaskbar   =   0   'False
   Begin VB.Frame FrameCaracteristicas 
      BackColor       =   &H00FFFFFF&
      Height          =   6135
      Left            =   9540
      TabIndex        =   147
      Top             =   705
      Visible         =   0   'False
      Width           =   6855
      Begin VB.TextBox txtChasisG 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0FFC0&
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   4800
         TabIndex        =   180
         Top             =   4320
         Visible         =   0   'False
         Width           =   1575
      End
      Begin VB.TextBox txtMotorG 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0FFC0&
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   4800
         TabIndex        =   179
         Top             =   4680
         Visible         =   0   'False
         Width           =   1575
      End
      Begin VB.TextBox txtnumeroserie 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0FFC0&
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   2040
         TabIndex        =   148
         Top             =   3960
         Width           =   2655
      End
      Begin VB.TextBox txtseriemotor 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0FFC0&
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   2040
         TabIndex        =   149
         Top             =   4680
         Width           =   2655
      End
      Begin VB.TextBox txtseriechasis 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0FFC0&
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   2040
         TabIndex        =   150
         Top             =   4320
         Width           =   2655
      End
      Begin VB.TextBox txtitemdua 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0FFC0&
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   2040
         TabIndex        =   151
         Top             =   5040
         Width           =   2655
      End
      Begin VitekeySoft.ChameleonBtn cmdprocesar 
         Height          =   345
         Left            =   2040
         TabIndex        =   152
         Top             =   5520
         Width           =   1335
         _ExtentX        =   2355
         _ExtentY        =   609
         BTYPE           =   5
         TX              =   "PROCESAR"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Tahoma"
            Size            =   6.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   1
         FOCUSR          =   -1  'True
         BCOL            =   14215660
         BCOLO           =   14215660
         FCOL            =   0
         FCOLO           =   0
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "FrmCompra1.frx":0000
         PICN            =   "FrmCompra1.frx":001C
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin MSHierarchicalFlexGridLib.MSHFlexGrid HfItem 
         Height          =   3735
         Left            =   240
         TabIndex        =   153
         Top             =   120
         Width           =   6495
         _ExtentX        =   11456
         _ExtentY        =   6588
         _Version        =   393216
         ForeColor       =   8388608
         FixedCols       =   0
         ForeColorFixed  =   8388608
         ForeColorSel    =   16777215
         BackColorBkg    =   16777215
         GridColor       =   -2147483635
         SelectionMode   =   1
         Appearance      =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         _NumberOfBands  =   1
         _Band(0).Cols   =   2
      End
      Begin VitekeySoft.ChameleonBtn cmdcerrarpantalla 
         Height          =   345
         Left            =   3480
         TabIndex        =   154
         Top             =   5520
         Width           =   1215
         _ExtentX        =   2143
         _ExtentY        =   609
         BTYPE           =   5
         TX              =   "CERRAR"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Tahoma"
            Size            =   6.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   1
         FOCUSR          =   -1  'True
         BCOL            =   14215660
         BCOLO           =   14215660
         FCOL            =   0
         FCOLO           =   0
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "FrmCompra1.frx":05B6
         PICN            =   "FrmCompra1.frx":05D2
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin VB.Label Label50 
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         Caption         =   "VIN  :"
         BeginProperty Font 
            Name            =   "Calibri"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   210
         Left            =   825
         TabIndex        =   158
         Top             =   4080
         Width           =   405
      End
      Begin VB.Label Label51 
         BackStyle       =   0  'Transparent
         Caption         =   "N° MOTOR :"
         BeginProperty Font 
            Name            =   "Calibri"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   165
         Left            =   345
         TabIndex        =   157
         Top             =   4800
         Width           =   900
      End
      Begin VB.Label Label52 
         BackStyle       =   0  'Transparent
         Caption         =   "N° CHASIS :"
         BeginProperty Font 
            Name            =   "Calibri"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   165
         Left            =   330
         TabIndex        =   156
         Top             =   4440
         Width           =   915
      End
      Begin VB.Label Label57 
         BackStyle       =   0  'Transparent
         Caption         =   "ITEM :"
         BeginProperty Font 
            Name            =   "Calibri"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   165
         Left            =   750
         TabIndex        =   155
         Top             =   5160
         Width           =   495
      End
   End
   Begin VB.Frame Frame_Relacionado 
      Appearance      =   0  'Flat
      BackColor       =   &H00FFFFFF&
      Caption         =   "COMPROBANTE RELACIONADO"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000C0&
      Height          =   1455
      Left            =   13320
      TabIndex        =   8
      Top             =   735
      Visible         =   0   'False
      Width           =   4455
      Begin VB.TextBox TxtFechaEmision 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   285
         Left            =   2040
         MaxLength       =   80
         TabIndex        =   139
         Top             =   1080
         Width           =   2295
      End
      Begin VB.TextBox TxtNumeroR 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   285
         Left            =   2805
         MaxLength       =   80
         TabIndex        =   10
         Top             =   360
         Width           =   1455
      End
      Begin VB.TextBox TxtSerieR 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   285
         Left            =   2040
         MaxLength       =   80
         TabIndex        =   9
         Top             =   360
         Width           =   735
      End
      Begin MSDataListLib.DataCombo DtcRelacionado 
         Height          =   315
         Left            =   120
         TabIndex        =   11
         Top             =   360
         Width           =   1815
         _ExtentX        =   3201
         _ExtentY        =   556
         _Version        =   393216
         Appearance      =   0
         Style           =   2
         ForeColor       =   8388608
         Text            =   "DataCombo1"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin MSDataListLib.DataCombo DtcProveedor 
         Height          =   315
         Left            =   120
         TabIndex        =   12
         Top             =   720
         Width           =   4215
         _ExtentX        =   7435
         _ExtentY        =   556
         _Version        =   393216
         Appearance      =   0
         Style           =   2
         ForeColor       =   8388608
         Text            =   "DataCombo1"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.Label Label49 
         Alignment       =   2  'Center
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         Caption         =   "FECHA EMISION :"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   195
         Left            =   195
         TabIndex        =   138
         Top             =   1080
         Width           =   1305
      End
      Begin VB.Label lblProveedor 
         BackStyle       =   0  'Transparent
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   210
         Left            =   240
         TabIndex        =   13
         Top             =   600
         Width           =   4020
      End
   End
   Begin VB.Frame framedua 
      BackColor       =   &H00FFFFFF&
      Height          =   2415
      Left            =   11520
      TabIndex        =   168
      Top             =   2640
      Visible         =   0   'False
      Width           =   4575
      Begin VB.TextBox txtañomodelo 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   2145
         TabIndex        =   172
         Top             =   1515
         Width           =   975
      End
      Begin VB.TextBox txtaniodua 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   2145
         TabIndex        =   171
         Top             =   1155
         Width           =   975
      End
      Begin VB.TextBox txtnumero_dua 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   2160
         TabIndex        =   170
         Top             =   795
         Width           =   975
      End
      Begin VB.TextBox txtañofabricacion 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   2145
         TabIndex        =   169
         Top             =   360
         Width           =   975
      End
      Begin VitekeySoft.ChameleonBtn cmdcerrardua 
         Height          =   345
         Left            =   1680
         TabIndex        =   178
         Top             =   1920
         Width           =   1935
         _ExtentX        =   3413
         _ExtentY        =   609
         BTYPE           =   5
         TX              =   "CERRAR"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Tahoma"
            Size            =   6.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   1
         FOCUSR          =   -1  'True
         BCOL            =   14215660
         BCOLO           =   14215660
         FCOL            =   0
         FCOLO           =   0
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "FrmCompra1.frx":35E7
         PICN            =   "FrmCompra1.frx":3603
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin VB.Label Label56 
         BackStyle       =   0  'Transparent
         Caption         =   "AÑO MODELO :"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   165
         Left            =   705
         TabIndex        =   176
         Top             =   1515
         Width           =   1140
      End
      Begin VB.Label Label55 
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         Caption         =   "AÑO DUA  :"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   165
         Left            =   990
         TabIndex        =   175
         Top             =   1155
         Width           =   855
      End
      Begin VB.Label Label54 
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         Caption         =   "N° DUA :"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   165
         Left            =   1200
         TabIndex        =   174
         Top             =   795
         Width           =   645
      End
      Begin VB.Label Label53 
         BackStyle       =   0  'Transparent
         Caption         =   "AÑO FABRICACION :"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   165
         Left            =   240
         TabIndex        =   173
         Top             =   435
         Width           =   1605
      End
   End
   Begin VB.TextBox txtdua 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H0080FFFF&
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   11760
      TabIndex        =   166
      Top             =   8760
      Width           =   855
   End
   Begin VitekeySoft.ChameleonBtn CMDCONSULTADUA 
      Height          =   315
      Left            =   12600
      TabIndex        =   165
      Top             =   8760
      Width           =   1575
      _ExtentX        =   2778
      _ExtentY        =   556
      BTYPE           =   3
      TX              =   "CONSULTA DUA"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   6.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   1
      FOCUSR          =   -1  'True
      BCOL            =   14215660
      BCOLO           =   14215660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "FrmCompra1.frx":6618
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin VB.CheckBox chkConvertir 
      Appearance      =   0  'Flat
      BackColor       =   &H008080FF&
      Caption         =   "CONVERTIR"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   6.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   255
      Left            =   9600
      TabIndex        =   160
      ToolTipText     =   "CONVERTIR A MONEDA NACIONAL"
      Top             =   2280
      Visible         =   0   'False
      Width           =   1335
   End
   Begin VitekeySoft.ChameleonBtn CmdQuitar 
      Height          =   375
      Left            =   15840
      TabIndex        =   144
      ToolTipText     =   "ELIMINAR ITEM"
      Top             =   6240
      Width           =   405
      _ExtentX        =   714
      _ExtentY        =   661
      BTYPE           =   5
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   1
      FOCUSR          =   -1  'True
      BCOL            =   14215660
      BCOLO           =   14215660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "FrmCompra1.frx":6634
      PICN            =   "FrmCompra1.frx":6650
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin VitekeySoft.ChameleonBtn cmdActivar 
      Height          =   375
      Left            =   4560
      TabIndex        =   143
      Top             =   360
      Width           =   1455
      _ExtentX        =   2566
      _ExtentY        =   661
      BTYPE           =   5
      TX              =   "ACTIVAR"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   6.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   1
      FOCUSR          =   -1  'True
      BCOL            =   14215660
      BCOLO           =   14215660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "FrmCompra1.frx":6BEA
      PICN            =   "FrmCompra1.frx":6C06
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin VB.TextBox txtIdCompra 
      Appearance      =   0  'Flat
      Height          =   285
      Left            =   6960
      TabIndex        =   142
      Top             =   3360
      Visible         =   0   'False
      Width           =   1575
   End
   Begin VitekeySoft.ChameleonBtn cmdGastos 
      Height          =   375
      Left            =   14400
      TabIndex        =   140
      Top             =   8640
      Width           =   1335
      _ExtentX        =   2355
      _ExtentY        =   661
      BTYPE           =   3
      TX              =   "+ GASTOS"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   6.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   1
      FOCUSR          =   -1  'True
      BCOL            =   14215660
      BCOLO           =   14215660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "FrmCompra1.frx":8E5F
      PICN            =   "FrmCompra1.frx":8E7B
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin VB.TextBox lblotros 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   4320
      TabIndex        =   132
      Text            =   "0.000"
      Top             =   8760
      Width           =   1110
   End
   Begin VB.TextBox lblgastos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   15840
      Locked          =   -1  'True
      TabIndex        =   130
      Text            =   "0.00"
      Top             =   8280
      Width           =   1455
   End
   Begin VB.TextBox lblImportacion 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   15840
      Locked          =   -1  'True
      TabIndex        =   129
      Text            =   "0.00"
      Top             =   7920
      Width           =   1455
   End
   Begin VB.TextBox lblExonerado 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   9720
      TabIndex        =   125
      Text            =   "0.00"
      Top             =   8580
      Width           =   1815
   End
   Begin VB.TextBox TxtValorventa 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H0080C0FF&
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   7785
      MaxLength       =   80
      TabIndex        =   123
      Text            =   "0.00"
      Top             =   7320
      Width           =   735
   End
   Begin VB.Frame Frame4 
      Height          =   3015
      Left            =   17400
      TabIndex        =   103
      Top             =   1320
      Width           =   16215
      Begin VB.CommandButton cmdcerrar 
         Caption         =   "x"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   15480
         TabIndex        =   121
         Top             =   120
         Width           =   375
      End
      Begin VB.TextBox TxtNumeroG 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   315
         Left            =   3765
         MaxLength       =   80
         TabIndex        =   112
         Top             =   480
         Width           =   1190
      End
      Begin VB.TextBox TxtSerieG 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   315
         Left            =   3120
         MaxLength       =   80
         TabIndex        =   111
         Top             =   480
         Width           =   615
      End
      Begin VB.TextBox TxtTransporte 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   285
         Left            =   1560
         MaxLength       =   80
         TabIndex        =   110
         Top             =   870
         Width           =   3375
      End
      Begin VB.TextBox TxtChofer 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   285
         Left            =   1560
         MaxLength       =   80
         TabIndex        =   109
         Top             =   1200
         Width           =   3375
      End
      Begin VB.TextBox TxtLicencia 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   285
         Left            =   1560
         MaxLength       =   80
         TabIndex        =   108
         Top             =   1515
         Width           =   1695
      End
      Begin VB.TextBox TxtInicial 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   285
         Left            =   1560
         MaxLength       =   80
         TabIndex        =   107
         Top             =   1845
         Width           =   1215
      End
      Begin VB.TextBox TxtFinal 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   285
         Left            =   2880
         MaxLength       =   80
         TabIndex        =   106
         Top             =   1845
         Width           =   1215
      End
      Begin VB.TextBox Txtrecorrido 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0FFFF&
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   285
         Left            =   4200
         MaxLength       =   80
         TabIndex        =   105
         Top             =   1845
         Width           =   975
      End
      Begin VB.TextBox TxtDias 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0FFFF&
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   285
         Left            =   4200
         MaxLength       =   80
         TabIndex        =   104
         Top             =   1515
         Width           =   975
      End
      Begin MSDataListLib.DataCombo DtcDocumento 
         Height          =   315
         Left            =   240
         TabIndex        =   113
         Top             =   480
         Width           =   2775
         _ExtentX        =   4895
         _ExtentY        =   556
         _Version        =   393216
         Appearance      =   0
         Style           =   2
         ForeColor       =   8388608
         Text            =   "DataCombo1"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin MSHierarchicalFlexGridLib.MSHFlexGrid HfPersonal 
         Height          =   1815
         Left            =   5400
         TabIndex        =   119
         Top             =   360
         Width           =   5175
         _ExtentX        =   9128
         _ExtentY        =   3201
         _Version        =   393216
         ForeColor       =   8388608
         FixedCols       =   0
         ForeColorFixed  =   8388608
         ForeColorSel    =   16777215
         GridColor       =   -2147483635
         SelectionMode   =   1
         Appearance      =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         _NumberOfBands  =   1
         _Band(0).Cols   =   2
      End
      Begin MSHierarchicalFlexGridLib.MSHFlexGrid HfGastos 
         Height          =   1815
         Left            =   10680
         TabIndex        =   120
         Top             =   360
         Width           =   5175
         _ExtentX        =   9128
         _ExtentY        =   3201
         _Version        =   393216
         ForeColor       =   8388608
         FixedCols       =   0
         ForeColorFixed  =   8388608
         ForeColorSel    =   16777215
         GridColor       =   -2147483635
         SelectionMode   =   1
         Appearance      =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         _NumberOfBands  =   1
         _Band(0).Cols   =   2
      End
      Begin VB.Label Label37 
         Alignment       =   2  'Center
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         Caption         =   "TRANSPORTE:"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   195
         Left            =   225
         TabIndex        =   118
         Top             =   960
         Width           =   1155
      End
      Begin VB.Label Label38 
         Alignment       =   2  'Center
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         Caption         =   "CHOFER:"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   195
         Left            =   675
         TabIndex        =   117
         Top             =   1275
         Width           =   705
      End
      Begin VB.Label Label39 
         Alignment       =   2  'Center
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         Caption         =   "LICENCIA:"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   195
         Left            =   555
         TabIndex        =   116
         Top             =   1605
         Width           =   825
      End
      Begin VB.Label Label40 
         Alignment       =   2  'Center
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         Caption         =   "KILOMETRAJE:"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   195
         Left            =   165
         TabIndex        =   115
         Top             =   1920
         Width           =   1215
      End
      Begin VB.Label Label36 
         Alignment       =   2  'Center
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         Caption         =   "DIAS:"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   195
         Left            =   3645
         TabIndex        =   114
         Top             =   1605
         Width           =   495
      End
      Begin VB.Shape Shape5 
         BackStyle       =   1  'Opaque
         BorderStyle     =   3  'Dot
         Height          =   1815
         Left            =   120
         Top             =   360
         Width           =   5175
      End
   End
   Begin VB.CheckBox ChkRecalcular 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      Caption         =   "Recalcular Precios"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000FF&
      Height          =   255
      Left            =   13920
      TabIndex        =   101
      Top             =   7395
      Visible         =   0   'False
      Width           =   1695
   End
   Begin VB.TextBox TxtCosto 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000018&
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   9735
      MaxLength       =   80
      TabIndex        =   58
      Top             =   6360
      Width           =   975
   End
   Begin VB.TextBox TxtUnitario 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H0080C0FF&
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   240
      MaxLength       =   80
      TabIndex        =   57
      Text            =   "0.00"
      Top             =   7320
      Width           =   975
   End
   Begin VB.TextBox TxtUnidad 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   8745
      MaxLength       =   80
      TabIndex        =   56
      Top             =   6360
      Width           =   975
   End
   Begin VB.TextBox TxtDireccion 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   285
      Left            =   1680
      MaxLength       =   80
      TabIndex        =   55
      Top             =   2160
      Width           =   4815
   End
   Begin VB.TextBox TxtCodProducto 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   240
      MaxLength       =   80
      TabIndex        =   54
      Top             =   6360
      Width           =   1335
   End
   Begin VB.TextBox TxtDescripcionProducto 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   3795
      MaxLength       =   80
      TabIndex        =   53
      Top             =   6360
      Width           =   4935
   End
   Begin VB.TextBox TxtSerie 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   7410
      MaxLength       =   80
      TabIndex        =   52
      Top             =   720
      Width           =   975
   End
   Begin VB.TextBox TxtNumeroDoc 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   8445
      MaxLength       =   80
      TabIndex        =   51
      Top             =   720
      Width           =   2415
   End
   Begin VB.TextBox TxtRuc 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   285
      Left            =   1680
      MaxLength       =   80
      TabIndex        =   50
      Top             =   1440
      Width           =   1575
   End
   Begin VB.TextBox TxtProveedor 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   285
      Left            =   1680
      Locked          =   -1  'True
      MaxLength       =   80
      TabIndex        =   49
      Top             =   1800
      Width           =   4815
   End
   Begin VB.TextBox TxtValoerNeto 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H0080C0FF&
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   4110
      MaxLength       =   80
      TabIndex        =   48
      Text            =   "0.00"
      Top             =   7320
      Width           =   855
   End
   Begin VB.TextBox TxtISC 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H0080C0FF&
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   5730
      MaxLength       =   80
      TabIndex        =   47
      Text            =   "0.00"
      Top             =   7320
      Width           =   735
   End
   Begin VB.TextBox TxtIGV 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H0080C0FF&
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   8535
      MaxLength       =   80
      TabIndex        =   46
      Text            =   "0.00"
      Top             =   7320
      Width           =   615
   End
   Begin VB.TextBox TxtIvap 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H0080C0FF&
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   7140
      MaxLength       =   80
      TabIndex        =   45
      Text            =   "0.00"
      Top             =   7320
      Width           =   615
   End
   Begin VB.TextBox TxtPrecioVenta 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H0080C0FF&
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   9795
      MaxLength       =   80
      TabIndex        =   44
      Text            =   "0.00"
      Top             =   7320
      Width           =   1095
   End
   Begin VB.TextBox TxtCostoAnt 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000018&
      ForeColor       =   &H00800000&
      Height          =   285
      Left            =   12120
      Locked          =   -1  'True
      MaxLength       =   80
      TabIndex        =   43
      Top             =   6600
      Width           =   735
   End
   Begin VB.TextBox TxtUtilidadAnt 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000018&
      ForeColor       =   &H00800000&
      Height          =   285
      Left            =   13920
      Locked          =   -1  'True
      MaxLength       =   80
      TabIndex        =   42
      Top             =   6600
      Width           =   615
   End
   Begin VB.TextBox txtPrecioVentaAnt 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000018&
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   285
      Left            =   14760
      Locked          =   -1  'True
      MaxLength       =   80
      TabIndex        =   41
      Top             =   6600
      Width           =   735
   End
   Begin VB.TextBox TxtCostoHoy 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000018&
      ForeColor       =   &H00800000&
      Height          =   285
      Left            =   12120
      MaxLength       =   80
      TabIndex        =   40
      Top             =   7080
      Width           =   735
   End
   Begin VB.TextBox txtUtilidadhoy 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000018&
      ForeColor       =   &H00800000&
      Height          =   285
      Left            =   13920
      MaxLength       =   80
      TabIndex        =   39
      Top             =   7080
      Width           =   615
   End
   Begin VB.TextBox TxtventaHoy 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000018&
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   285
      Left            =   14760
      MaxLength       =   80
      TabIndex        =   38
      Top             =   7080
      Width           =   735
   End
   Begin VB.CheckBox chkModo 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      Caption         =   "Check1"
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   11640
      TabIndex        =   37
      Top             =   7320
      Width           =   255
   End
   Begin VB.TextBox txtIgv_Porcentaje 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H0080C0FF&
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   9165
      MaxLength       =   80
      TabIndex        =   36
      Text            =   "0.00"
      Top             =   7320
      Width           =   615
   End
   Begin VB.Frame Frame1 
      BackColor       =   &H00FFFFFF&
      Caption         =   "DESCT (S/.)"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000C0&
      Height          =   735
      Left            =   1320
      TabIndex        =   34
      Top             =   6960
      Width           =   975
      Begin VB.TextBox TxtDctoSoles 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H0080C0FF&
         BeginProperty Font 
            Name            =   "Calibri"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   315
         Left            =   120
         MaxLength       =   80
         TabIndex        =   35
         Text            =   "0.00"
         Top             =   360
         Width           =   735
      End
   End
   Begin VB.Frame Frame2 
      BackColor       =   &H00FFFFFF&
      Caption         =   "DESCT (%)"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000C0&
      Height          =   735
      Left            =   2400
      TabIndex        =   32
      Top             =   6960
      Width           =   975
      Begin VB.TextBox TxtDstoporcentaje 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H0080C0FF&
         BeginProperty Font 
            Name            =   "Calibri"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   315
         Left            =   120
         MaxLength       =   80
         TabIndex        =   33
         Text            =   "0.00"
         Top             =   360
         Width           =   735
      End
   End
   Begin VB.Frame Frame3 
      BackColor       =   &H00FFFFFF&
      Caption         =   "CANTIDADES"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   680
      Left            =   1680
      TabIndex        =   28
      Top             =   6000
      Width           =   2055
      Begin VB.TextBox TxtCantidad 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H0080C0FF&
         BeginProperty Font 
            Name            =   "Calibri"
            Size            =   9
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   285
         Left            =   120
         MaxLength       =   80
         TabIndex        =   30
         Top             =   360
         Width           =   615
      End
      Begin VB.TextBox TxtUnidades 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H0080C0FF&
         BeginProperty Font 
            Name            =   "Calibri"
            Size            =   9
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   285
         Left            =   1320
         MaxLength       =   80
         TabIndex        =   29
         Text            =   "1"
         Top             =   360
         Width           =   615
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         Caption         =   "TRAE"
         BeginProperty Font 
            Name            =   "Calibri"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   195
         Left            =   825
         TabIndex        =   31
         Top             =   360
         Width           =   330
      End
   End
   Begin VB.TextBox lblIMPBruto 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   6600
      TabIndex        =   27
      Text            =   "0.00"
      Top             =   7920
      Width           =   1695
   End
   Begin VB.TextBox lblDescuento 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   6600
      TabIndex        =   26
      Text            =   "0.00"
      Top             =   8250
      Width           =   1695
   End
   Begin VB.TextBox lblValorVenta 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   9720
      TabIndex        =   25
      Text            =   "0.00"
      Top             =   7920
      Width           =   1815
   End
   Begin VB.TextBox lblIgv 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   9720
      TabIndex        =   24
      Text            =   "0.00"
      Top             =   8250
      Width           =   1815
   End
   Begin VB.TextBox LblPercepcion 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H0080FFFF&
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   12720
      TabIndex        =   23
      Text            =   "0.00"
      Top             =   8280
      Visible         =   0   'False
      Width           =   1575
   End
   Begin VB.TextBox lblTotal 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H0080FFFF&
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   12720
      TabIndex        =   22
      Text            =   "0.00"
      Top             =   7920
      Width           =   1575
   End
   Begin VB.CheckBox chkIGV 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      Caption         =   "Check1"
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   11280
      TabIndex        =   21
      Top             =   7320
      Width           =   255
   End
   Begin VB.TextBox txtOtros 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H0080C0FF&
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   3480
      MaxLength       =   80
      TabIndex        =   20
      Text            =   "0.00"
      Top             =   7320
      Width           =   615
   End
   Begin VB.TextBox TxtTotalDescuento 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H0080C0FF&
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   4980
      MaxLength       =   80
      TabIndex        =   19
      Text            =   "0.00"
      Top             =   7320
      Width           =   735
   End
   Begin VB.CheckBox ChkPercepcion 
      BackColor       =   &H00400000&
      Caption         =   "PERCEP"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   255
      Left            =   3330
      TabIndex        =   18
      Top             =   8040
      Width           =   975
   End
   Begin VB.TextBox TxtPecepcion 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   4320
      TabIndex        =   17
      Text            =   "0.000"
      Top             =   8040
      Visible         =   0   'False
      Width           =   1110
   End
   Begin VB.TextBox txtRedondeo 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   4320
      TabIndex        =   16
      Text            =   "0.000"
      Top             =   8400
      Width           =   1110
   End
   Begin VB.TextBox TxtObservacion 
      Appearance      =   0  'Flat
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   14520
      MaxLength       =   80
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertical
      TabIndex        =   15
      Top             =   2280
      Width           =   2655
   End
   Begin VB.TextBox TxtISC_p 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H0080C0FF&
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   315
      Left            =   6495
      MaxLength       =   80
      TabIndex        =   14
      Text            =   "0.00"
      Top             =   7320
      Width           =   615
   End
   Begin VB.TextBox Txtdoc_cod 
      Height          =   375
      Left            =   8760
      TabIndex        =   7
      Top             =   2880
      Visible         =   0   'False
      Width           =   1695
   End
   Begin VB.TextBox TxtSeriaGuardada 
      Height          =   375
      Left            =   10440
      TabIndex        =   6
      Top             =   2880
      Visible         =   0   'False
      Width           =   1695
   End
   Begin VB.TextBox TxtNumeroGuardado 
      Height          =   375
      Left            =   12120
      TabIndex        =   5
      Top             =   2880
      Visible         =   0   'False
      Width           =   1695
   End
   Begin VB.TextBox TxtAlmacenGuardado 
      Height          =   375
      Left            =   13800
      TabIndex        =   4
      Top             =   2880
      Visible         =   0   'False
      Width           =   1695
   End
   Begin VB.TextBox TxtProveedorGuardado 
      Height          =   375
      Left            =   6960
      TabIndex        =   3
      Top             =   2880
      Visible         =   0   'False
      Width           =   1695
   End
   Begin VB.TextBox txtTC 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   285
      Left            =   8445
      MaxLength       =   5
      TabIndex        =   2
      Top             =   2280
      Width           =   855
   End
   Begin VB.TextBox lblISC 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   6600
      TabIndex        =   1
      Text            =   "0.00"
      Top             =   8580
      Width           =   1695
   End
   Begin VB.CommandButton cmdActualizar 
      BackColor       =   &H008080FF&
      Caption         =   "Actualizar"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   250
      Left            =   12120
      Style           =   1  'Graphical
      TabIndex        =   0
      Top             =   7395
      Visible         =   0   'False
      Width           =   855
   End
   Begin MSDataListLib.DataCombo DtcAlmacen 
      Height          =   330
      Left            =   210
      TabIndex        =   59
      Top             =   360
      Width           =   4215
      _ExtentX        =   7435
      _ExtentY        =   582
      _Version        =   393216
      Appearance      =   0
      Style           =   2
      ForeColor       =   8388608
      Text            =   "DataCombo1"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin MSDataListLib.DataCombo DtcTipoDoc 
      Height          =   345
      Left            =   7410
      TabIndex        =   60
      Top             =   240
      Width           =   3615
      _ExtentX        =   6376
      _ExtentY        =   609
      _Version        =   393216
      Appearance      =   0
      Style           =   2
      ForeColor       =   8388608
      Text            =   "DataCombo1"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Calibri"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin MSComctlLib.ImageList ImgIconos 
      Left            =   4920
      Top             =   -240
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   32
      ImageHeight     =   32
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   9
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FrmCompra1.frx":BD14
            Key             =   "(Nuevo)"
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FrmCompra1.frx":C168
            Key             =   "(Modificar)"
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FrmCompra1.frx":C488
            Key             =   "(Eliminar)"
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FrmCompra1.frx":C8DC
            Key             =   "(Salir)"
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FrmCompra1.frx":CD30
            Key             =   "(Aceptar)"
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FrmCompra1.frx":D050
            Key             =   "(Cancelar)"
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FrmCompra1.frx":D370
            Key             =   "(Quitar)"
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FrmCompra1.frx":D690
            Key             =   "(Agregar)"
         EndProperty
         BeginProperty ListImage9 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FrmCompra1.frx":D9B0
            Key             =   "(Buscar)"
         EndProperty
      EndProperty
   End
   Begin ComCtl3.CoolBar ClbAcciones1 
      Height          =   5265
      Left            =   16440
      TabIndex        =   61
      Top             =   2520
      Width           =   900
      _ExtentX        =   1588
      _ExtentY        =   9287
      BandCount       =   1
      ForeColor       =   8388608
      ImageList       =   "ImgIconos"
      FixedOrder      =   -1  'True
      VariantHeight   =   0   'False
      Orientation     =   1
      EmbossPicture   =   -1  'True
      _CBWidth        =   900
      _CBHeight       =   5265
      _Version        =   "6.0.8169"
      Caption1        =   "Acciones"
      Child1          =   "TlbAcciones"
      MinHeight1      =   840
      Width1          =   3180
      FixedBackground1=   0   'False
      NewRow1         =   0   'False
      Begin MSComctlLib.Toolbar TlbAcciones 
         Height          =   7290
         Left            =   30
         TabIndex        =   62
         Top             =   375
         Width           =   840
         _ExtentX        =   1482
         _ExtentY        =   12859
         ButtonWidth     =   1588
         ButtonHeight    =   1429
         Style           =   1
         ImageList       =   "ImgIconos"
         DisabledImageList=   "ImgIconos"
         HotImageList    =   "ImgIconos"
         _Version        =   393216
         BeginProperty Buttons {66833FE8-8583-11D1-B16A-00C0F0283628} 
            NumButtons      =   9
            BeginProperty Button1 {66833FEA-8583-11D1-B16A-00C0F0283628} 
               Caption         =   "   Nuevo   "
               Key             =   "(Nuevo)"
               Object.ToolTipText     =   "Nuevo"
               ImageKey        =   "(Nuevo)"
            EndProperty
            BeginProperty Button2 {66833FEA-8583-11D1-B16A-00C0F0283628} 
               Style           =   3
            EndProperty
            BeginProperty Button3 {66833FEA-8583-11D1-B16A-00C0F0283628} 
               Caption         =   "Anular"
               Key             =   "(Anular)"
               Object.ToolTipText     =   "Modificar"
               ImageKey        =   "(Modificar)"
            EndProperty
            BeginProperty Button4 {66833FEA-8583-11D1-B16A-00C0F0283628} 
               Style           =   3
            EndProperty
            BeginProperty Button5 {66833FEA-8583-11D1-B16A-00C0F0283628} 
               Caption         =   "Eliminar"
               Key             =   "(Eliminar)"
               Object.ToolTipText     =   "Eliminar"
               ImageKey        =   "(Eliminar)"
            EndProperty
            BeginProperty Button6 {66833FEA-8583-11D1-B16A-00C0F0283628} 
               Style           =   3
            EndProperty
            BeginProperty Button7 {66833FEA-8583-11D1-B16A-00C0F0283628} 
               Caption         =   "&Buscar"
               Key             =   "(Buscar)"
               ImageKey        =   "(Buscar)"
            EndProperty
            BeginProperty Button8 {66833FEA-8583-11D1-B16A-00C0F0283628} 
               Style           =   3
            EndProperty
            BeginProperty Button9 {66833FEA-8583-11D1-B16A-00C0F0283628} 
               Caption         =   "&Salir"
               Key             =   "(Salir)"
               ImageKey        =   "(Salir)"
            EndProperty
         EndProperty
         OLEDropMode     =   1
      End
   End
   Begin MSComctlLib.ImageList ImageList1 
      Left            =   500
      Top             =   750
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   32
      ImageHeight     =   32
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   4
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FrmCompra1.frx":DCD0
            Key             =   "(Grabar)"
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FrmCompra1.frx":E5AA
            Key             =   "(Refresh)"
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FrmCompra1.frx":E704
            Key             =   "(Imprimir)"
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FrmCompra1.frx":E791
            Key             =   "(Reverti)"
         EndProperty
      EndProperty
   End
   Begin ComCtl3.CoolBar ClbAcciones 
      Height          =   840
      Left            =   50
      TabIndex        =   63
      Top             =   8160
      Width           =   3120
      _ExtentX        =   5503
      _ExtentY        =   1482
      BandCount       =   1
      ForeColor       =   -2147483635
      ImageList       =   "ImgIconos"
      FixedOrder      =   -1  'True
      VariantHeight   =   0   'False
      EmbossPicture   =   -1  'True
      _CBWidth        =   3120
      _CBHeight       =   840
      _Version        =   "6.0.8169"
      Child1          =   "TlbAcciones"
      MinHeight1      =   780
      Width1          =   3180
      FixedBackground1=   0   'False
      NewRow1         =   0   'False
      Begin MSComctlLib.Toolbar TlbGrabar 
         Height          =   810
         Left            =   120
         TabIndex        =   64
         Top             =   15
         Width           =   3000
         _ExtentX        =   5292
         _ExtentY        =   1429
         ButtonWidth     =   1535
         ButtonHeight    =   1429
         Style           =   1
         ImageList       =   "ImageList1"
         _Version        =   393216
         BeginProperty Buttons {66833FE8-8583-11D1-B16A-00C0F0283628} 
            NumButtons      =   5
            BeginProperty Button1 {66833FEA-8583-11D1-B16A-00C0F0283628} 
               Caption         =   "Grabar"
               Key             =   "(Grabar)"
               Object.ToolTipText     =   "Grabar Ctrl+G"
               ImageKey        =   "(Grabar)"
            EndProperty
            BeginProperty Button2 {66833FEA-8583-11D1-B16A-00C0F0283628} 
               Style           =   3
            EndProperty
            BeginProperty Button3 {66833FEA-8583-11D1-B16A-00C0F0283628} 
               Caption         =   "Imprimir"
               Key             =   "(Imprimir)"
               Object.ToolTipText     =   "Cancelar"
               ImageKey        =   "(Imprimir)"
            EndProperty
            BeginProperty Button4 {66833FEA-8583-11D1-B16A-00C0F0283628} 
               Style           =   3
            EndProperty
            BeginProperty Button5 {66833FEA-8583-11D1-B16A-00C0F0283628} 
               Caption         =   "Modificar"
               Key             =   "(Revertir)"
               ImageKey        =   "(Refresh)"
            EndProperty
         EndProperty
         OLEDropMode     =   1
      End
   End
   Begin MSDataListLib.DataCombo DtTipoCompra 
      Height          =   330
      Left            =   8445
      TabIndex        =   66
      Top             =   1080
      Width           =   2415
      _ExtentX        =   4260
      _ExtentY        =   582
      _Version        =   393216
      Appearance      =   0
      Style           =   2
      ForeColor       =   8388608
      Text            =   "DataCombo1"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin MSDataListLib.DataCombo DtcMoneda 
      Height          =   330
      Left            =   8445
      TabIndex        =   67
      Top             =   1920
      Width           =   2415
      _ExtentX        =   4260
      _ExtentY        =   582
      _Version        =   393216
      Appearance      =   0
      Style           =   2
      ForeColor       =   8388608
      Text            =   "DataCombo1"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin MSComCtl2.DTPicker Dtpproducto_vencimiento 
      Height          =   300
      Left            =   13920
      TabIndex        =   136
      Top             =   5865
      Visible         =   0   'False
      Width           =   1815
      _ExtentX        =   3201
      _ExtentY        =   529
      _Version        =   393216
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Format          =   126812161
      CurrentDate     =   40963
   End
   Begin VitekeySoft.ChameleonBtn cmdRecalcular 
      Height          =   375
      Left            =   15840
      TabIndex        =   141
      Top             =   8640
      Width           =   1455
      _ExtentX        =   2566
      _ExtentY        =   661
      BTYPE           =   3
      TX              =   "RECALCULAR"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   6.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   1
      FOCUSR          =   -1  'True
      BCOL            =   14215660
      BCOLO           =   14215660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "FrmCompra1.frx":EC53
      PICN            =   "FrmCompra1.frx":EC6F
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin VitekeySoft.ChameleonBtn CmdAgregar 
      Height          =   375
      Left            =   15840
      TabIndex        =   145
      ToolTipText     =   "AGREGAR ITEM"
      Top             =   6720
      Width           =   405
      _ExtentX        =   714
      _ExtentY        =   661
      BTYPE           =   5
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   1
      FOCUSR          =   -1  'True
      BCOL            =   14215660
      BCOLO           =   14215660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "FrmCompra1.frx":EDC9
      PICN            =   "FrmCompra1.frx":EDE5
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin VitekeySoft.ChameleonBtn cmdRevertir 
      Height          =   375
      Left            =   15840
      TabIndex        =   146
      ToolTipText     =   "APLICAR CAMBIO"
      Top             =   7200
      Width           =   405
      _ExtentX        =   714
      _ExtentY        =   661
      BTYPE           =   5
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   1
      FOCUSR          =   -1  'True
      BCOL            =   14215660
      BCOLO           =   14215660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "FrmCompra1.frx":F37F
      PICN            =   "FrmCompra1.frx":F39B
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin VitekeySoft.ChameleonBtn cmdIngresoSerie 
      Height          =   495
      Left            =   10920
      TabIndex        =   159
      ToolTipText     =   "INGRESO DE N° SERIES"
      Top             =   6255
      Width           =   645
      _ExtentX        =   1138
      _ExtentY        =   873
      BTYPE           =   5
      TX              =   ""
      ENAB            =   0   'False
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   1
      FOCUSR          =   -1  'True
      BCOL            =   14215660
      BCOLO           =   14215660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "FrmCompra1.frx":F935
      PICN            =   "FrmCompra1.frx":F951
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin VB.TextBox txtPorcentajeGastos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H008080FF&
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   6.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   240
      Left            =   13080
      MaxLength       =   80
      TabIndex        =   164
      ToolTipText     =   "% GASTOS ADMINISTRATIVOS"
      Top             =   7400
      Width           =   735
   End
   Begin VB.TextBox TxtGastoAdminHoy 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000018&
      ForeColor       =   &H00800000&
      Height          =   285
      Left            =   13080
      MaxLength       =   80
      TabIndex        =   162
      Top             =   7080
      Width           =   735
   End
   Begin VB.TextBox TxtGastoAdminAnterior 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000018&
      ForeColor       =   &H00800000&
      Height          =   285
      Left            =   13080
      Locked          =   -1  'True
      MaxLength       =   80
      TabIndex        =   161
      Top             =   6600
      Width           =   735
   End
   Begin VitekeySoft.ChameleonBtn cmdReload 
      Height          =   300
      Left            =   3360
      TabIndex        =   167
      Top             =   1440
      Visible         =   0   'False
      Width           =   1095
      _ExtentX        =   1931
      _ExtentY        =   529
      BTYPE           =   5
      TX              =   "RELOAD"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   6.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   1
      FOCUSR          =   -1  'True
      BCOL            =   14215660
      BCOLO           =   14215660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "FrmCompra1.frx":12A78
      PICN            =   "FrmCompra1.frx":12A94
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin VitekeySoft.ChameleonBtn cmdDatosdua 
      Height          =   255
      Left            =   11400
      TabIndex        =   177
      Top             =   2280
      Width           =   1335
      _ExtentX        =   2355
      _ExtentY        =   450
      BTYPE           =   5
      TX              =   "DATOS DUA"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   1
      FOCUSR          =   -1  'True
      BCOL            =   14215660
      BCOLO           =   14215660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "FrmCompra1.frx":1302E
      PICN            =   "FrmCompra1.frx":1304A
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin MSHierarchicalFlexGridLib.MSHFlexGrid HfdDetalle 
      Height          =   3015
      Left            =   120
      TabIndex        =   65
      Top             =   2640
      Width           =   16215
      _ExtentX        =   28601
      _ExtentY        =   5318
      _Version        =   393216
      ForeColor       =   8388608
      FixedCols       =   0
      ForeColorFixed  =   8388608
      ForeColorSel    =   16777215
      BackColorBkg    =   16777215
      GridColor       =   -2147483635
      SelectionMode   =   1
      Appearance      =   0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      _NumberOfBands  =   1
      _Band(0).Cols   =   2
   End
   Begin MSComCtl2.DTPicker dtpFechaRegistro 
      Height          =   285
      Left            =   11520
      TabIndex        =   182
      Top             =   360
      Width           =   1455
      _ExtentX        =   2566
      _ExtentY        =   503
      _Version        =   393216
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Format          =   126812161
      CurrentDate     =   40963
   End
   Begin MSDataListLib.DataCombo DtcTipo 
      Height          =   330
      Left            =   8445
      TabIndex        =   183
      Top             =   1480
      Width           =   2415
      _ExtentX        =   4260
      _ExtentY        =   582
      _Version        =   393216
      Appearance      =   0
      Style           =   2
      ForeColor       =   8388608
      Text            =   "DataCombo1"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin MSDataListLib.DataCombo Dtcperiodo 
      Height          =   330
      Left            =   11520
      TabIndex        =   185
      Top             =   1080
      Width           =   2415
      _ExtentX        =   4260
      _ExtentY        =   582
      _Version        =   393216
      Appearance      =   0
      Style           =   2
      ForeColor       =   8388608
      Text            =   "DataCombo1"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin MSMask.MaskEdBox TxtFecha_emision 
      Height          =   285
      Left            =   13200
      TabIndex        =   187
      ToolTipText     =   "dd/mm/yyyy"
      Top             =   360
      Width           =   1155
      _ExtentX        =   2037
      _ExtentY        =   503
      _Version        =   393216
      Appearance      =   0
      MaxLength       =   10
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Format          =   "dd/mm/yyyy"
      Mask            =   "##/##/####"
      PromptChar      =   "_"
   End
   Begin MSMask.MaskEdBox txtfecha_Vencimiento 
      Height          =   285
      Left            =   14880
      TabIndex        =   188
      ToolTipText     =   "dd/mm/yyyy"
      Top             =   360
      Width           =   1155
      _ExtentX        =   2037
      _ExtentY        =   503
      _Version        =   393216
      Appearance      =   0
      MaxLength       =   10
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Format          =   "dd/mm/yyyy"
      Mask            =   "##/##/####"
      PromptChar      =   "_"
   End
   Begin VB.Label Label60 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "OBSERVACION:"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   6.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   165
      Left            =   13230
      TabIndex        =   189
      Top             =   2280
      Width           =   1215
   End
   Begin VB.Label Label59 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "PERIODO CONTABLE"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   6.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   165
      Left            =   11460
      TabIndex        =   186
      Top             =   840
      Width           =   1635
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "TIPO SERVICIO :"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   210
      Left            =   7125
      TabIndex        =   184
      Top             =   1560
      Width           =   1245
   End
   Begin VB.Label Label26 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "F. VENCIMIENTO"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   6.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   165
      Left            =   14910
      TabIndex        =   181
      Top             =   120
      Width           =   1305
   End
   Begin VB.Label Label58 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "G.(Admin)"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   13005
      TabIndex        =   163
      Top             =   6360
      Width           =   735
   End
   Begin VB.Shape Shape6 
      BorderColor     =   &H00C0C0C0&
      Height          =   1260
      Left            =   14340
      Top             =   7845
      Width           =   3015
   End
   Begin VB.Label Label48 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "VENCIMIENTO:"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   12825
      TabIndex        =   137
      Top             =   5880
      Visible         =   0   'False
      Width           =   1005
   End
   Begin VB.Label Label47 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "DIRECCION :"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   210
      Left            =   615
      TabIndex        =   135
      Top             =   2160
      Width           =   975
   End
   Begin VB.Label Label46 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "RAZON SOCIAL :"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   210
      Left            =   345
      TabIndex        =   134
      Top             =   1800
      Width           =   1245
   End
   Begin VB.Label Label45 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "RUC/DNI :"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   210
      Left            =   810
      TabIndex        =   133
      Top             =   1440
      Width           =   795
   End
   Begin VB.Label Label44 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "OTROS(FISE) :"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   195
      Left            =   3375
      TabIndex        =   131
      Top             =   8880
      Width           =   915
   End
   Begin VB.Label Label43 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "OTROS GASTOS :"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   6.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   165
      Left            =   14445
      TabIndex        =   128
      Top             =   8280
      Width           =   1335
   End
   Begin VB.Label Label42 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "GASTOS IMPOR :"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   6.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   165
      Left            =   14445
      TabIndex        =   127
      Top             =   8040
      Width           =   1335
   End
   Begin VB.Label Label41 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "EXONERADO  :"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   195
      Left            =   8625
      TabIndex        =   126
      Top             =   8670
      Width           =   975
   End
   Begin VB.Label Label7 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "V.VENTA"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   7875
      TabIndex        =   124
      Top             =   6960
      Width           =   585
   End
   Begin VB.Label Label4 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "DATOS PROVEEDOR"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   1725
      TabIndex        =   122
      Top             =   1100
      Width           =   1365
   End
   Begin VB.Label Label35 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "F. REGISTRO "
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   6.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   165
      Left            =   11625
      TabIndex        =   102
      Top             =   120
      Width           =   1035
   End
   Begin VB.Label lblpercep_titulo 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "TOTAL+PERC:"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   195
      Left            =   11685
      TabIndex        =   100
      Top             =   8280
      Visible         =   0   'False
      Width           =   915
   End
   Begin VB.Label Label13 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "IM.BRUTO :"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   195
      Left            =   5625
      TabIndex        =   99
      Top             =   7920
      Width           =   795
   End
   Begin VB.Label Label9 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "P.COSTO"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   9750
      TabIndex        =   98
      Top             =   6120
      Width           =   615
   End
   Begin VB.Label Label10 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "UND"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   8715
      TabIndex        =   97
      Top             =   6120
      Width           =   345
   End
   Begin VB.Label Label6 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "DESCRIPCION PRODUCTO"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   5040
      TabIndex        =   96
      Top             =   6120
      Width           =   1725
   End
   Begin VB.Label lblAnulado 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "ANULADO"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   20.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000FF&
      Height          =   495
      Left            =   4560
      TabIndex        =   95
      Top             =   1200
      Visible         =   0   'False
      Width           =   1995
   End
   Begin VB.Label Label5 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "CODIGO"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   345
      TabIndex        =   93
      Top             =   6000
      Width           =   585
   End
   Begin VB.Label Label3 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "F. EMISION"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   6.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   165
      Left            =   13140
      TabIndex        =   92
      Top             =   120
      Width           =   885
   End
   Begin VB.Label Label17 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "DESC :"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   195
      Left            =   6015
      TabIndex        =   91
      Top             =   8265
      Width           =   435
   End
   Begin VB.Label Label18 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "VALOR VENTA :"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   195
      Left            =   8520
      TabIndex        =   90
      Top             =   7920
      Width           =   1065
   End
   Begin VB.Label Label19 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "IGV  :"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   195
      Left            =   9255
      TabIndex        =   89
      Top             =   8280
      Width           =   375
   End
   Begin VB.Label Label20 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "TOTAL  :"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   195
      Left            =   12075
      TabIndex        =   88
      Top             =   7920
      Width           =   555
   End
   Begin VB.Label Label14 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "V.UNITARIO"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   330
      TabIndex        =   87
      Top             =   6960
      Width           =   825
   End
   Begin VB.Label Label21 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "IMP.BRUTO"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   4185
      TabIndex        =   86
      Top             =   6960
      Width           =   795
   End
   Begin VB.Label Label22 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "ISC"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   6195
      TabIndex        =   85
      Top             =   6960
      Width           =   225
   End
   Begin VB.Label Label23 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "IGV (S/.)"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   8670
      TabIndex        =   84
      Top             =   6960
      Width           =   555
   End
   Begin VB.Label Label24 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "IVAP"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   7455
      TabIndex        =   83
      Top             =   6960
      Width           =   345
   End
   Begin VB.Label Label25 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "TOTAL VENTA"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   9930
      TabIndex        =   82
      Top             =   6960
      Width           =   915
   End
   Begin VB.Line Line1 
      BorderColor     =   &H00800000&
      BorderWidth     =   2
      X1              =   12120
      X2              =   15480
      Y1              =   6960
      Y2              =   6960
   End
   Begin VB.Label Label12 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "P.Venta"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   14820
      TabIndex        =   81
      Top             =   6360
      Width           =   585
   End
   Begin VB.Label Label27 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "Utilidad(%)"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   13860
      TabIndex        =   80
      Top             =   6360
      Width           =   825
   End
   Begin VB.Label Label28 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "P.Costo"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   12135
      TabIndex        =   79
      Top             =   6360
      Width           =   585
   End
   Begin VB.Label Label29 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "IGV (%)"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   9390
      TabIndex        =   78
      Top             =   6960
      Width           =   495
   End
   Begin VB.Label Label16 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "IGV"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000FF&
      Height          =   195
      Left            =   11145
      TabIndex        =   77
      Top             =   6960
      Width           =   285
   End
   Begin VB.Label Label30 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "DIV"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000FF&
      Height          =   195
      Left            =   11670
      TabIndex        =   76
      Top             =   6960
      Width           =   285
   End
   Begin VB.Label Label31 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "OTROS"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   3600
      TabIndex        =   75
      Top             =   6960
      Width           =   465
   End
   Begin VB.Label Label15 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "DESCT"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   5235
      TabIndex        =   74
      Top             =   6960
      Width           =   435
   End
   Begin VB.Label Label8 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "ROUND :"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   195
      Left            =   3525
      TabIndex        =   73
      Top             =   8400
      Width           =   615
   End
   Begin VB.Label Label32 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "ISC(%)"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   195
      Left            =   6645
      TabIndex        =   72
      Top             =   6960
      Width           =   435
   End
   Begin VB.Label Label11 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "TIPO COMPRA:"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   210
      Left            =   7245
      TabIndex        =   71
      Top             =   1080
      Width           =   1125
   End
   Begin VB.Label Label34 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "MONEDA:"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   210
      Left            =   7605
      TabIndex        =   70
      Top             =   1920
      Width           =   765
   End
   Begin VB.Label lblcambio 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "T.CAMBIO:"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00800000&
      Height          =   210
      Left            =   7545
      TabIndex        =   69
      Top             =   2280
      Width           =   825
   End
   Begin VB.Label Label33 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "ISC :"
      BeginProperty Font 
         Name            =   "Calibri"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   195
      Left            =   6135
      TabIndex        =   68
      Top             =   8640
      Width           =   315
   End
   Begin VB.Shape Shape8 
      BackColor       =   &H00FFFFFF&
      BackStyle       =   1  'Opaque
      BorderColor     =   &H00808080&
      BorderStyle     =   6  'Inside Solid
      Height          =   855
      Left            =   195
      Top             =   5880
      Width           =   10695
   End
   Begin VB.Shape Shape10 
      BackStyle       =   1  'Opaque
      BorderColor     =   &H00000080&
      BorderStyle     =   6  'Inside Solid
      Height          =   1455
      Left            =   12000
      Top             =   6240
      Width           =   3735
   End
   Begin VB.Label LblCantidad 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H00400000&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   300
      Left            =   10920
      TabIndex        =   94
      Top             =   5880
      Width           =   615
   End
   Begin VB.Shape ShpDatos 
      BackColor       =   &H00DFDFE0&
      BorderColor     =   &H00808080&
      BorderStyle     =   6  'Inside Solid
      FillColor       =   &H00FFFFFF&
      FillStyle       =   0  'Solid
      Height          =   1020
      Left            =   120
      Top             =   15
      Width           =   6615
   End
   Begin VB.Shape Shape2 
      BackColor       =   &H00FFFFFF&
      BorderColor     =   &H00808080&
      BorderStyle     =   6  'Inside Solid
      FillColor       =   &H00FFFFFF&
      FillStyle       =   0  'Solid
      Height          =   1515
      Left            =   120
      Top             =   1080
      Width           =   6615
   End
   Begin VB.Shape Shape3 
      BackColor       =   &H00FFFFFF&
      FillColor       =   &H00FFFFFF&
      FillStyle       =   0  'Solid
      Height          =   1980
      Left            =   120
      Top             =   5760
      Width           =   16215
   End
   Begin VB.Shape Shape4 
      BackColor       =   &H000000FF&
      BackStyle       =   1  'Opaque
      FillColor       =   &H00400000&
      FillStyle       =   0  'Solid
      Height          =   1380
      Left            =   3240
      Top             =   7800
      Width           =   14535
   End
   Begin VB.Shape Shape1 
      BackColor       =   &H00DFDFE0&
      BorderColor     =   &H00C0C0C0&
      BorderStyle     =   6  'Inside Solid
      FillColor       =   &H00FFFFFF&
      FillStyle       =   0  'Solid
      Height          =   2595
      Left            =   6840
      Top             =   15
      Width           =   10455
   End
   Begin VB.Shape Shape7 
      BackStyle       =   1  'Opaque
      BorderColor     =   &H00404040&
      BorderWidth     =   2
      Height          =   9225
      Left            =   0
      Top             =   0
      Width           =   17400
   End
End
Attribute VB_Name = "FrmCompras"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Dim doc_Tienda As String * 1
Dim cod_doc As String
Dim RstDetCompra As New ADODB.Recordset
Dim rstTemporal As New ADODB.Recordset
Dim StrCodDetCompra As String
Dim StrCodReferencia As Double
Dim Referencia As Boolean
Public Procedencia As EnumProcede
Public ProcendenciaGuia As EnumGuia
Public ProcedenciaFactura As EnumFactura
Public codigoP As String
Dim precio_unit As Single
Public rever As Boolean
Dim DescuentoT As Single
Dim Pcosto As Single
Dim descuentoRecorrido As Single
Dim descuentoPersonal As Single
Dim descuentoViaticos As Single
Dim idOrden As Double
Public Sub LlenarGastos(ByVal Grilla As MSHFlexGrid, ByVal cCompra As Double)
On Error GoTo salir
Dim tTotal As Double
strCadena = "SELECT     DocumentoCompraGastos.IdGasto, (Comprobantes.doc_abrev+':'+DocumentoCompraGastos.serie+'-'+ DocumentoCompraGastos.numero) as Numero, " & _
" DocumentoCompraGastos.Monto , DocumentoCompraGastos.detalle FROM DocumentoCompraGastos INNER JOIN " & _
" Comprobantes ON DocumentoCompraGastos.doc_cod = Comprobantes.doc_cod  WHERE idCompra='" & cCompra & "'"
Call ConfiguraRst(strCadena)

If rst.RecordCount < 1 Then
    Grilla.Rows = 1
    Grilla.Clear
    Exit Sub

End If
   Grilla.Clear
   Grilla.Rows = 0
       ReDim arrColWidth(1 To rst.Fields.Count)
       For Each Campo In rst.Fields
            Grilla.ColWidth(0) = 700
           Grilla.ColWidth(1) = 2500
           Grilla.ColWidth(2) = 2300
           Grilla.ColWidth(3) = 2900
                     
         Next
        cabecera = "ID" & vbTab & "COMPROBANTE" & vbTab & "DETALLE" & vbTab & "MONTO"
        Grilla.AddItem cabecera
         For k = 0 To 3
            Grilla.col = k
            Grilla.Row = 0
            Grilla.CellBackColor = &HDFDFE0
        Next k
        rst.MoveFirst
        tTotal = 0
        For i = 0 To rst.RecordCount - 1
            Fila = Fila & rst("IdGasto") & vbTab & rst("Numero") & vbTab & rst("detalle") & vbTab & Format(rst("Monto"), "###0.00")
            Grilla.AddItem Fila
            tTotal = tTotal + rst("Monto")
            Fila = ""
            rst.MoveNext
        Next i
     
      Fila = "" & vbTab & "" & vbTab & "" & vbTab & Format(tTotal, "###0.00")
      Grilla.AddItem Fila
       For k = 5 To 3
            Grilla.col = 5
            Grilla.Row = i + 1
            Grilla.CellBackColor = &HC0FFFF
      Next k
 
  Exit Sub
salir: MsgBox "Ocurrio un Error en la Conexion", vbInformation, "Mensaje para el usuario"
Set rst = Nothing

End Sub
Private Sub AgregarGrilla()
If Val(Me.txtcantidad.Text) > 0 And Trim(Me.TxtCodProducto.Text) <> "" Then
    Call AgregarTemporal
    'Me.TxtCodProducto.Text = "0000"
    'Me.TxtDescripcionProducto.Text = ""
    'Me.TxtCantidad.Text = "0"
     
    Call Resalta(Me.TxtCodProducto)
Else
    Call Resalta(Me.txtcantidad)
End If
End Sub
Private Sub AgregarTemporal()
    strCadena = "SELECT cProducto,Cantidad FROM Temporal_Compras WHERE cProducto='" & Trim(codigoP) & "' AND cDocumentoCompra='" & Trim(Me.TxtNumeroDoc.Text) & "'"
    Call ConfiguraRst(strCadena)
    Me.TlbGrabar.Buttons(KEY_SAVE).Enabled = True
    Call AgregarNuevo
End Sub
Sub AgregarNuevo()
Dim exonerado As Double, valor_venta As Double, igv As Double
    If Val(Me.TxtPrecioVenta.Text) = 0 Then
        Me.ChkRecalcular.Visible = True
    Else
        Me.ChkRecalcular.Value = 0
        Me.ChkRecalcular.Visible = False
    End If
    If KEY_CON_IGV = "si" And Me.chkigv.Value = 1 Then
        
        exonerado = 0
        igv = Val(Me.TxtIgv.Text)
        valor_venta = Val(Me.txtvalorventa.Text)
        
    Else
        exonerado = Val(Me.TxtPrecioVenta.Text)
        igv = 0
        valor_venta = 0
    End If
    strCadena = "INSERT INTO movimiento_compra_temporal(id_doc,serie,numero,id_producto,cantidad,c_unitario,dsto_soles,dsto_procentaje,total_descuento," & _
    "valor_neto,isc,igv,ivap,otros,percepcion,exonerado,valor_venta,precio_venta,p_venta,p_costo,dni_save,id_alm,ruc) VALUES " & _
    "('" & Trim(Me.DtcTipoDoc.BoundText) & "','" & Trim(Me.TxtSerie.Text) & "','" & Trim(Me.TxtNumeroDoc.Text) & "','" & Trim(codigoP) & "'," & _
    "'" & Val(Me.txtcantidad.Text) * Val(Me.TxtUnidades.Text) & "','" & Val(Me.TxtUnitario.Text) & "','" & Val(Me.TxtDctoSoles.Text) & "'," & _
    "'" & Val(Me.TxtDstoporcentaje.Text) & "','" & Val(Me.TxtTotalDescuento.Text) & "','" & Val(Me.TxtValoerNeto.Text) & "','" & Val(Me.txtisc.Text) & "','" & igv & "'," & _
    "'" & Val(Me.TxtIvap.Text) & "','" & Val(Me.txtOtros.Text) & "','" & Val(percepcion) & "','" & exonerado & "','" & valor_venta & "','" & Val(Me.TxtPrecioVenta.Text) & "','" & Val(Me.TxtventaHoy.Text) & "'," & _
    "'" & Val(Me.TxtCostoHoy.Text) & "','" & KEY_USUARIO & "','" & Trim(Me.DtcAlmacen.BoundText) & "','" & KEY_RUC & "')"
    CnBd.Execute (strCadena)
     
    strCadena = "UPDATE producto SET vencimiento='" & Format(Me.Dtpproducto_vencimiento.Value, "YYYY-mm-dd") & "' WHERE id_producto='" & Trim(codigoP) & "' AND ruc='" & KEY_RUC & "'"
    CnBd.Execute (strCadena)
     
    
    Call llenarGrid_det(Me.HfdDetalle, Me.TxtNumeroDoc.Text, Me.DtcTipoDoc.BoundText, Me.TxtSerie.Text)
    Me.TxtCodProducto.Text = ""
    Me.TxtCodProducto.Text = ""
    Me.txtcantidad.Text = 0
    Me.TxtDescripcionProducto.Text = ""
    Me.txtunidad.Text = ""
    Me.txtCosto.Text = 0
    Me.TxtUnitario.Text = 0
    Me.TxtDctoSoles.Text = 0
    Me.TxtDstoporcentaje.Text = 0
    Me.txtOtros.Text = 0
    Me.TxtValoerNeto.Text = 0
    Me.TxtTotalDescuento.Text = 0
    Me.txtisc.Text = 0
    Me.TxtISC_p.Text = 0
    Me.TxtIvap.Text = 0
    Me.txtvalorventa.Text = 0
    Me.TxtIgv.Text = 0
    Me.txtIgv_Porcentaje.Text = 0
    Me.TxtPrecioVenta.Text = 0
    Me.txtPrecioVentaAnt.Text = 0
    Me.TxtCostoAnt.Text = 0
    Me.TxtCostoHoy.Text = 0
    Me.TxtUtilidadAnt.Text = 0
    Me.txtUtilidadhoy.Text = 0
    Me.TxtventaHoy.Text = 0
    Me.TxtCostoHoy.Text = 0
    Me.chkigv.Value = 0
    Me.chkModo.Value = 0
    
End Sub
Private Sub VerificaDocumento(ByVal TipoDoc As String)
If Trim(Me.DtcTipoDoc.BoundText) = "0009" Then
    Me.TlbGrabar.Buttons(KEY_GUIAREMISION).Enabled = True
End If
End Sub
Sub ModificarCantidad(ByVal Can_Previa As Integer)
    Dim Can_actual As Integer
'    Can_actual = Can_Previa + Val(Me.TxtCantidad.Text)
 '   StrCadena = "UPDATE Temporal_Compras SET cantidad='" & Can_actual & "',Total='" & Can_actual * Val(Me.TxtPrecio.Text) & "' WHERE cProducto='" & Trim(Me.TxtCodProducto.Text) & "' "
  '  Call EjecutaRST(StrCadena)
   ' Call llenarGrid_det(Me.HfdDetalle, Me.TxtNumeroDoc.Text, Me.DtcTipoDoc.BoundText, Me.TxtSerie.Text)
End Sub

Function GeneraCodTemporal() As Integer
Dim Codtemporal As Integer
Call ConfiguraRst(strCadena)
    If rst.EOF = True Then
        Codtemporal = 1
    Else
        Codtemporal = rst(0) + 1
    End If
  GeneraCodTemporal = Codtemporal
  Set rst = Nothing
End Function
Function GeneraCodTemporalCompras() As Integer
Dim Codtemporal As Integer
Call ConfiguraRst(strCadena)
    If rst.EOF = True Then
        Codtemporal = 1
    Else
        Codtemporal = rst(0) + 1
    End If
  GeneraCodTemporalCompras = Codtemporal
  Set rst = Nothing
End Function
Function GeneraCodReferencia() As Integer
Dim CodReferencia As Integer
strCadena = "SELECT IdReferencia FROM DocReferencia_Compra ORDER BY IdReferencia DESC "
Call ConfiguraRst(strCadena)
    If rst.EOF = True Then
        CodReferencia = 1
        
    Else
        CodReferencia = rst(0) + 1

    End If
  GeneraCodReferencia = CodReferencia
  
  
  Set rst = Nothing
End Function
Sub llenarGrid_det(ByVal Grilla As MSHFlexGrid, ByVal Numero As String, ByVal TipoDoc As String, ByVal serie As String)
On Error GoTo salir
Dim Total As Double, SUBTOTAL As Double, igv As Single, tpercepcion As Single
strCadena = "SELECT T.id_producto,P.nombre_prod,U.abreviatura,T.cantidad,T.c_unitario,T.valor_neto,T.dsto_soles,T.dsto_procentaje,T.otros,T.total_descuento,T.isc,T.igv,T.ivap,T.p_venta," & _
"T.p_costo,T.exonerado,T.valor_venta,T.precio_venta,T.id_temporal,cc.descripcion as color FROM movimiento_compra_temporal T,producto P,unidad U,imp_color cc WHERE P.id_color=cc.id_color and  T.id_producto=P.id_producto AND T.ruc='" & KEY_RUC & "' AND P.ruc='" & KEY_RUC & "' AND P.id_unidad=U.id_und AND U.id_usu='" & KEY_RUC & "' AND T.dni_save='" & KEY_USUARIO & "' AND T.ruc='" & KEY_RUC & "' ORDER BY T.id_temporal ASC"
Call ConfiguraRst(strCadena)
If rst.RecordCount < 1 Then
    Grilla.Rows = 1
    Grilla.Clear
    Exit Sub
End If
   Grilla.Clear
   Grilla.Rows = 0
  ReDim arrColWidth(1 To rst.Fields.Count)
       For Each Campo In rst.Fields
            Grilla.ColWidth(0) = 0
            Grilla.ColWidth(1) = 1200
            Grilla.ColWidth(2) = 3900
            Grilla.ColWidth(3) = 700
            Grilla.ColWidth(4) = 700
            Grilla.ColWidth(5) = 900
            Grilla.ColWidth(6) = 900
            Grilla.ColWidth(7) = 800
            Grilla.ColWidth(8) = 600
            Grilla.ColWidth(9) = 800
            Grilla.ColWidth(10) = 800
            Grilla.ColWidth(11) = 800
            Grilla.ColWidth(12) = 800
            Grilla.ColWidth(13) = 1000
            Grilla.ColWidth(14) = 800
            Grilla.ColWidth(15) = 1300
            
    Next
  
 
             
             Fila = "IDTEMPORAL" & vbTab & "CODIGO" & vbTab & "P R O D U C TO" & vbTab & "UND" & vbTab & "CANT" & vbTab & "P.UNIT" & vbTab & "V.NETO" & vbTab & "OTROS" & vbTab & "T.DSC" & vbTab & "ISC" & vbTab & "IVAP" & vbTab & "P.VENTA" & vbTab & "P.COSTO" & vbTab & "VALOR VENTA" & vbTab & "IGV" & vbTab & "TOTAL"
             Grilla.AddItem Fila
             For k = 0 To 15
                                Grilla.col = k
                                Grilla.Row = 0
                                Grilla.CellBackColor = &HDFDFE0
                            Next k
             Fila = ""
             cantidad = 0
             unit = 0
             neto = 0
             desS = 0
             desP = 0
             otros = 0
             Tdes = 0
             isc = 0
             igv = 0
             ivap = 0
             pventa = 0
             valor_venta = 0
             exonerado = 0
        For i = 0 To rst.RecordCount - 1

             
             Fila = rst("id_temporal") & vbTab & rst("id_producto") & vbTab & UCase(rst("nombre_prod")) & Space(2) & rst("color") & vbTab & rst("abreviatura") & vbTab & rst("cantidad") & vbTab & Format(rst("c_unitario"), "###0.00") & vbTab & Format(rst("valor_neto"), "###0.00") & vbTab & Format(rst("otros"), "###0.00") & vbTab & Format(rst("total_descuento"), "###0.00") & vbTab & Format(rst("isc"), "###0.00") & vbTab & Format(rst("ivap"), "###0.00") & vbTab & Format(rst("p_venta"), "###0.00") & vbTab & Format(rst("p_costo"), "###0.00") & vbTab & Format(rst("valor_venta"), "###0.00") & vbTab & Format(rst("igv"), "###0.00") & vbTab & Format(rst("precio_venta"), "###0.00")
             Grilla.AddItem Fila
              For k = 0 To 15
                                Grilla.col = 15
                                Grilla.Row = i + 1
                                Grilla.CellBackColor = &HC0C0FF
                            Next k
             Fila = ""
             cantidad = cantidad + rst("cantidad")
             unit = unit + rst("c_unitario")
             neto = neto + rst("valor_neto")
             desS = desS + rst("dsto_soles")
             desP = desP + rst("dsto_procentaje")
             otros = otros + rst("otros")
             Tdes = Tdes + rst("total_descuento")
             isc = isc + rst("isc")
             igv = igv + rst("igv")
             ivap = ivap + rst("ivap")
             valor_venta = valor_venta + rst("valor_venta")
             exonerado = exonerado = rst("exonerado")
             pventa = pventa + rst("precio_venta")
             Fila = ""
             rst.MoveNext
        Next i

         Fila = "" & vbTab & "" & vbTab & " ******* T       O        T       A       L      E      S *******" & vbTab & "" & vbTab & Format(cantidad, "###0.00") & vbTab & Format(unit, "###0.00") & vbTab & Format(neto, "###0.00") & vbTab & Format(otros, "###0.00") & vbTab & Format(Tdes, "###0.00") & vbTab & Format(isc, "###0.00") & vbTab & Format(ivap, "###0.00") & vbTab & "" & vbTab & "" & vbTab & Format(valor_venta, "###0.00") & vbTab & Format(igv, "###0.00") & vbTab & Format(pventa, "###0.00")
         Grilla.AddItem Fila
                        For k = 0 To 15
                                Grilla.col = k
                                Grilla.Row = i + 1
                                Grilla.CellBackColor = &HC0C0FF
                            Next k
Me.LblCantidad.Caption = Trim(rst.RecordCount)
If Me.cmdReload.Visible = False Then
Call Resalta(Me.TxtCodProducto)
End If
'Me.TxtCantidad.Text = 0

strCadena = "SELECT sum(valor_neto) as valorneto,sum(valor_venta) as valorventa,sum(total_descuento) as descuento,sum(igv) as igv,sum(exonerado) as exonerado,sum(precio_venta) as precioventa,sum(isc) as isc,sum(otros) as otros FROM movimiento_compra_temporal WHERE (numero='" & Trim(Me.TxtNumeroDoc.Text) & "' AND id_doc='" & Trim(Me.DtcTipoDoc.BoundText) & "' AND serie='" & Trim(Me.TxtSerie.Text) & "' AND dni_save='" & KEY_USUARIO & "' AND ruc='" & KEY_RUC & "')"
Call ConfiguraRst(strCadena)


If Me.ChkPercepcion.Value = 1 Then
    Me.LblPercepcion.Text = Format(Val(Me.TxtPecepcion.Text), "###0.00")
    tpercepcion = Me.LblPercepcion.Text
Else
    tpercepcion = 0
    Me.LblPercepcion.Text = "0.00"
End If

Me.lblIMPBruto.Text = Format(rst("valorneto"), "###0.00")
Me.lblDescuento.Text = Format(rst("descuento"), "###0.00")
Me.lblExonerado.Text = Format(rst("exonerado"), "###0.00")
Me.LblValorVenta.Text = Format(rst("valorventa"), "###0.00")
Me.LblIgv.Text = Format(rst("igv"), "###0.00")
Me.lblTotal.Text = Format(rst("precioventa"), "###0.00")
Me.lblISC.Text = Format(rst("isc"), "###0.00")
Me.LblPercepcion.Text = Format(Val(Me.TxtPecepcion.Text) + Val(Me.lblTotal.Text), "###0.00")
Me.lblotros.Text = Format(otros, "###0.00")
    Set rst = Nothing
  Me.TlbAcciones.Buttons(KEY_ANULAR).Enabled = False
  Me.TlbAcciones.Buttons(KEY_DELETE).Enabled = False
  Me.TlbGrabar.Buttons(KEY_SAVE).Enabled = True
  'Grilla.Row = 1
  'Grilla.col = 0
  'Grilla.ColSel = 1
  'Grilla.RowSel = 1
  Exit Sub

salir: MsgBox "Por Favor Digite Correctamente", vbInformation, "Mensaje para el usuario"
End Sub
Sub llenarGrid_Comprobante(ByVal Grilla As MSHFlexGrid, ByVal id_compra As Double)
 On Error GoTo salir
Dim Total As Double, SUBTOTAL As Double, igv As Single, tpercepcion As Single

strCadena = "SELECT D.id_producto,P.nombre_prod,U.abreviatura,D.cantidad,D.c_unitario,D.valor_neto,D.dsto_soles,D.dsto_procentaje,D.otros,D.total_descuento,D.isc,D.igv,D.ivap,D.p_venta," & _
"D.p_costo,D.exonerado,D.valor_venta,D.total as precio_venta,D.id_detalle_compra,cc.descripcion as color FROM movimiento_compra_detalle D,producto P,unidad U,imp_color cc WHERE P.id_color=cc.id_color and  D.id_producto=P.id_producto AND D.ruc='" & KEY_RUC & "' AND P.ruc='" & KEY_RUC & "' AND P.id_unidad=U.id_und AND U.id_usu='" & KEY_RUC & "' AND D.ruc='" & KEY_RUC & "' AND D.id_compra='" & id_compra & "' ORDER BY D.id_detalle_compra ASC"
Call ConfiguraRst(strCadena)
If rst.RecordCount < 1 Then
    strCadena = "SELECT * FROM movimiento_compra WHERE id_compra='" & id_compra & "' AND ruc='" & KEY_RUC & "'"
    Call ConfiguraRst(strCadena)
    If rst.RecordCount > 0 Then
        Me.lblExonerado.Text = Format(rst("exonerado"), "###0.00")
        Me.LblValorVenta.Text = Format(rst("valor_venta"), "###0.00")
        Me.lblISC.Text = Format(rst("isc"), "###0.00")
        Me.LblIgv.Text = Format(rst("igv"), "###0.00")
        Me.lblTotal.Text = Format(rst("total"), "###0.00")
        Me.LblPercepcion.Text = Format(rst("percepcion"), "###0.00")
        Me.txtobservacion.Text = rst("observacion")
        
    End If
    Grilla.Rows = 1
    Grilla.Clear
    Exit Sub
End If
   Grilla.Clear
   Grilla.Rows = 0
  ReDim arrColWidth(1 To rst.Fields.Count)
       For Each Campo In rst.Fields
            Grilla.ColWidth(0) = 0
            Grilla.ColWidth(1) = 800
            Grilla.ColWidth(2) = 3900
            Grilla.ColWidth(3) = 800
            Grilla.ColWidth(4) = 800
            Grilla.ColWidth(5) = 800
            Grilla.ColWidth(6) = 800
            Grilla.ColWidth(7) = 800
            Grilla.ColWidth(8) = 600
            Grilla.ColWidth(9) = 800
            Grilla.ColWidth(10) = 800
            Grilla.ColWidth(11) = 800
            Grilla.ColWidth(12) = 800
            Grilla.ColWidth(13) = 1000
            Grilla.ColWidth(14) = 800
            Grilla.ColWidth(15) = 1300
            
    Next
  
 
             
             Fila = "IDTEMPORAL" & vbTab & "CODIGO" & vbTab & "P R O D U C TO" & vbTab & "UND" & vbTab & "CANT" & vbTab & "P.UNIT" & vbTab & "V.NETO" & vbTab & "OTROS" & vbTab & "T.DSC" & vbTab & "ISC" & vbTab & "IVAP" & vbTab & "P.VENTA" & vbTab & "P.COSTO" & vbTab & "VALOR VENTA" & vbTab & "IGV" & vbTab & "TOTAL"
             Grilla.AddItem Fila
             For k = 0 To 15
                                Grilla.col = k
                                Grilla.Row = 0
                                Grilla.CellBackColor = &HDFDFE0
                            Next k
             Fila = ""
             cantidad = 0
             unit = 0
             neto = 0
             desS = 0
             desP = 0
             otros = 0
             Tdes = 0
             isc = 0
             igv = 0
             ivap = 0
             pventa = 0
             valor_venta = 0
             exonerado = 0
        For i = 0 To rst.RecordCount - 1

             
             Fila = rst("id_detalle_compra") & vbTab & rst("id_producto") & vbTab & UCase(rst("nombre_prod")) & Space(2) & rst("color") & vbTab & rst("abreviatura") & vbTab & rst("cantidad") & vbTab & Format(rst("c_unitario"), "###0.00") & vbTab & Format(rst("valor_neto"), "###0.00") & vbTab & Format(rst("otros"), "###0.00") & vbTab & Format(rst("total_descuento"), "###0.00") & vbTab & Format(rst("isc"), "###0.00") & vbTab & Format(rst("ivap"), "###0.00") & vbTab & Format(rst("p_venta"), "###0.00") & vbTab & Format(rst("p_costo"), "###0.00") & vbTab & Format(rst("valor_venta"), "###0.00") & vbTab & Format(rst("igv"), "###0.00") & vbTab & Format(rst("precio_venta"), "###0.00")
             Grilla.AddItem Fila
              For k = 0 To 15
                                Grilla.col = 15
                                Grilla.Row = i + 1
                                Grilla.CellBackColor = &HC0C0FF
                            Next k
             Fila = ""
             cantidad = cantidad + rst("cantidad")
             unit = unit + rst("c_unitario")
             neto = neto + rst("valor_neto")
             desS = desS + rst("dsto_soles")
             desP = desP + rst("dsto_procentaje")
             otros = otros + rst("otros")
             Tdes = Tdes + rst("total_descuento")
             isc = isc + rst("isc")
             igv = igv + rst("igv")
             ivap = ivap + rst("ivap")
             valor_venta = valor_venta + rst("valor_venta")
             exonerado = exonerado = rst("exonerado")
             pventa = pventa + rst("precio_venta")
             Fila = ""
             rst.MoveNext
        Next i

         Fila = "" & vbTab & "" & vbTab & " ******* T       O        T       A       L      E      S *******" & vbTab & "" & vbTab & Format(cantidad, "###0.00") & vbTab & Format(unit, "###0.00") & vbTab & Format(neto, "###0.00") & vbTab & Format(otros, "###0.00") & vbTab & Format(Tdes, "###0.00") & vbTab & Format(isc, "###0.00") & vbTab & Format(ivap, "###0.00") & vbTab & "" & vbTab & "" & vbTab & Format(valor_venta, "###0.00") & vbTab & Format(igv, "###0.00") & vbTab & Format(pventa, "###0.00")
         Grilla.AddItem Fila
                        For k = 0 To 15
                                Grilla.col = k
                                Grilla.Row = i + 1
                                Grilla.CellBackColor = &HC0C0FF
                            Next k
Me.LblCantidad.Caption = Trim(rst.RecordCount)
If Me.cmdReload.Visible = False Then
    Call Resalta(Me.TxtCodProducto)
End If
'Me.TxtCantidad.Text = 0

strCadena = "SELECT sum(valor_neto) as valorneto,sum(valor_venta) as valorventa,sum(total_descuento) as descuento,sum(igv) as igv,sum(exonerado) as exonerado,sum(total) as precioventa,sum(isc) as isc FROM movimiento_compra_detalle WHERE id_compra='" & id_compra & "' AND  ruc='" & KEY_RUC & "'"
Call ConfiguraRst(strCadena)


If Me.ChkPercepcion.Value = 1 Then
    Me.LblPercepcion.Text = Format(Val(Me.TxtPecepcion.Text), "###0.00")
    tpercepcion = Me.LblPercepcion.Text
Else
    tpercepcion = 0
    Me.LblPercepcion.Text = "0.00"
End If

Me.lblIMPBruto.Text = Format(rst("valorneto"), "###0.00")
Me.lblDescuento.Text = Format(rst("descuento"), "###0.00")
Me.lblExonerado.Text = Format(rst("exonerado"), "###0.00")
Me.LblValorVenta.Text = Format(rst("valorventa"), "###0.00")
Me.LblIgv.Text = Format(rst("igv"), "###0.00")
Me.lblTotal.Text = Format(rst("precioventa"), "###0.00")
Me.lblISC.Text = Format(rst("isc"), "###0.00")
Me.LblPercepcion.Text = Format(Val(Me.TxtPecepcion.Text) + Val(Me.lblTotal.Text), "###0.00")
    
    Set rst = Nothing
  Me.TlbAcciones.Buttons(KEY_ANULAR).Enabled = True
  Me.TlbAcciones.Buttons(KEY_DELETE).Enabled = True
  Me.TlbGrabar.Buttons(KEY_SAVE).Enabled = False
 ' Grilla.Row = 1
 ' Grilla.col = 0
  'Grilla.ColSel = 1
  'Grilla.RowSel = 1
  Exit Sub

salir: MsgBox "Por Favor Digite Correctamente", vbInformation, "Mensaje para el usuario"

End Sub

Private Sub ChameleonBtn2_Click()

End Sub

Private Sub ChameleonBtn1_Click()

End Sub

Private Sub chkIGV_Click()
    If Val(Me.txtcantidad.Text) > 0 And Val(Me.TxtPrecioVenta.Text) > 0 Then
        Call calculo_igv
    End If
End Sub
Private Sub calculo_igv()
Dim utilidad As Single
    Dim costo As Single
    Dim venta As Single
    Dim unidades As Single
    Dim val_igv As Single
    Dim cantidad As Single
    Dim isc_v As Single
    Dim ivap As Single
    Dim Descuento As Single
    venta = Val(Me.txtPrecioVentaAnt.Text)
    unidades = Val(Me.TxtUnidades.Text)
    precio_unit = Val(Me.TxtUnitario.Text)
    cantidad = Me.txtcantidad.Text
    isc_v = Val(Me.txtisc.Text)
    ivap = Val(Me.TxtIvap.Text)
    Descuento = Val(Me.TxtTotalDescuento.Text)
    
    If Me.chkigv.Value = 1 Then
        Me.txtIgv_Porcentaje.Text = KEY_IGV * 100
        'Me.txtIgv.text = Format((precio_unit * cantidad + Val(Me.txtOtros.text)) * KEY_IGV + KEY_IGV * isc_v, "###0.000")
       ' Me.txtigv.text = Format(Val(Me.txtvalorventa.text) * KEY_IGV, "###0.00")
        'Me.txtIgv.Text = Format(Val(Me.txtvalorventa.Text) / (1 + KEY_IGV) * KEY_IGV, "###0.00")
        val_igv = KEY_IGV + 1
        If ivap > 0 Then
         ' Me.TxtPrecioVenta.Text = Format(precio_unit * cantidad * unidades + isc_v + KEY_IGV * isc_v + Val(Me.txtIgv.Text) + ivap, "###0.00")
         Me.txtvalorventa.Text = Format(Val(Me.TxtPrecioVenta.Text) / val_igv, "###0.00")
        Else
        Me.txtvalorventa.Text = Format(Val(Me.TxtPrecioVenta.Text) / val_igv, "###0.00")
        Me.TxtIgv.Text = Format(Val(Me.TxtPrecioVenta.Text) - Val(Me.txtvalorventa.Text), "###0.00")
        'Me.TxtPrecioVenta.Text = Format((precio_unit * cantidad + Val(Me.txtOtros.Text)) * val_igv + isc_v + KEY_IGV * isc_v - Val(Me.TxtTotalDescuento.Text) * (val_igv), "###0.00")
        'Me.TxtPrecioVenta.Text = Format((precio_unit * cantidad + Val(Me.txtOtros.Text)) + isc_v + KEY_IGV * isc_v - Val(Me.TxtTotalDescuento.Text), "###0.00")
        End If
          'costo = (Val(Me.TxtUnitario.Text) - Val(Me.TxtTotalDescuento.Text) / Val(Me.TxtCantidad.Text)) * (1 + KEY_IGV) + Val(Me.txtOtros.Text) / (Val(Me.TxtCantidad.Text) * Val(Me.TxtUnidades.Text))
          costo = (Val(Me.TxtUnitario.Text) - Val(Me.TxtTotalDescuento.Text) / Val(Me.txtcantidad.Text)) + Val(Me.txtOtros.Text) / (Val(Me.txtcantidad.Text) * Val(Me.TxtUnidades.Text))
          'costo = (Val(Me.TxtUnitario.Text) - Val(Me.TxtTotalDescuento.Text) / Val(Me.TxtCantidad.Text)) + Val(Me.txtOtros.Text) / (Val(Me.TxtCantidad.Text) * Val(Me.TxtUnidades.Text))
    Else
        Me.txtIgv_Porcentaje.Text = "0"
        Me.TxtIgv.Text = 0#
        val_igv = 1
        costo = (Val(Me.TxtUnitario.Text) - Val(Me.TxtTotalDescuento.Text) / Val(Me.txtcantidad.Text)) + Val(Me.txtOtros.Text) / (Val(Me.txtcantidad.Text) * Val(Me.TxtUnidades.Text))
        Me.TxtPrecioVenta.Text = Format((precio_unit * cantidad + Val(Me.txtOtros.Text)) * val_igv + isc_v + ivap - Val(Me.TxtTotalDescuento.Text), "###0.00")
    End If
    If Val(Me.txtcantidad.Text) <= 0 Then
        Exit Sub
    End If
  
    If Me.DtcMoneda.BoundText = "00002" Then
        Me.TxtCostoHoy.Text = Format(costo * Val(Me.TxtTc.Text), "###0.00")
    Else
        Me.TxtCostoHoy.Text = Format(costo, "###0.00")
    End If
    
    
    If costo > 0 Then
        utilidad = 15 '(costo - costo) * 100 / costo
        Me.txtUtilidadhoy.Text = Format(utilidad, "###0.00")
        costo = Val(Me.TxtCostoHoy.Text)
        utilidad = Val(Me.txtUtilidadhoy.Text)
        venta = costo + costo * utilidad / 100
        Me.TxtventaHoy.Text = Format(venta, "###0.00")
    End If
   
   Call Resalta(Me.txtUtilidadhoy)
  
End Sub
Private Sub chkModo_Click()
   Dim unitario As Single
    Dim precio_venta As Single
    Dim cantidad As Single
    Dim unidades As Single
    Dim utilidad As Single
    Dim p_venta As Single
    Dim val_igv As Single
    If (Val(Me.txtIgv_Porcentaje.Text) > 0) Then
        val_igv = KEY_IGV + 1
    Else
        val_igv = 1
    End If
    unidades = Val(Me.TxtUnidades.Text)
    cantidad = Val(Me.txtcantidad.Text)
    precio_venta = Me.TxtPrecioVenta.Text
If Me.chkModo.Value = 1 Then
    
    If cantidad > 0 And unidades > 0 Then
        unitario = precio_venta / (cantidad * unidades)
       ' Me.TxtUnitario.Text = Format(unitario, "#,##0.00")
        If Val(Me.TxtDctoSoles.Text) > 0 Then
            Me.TxtCostoHoy.Text = Format(unitario, "###0.00")
        Else
            Me.TxtCostoHoy.Text = Format(unitario, "###0.00")
        End If
        utilidad = Val(Me.txtUtilidadhoy.Text)
        p_venta = unitario * val_igv + (utilidad * unitario) / 100
        Me.TxtventaHoy.Text = Format(p_venta, "###0.00")
        Call Resalta(Me.TxtventaHoy)
    End If
Else
        
    unitario = Val(Me.TxtCostoHoy.Text) * unidades
    Me.TxtCostoHoy.Text = Format(unitario, "###0.00")
   
    
End If
End Sub

Private Sub ChkPercepcion_Click()
If Me.ChkPercepcion.Value = 1 Then
    Me.TxtPecepcion.Visible = True
    Me.lblpercep_titulo.Visible = True
    Me.LblPercepcion.Visible = True
    Me.TxtPecepcion.Text = 0
    Call Resalta(Me.TxtPecepcion)
    
    Me.LblPercepcion.Text = Format(Val(Me.lblTotal.Text) + Val(Me.TxtPecepcion.Text), "###0.00")
    
   
Else
    Me.lblpercep_titulo.Visible = False
    Me.LblPercepcion.Visible = False
    Me.TxtPecepcion.Visible = False
End If
End Sub





Private Sub cmdactivar_Click()
 
 Call Prender
End Sub

Private Sub CmdActualizar_Click()
If Val(Me.TxtCostoHoy.Text) > 0 And Val(Me.TxtventaHoy.Text) > 0 And Val(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 0)) > 0 Then
    If MsgBox("ESTA SEGURO DE CAMBIAR LOS PRECIOS", vbQuestion + vbYesNo, KEY_EMPRESA) = vbYes Then
        strCadena = "UPDATE producto SET precio_compra='" & Val(Me.TxtCostoHoy.Text) & "',precio_venta='" & Val(Me.TxtventaHoy.Text) & "' WHERE id_producto='" & Trim(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 0)) & "' AND ruc='" & KEY_RUC & "'"
        CnBd.Execute (strCadena)
         
    End If
End If
End Sub

Private Sub CmdAgregar_Click()
strCadena = "SELECT * FROM movimiento_compra_temporal WHERE (numero='" & Trim(Me.TxtNumeroDoc.Text) & "' AND id_doc='" & Trim(Me.DtcTipoDoc.BoundText) & "' AND serie='" & Trim(Me.TxtSerie.Text) & "' AND dni_save='" & KEY_USUARIO & "') ORDER BY id_temporal ASC "
Call ConfiguraRst(strCadena)
If rst.RecordCount < 100 Then
    Call AgregarNuevo
 Else: MsgBox "Cantidad de Articulos Excede al Comprobante", vbInformation
    Exit Sub
End If

End Sub

Private Sub CmdAgregarG_Click()
Dim IdCompras As Double
'If Me.DtcDocumento.BoundText = "" Or Me.TxtSerieG.Text = "" Or Me.TxtNumeroG.Text = "" Or Val(Me.TxtMontoG.Text) <= 0 Then
 '   MsgBox "Ingrese Datos Correctos", vbInformation, "mensaje para el Usuario"
'Else
 '   IdCompras = IdInsert("DocumentoCompra")
  '  strCadena = "INSERT INTO DocumentoCompraGastos(idCompra,doc_cod,serie,numero,monto,detalle) VALUES " & _
   ' "('" & IdCompras & "','" & Me.DtcDocumento.BoundText & "','" & Me.TxtSerieG.Text & "','" & Me.TxtNumeroG.Text & "','" & Val(Me.TxtMontoG.Text) & "','" & Me.TXtDetalleG.Text & "')"
    'CnBd.Execute (strCadena)
    'Call LlenarGastos(Me.MfGasto, IdCompras)
    'Me.TxtSerieG.Text = ""
    'Me.TxtNumeroG.Text = ""
    'Me.TxtMontoG.Text = 0#
    'Me.TXtDetalleG.Text = ""
    'Me.DtcDocumento.SetFocus
'End If
End Sub

Private Sub cmdcerrardua_Click()
Me.framedua.Visible = False
End Sub

Private Sub cmdcerrarpantalla_Click()
Me.FrameCaracteristicas.Visible = False
End Sub

Private Sub CMDCONSULTADUA_Click()
frmconsultadua.Show
Exit Sub
End Sub

Private Sub cmdDatosdua_Click()
Me.framedua.Visible = True
End Sub

Private Sub cmdGastos_Click()
strCadena = "SELECT * FROM movimiento_compra WHERE id_doc='" & Me.DtcTipoDoc.BoundText & "' AND serie='" & Me.TxtSerie.Text & "' AND  numero='" & Me.TxtNumeroDoc.Text & "' AND id_proveedor='" & Me.TxtRuc.Text & "' AND ruc='" & KEY_RUC & "'"
Call ConfiguraRst(strCadena)
If rst.RecordCount > 0 Then
    FrmComprasGastos.TxtIdCompra.Text = rst("id_compra")
    FrmComprasGastos.Show
    If DtTipoCompra.BoundText <> "01" Then
        FrmComprasGastos.SSTab1.TabVisible(0) = False
    Else
        FrmComprasGastos.SSTab1.TabVisible(0) = True
        FrmComprasGastos.SSTab1.Tab = 0
    End If
    
Else
    MsgBox "ANTES DE INGRESAR GASTOS, GUARDE ESTE COMPROBANTE", vbInformation, KEY_EMPRESA
End If
Set rst = Nothing

End Sub

Private Sub cmdIngresoSerie_Click()
Call llenar_series_producto(Val(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 0)), Me.HfItem)
End Sub

Private Sub cmdprocesar_Click()
Dim estado As String
If Trim(Me.txtnumeroserie.Text) <> "" And Trim(Me.txtseriechasis.Text) <> "" Then
    estado = "si"
Else
    estado = "no"
End If


strCadena = "SELECT * FROM imp_producto_detalle WHERE nro_motor='" & Trim(Me.txtnumeroserie.Text) & "' and nro_chasis='" & Trim(Me.txtseriechasis.Text) & "' and ruc='" & KEY_RUC & "' "
Call ConfiguraRstZ(strCadena)
If rstZ.RecordCount > 0 Then
    If MsgBox("ESTA SERIE YA ESTA REGISTRADA" + Chr(13) + "DESEA MODIFICARLA", vbYesNo + vbQuestion) = vbYes Then
        strCadena = "UPDATE imp_producto_detalle SET serie='" & Trim(Me.txtnumeroserie.Text) & "',anio_fabricacion='" & Trim(Me.txtAñoFabricacion.Text) & "',anio_contenedor='" & Trim(Me.TxtAnioDua.Text) & "',nro_contenedor='" & Trim(Me.txtnumero_dua.Text) & "',nro_chasis='" & Trim(Me.txtseriechasis.Text) & "',nro_motor='" & Trim(Me.txtseriemotor.Text) & "',anio_modelo='" & Trim(Me.txtañomodelo.Text) & "',item='" & Trim(Me.txtitemdua.Text) & "',dni_save='" & KEY_USUARIO & "',fecha_mod=CURDATE(),hora_mod=CURTIME(),serie_asignada='" & estado & "' WHERE id_detalle='" & Val(Me.HfItem.TextMatrix(Me.HfItem.Row, 1)) & "' AND ruc='" & KEY_RUC & "'"
        CnBd.Execute (strCadena)
        Exit Sub
    End If
    
End If




strCadena = "UPDATE imp_producto_detalle SET serie='" & Trim(Me.txtnumeroserie.Text) & "',anio_fabricacion='" & Trim(Me.txtAñoFabricacion.Text) & "',anio_contenedor='" & Trim(Me.TxtAnioDua.Text) & "',nro_contenedor='" & Trim(Me.txtnumero_dua.Text) & "',nro_chasis='" & Trim(Me.txtseriechasis.Text) & "',nro_motor='" & Trim(Me.txtseriemotor.Text) & "',anio_modelo='" & Trim(Me.txtañomodelo.Text) & "',item='" & Trim(Me.txtitemdua.Text) & "',dni_save='" & KEY_USUARIO & "',fecha_mod=CURDATE(),hora_mod=CURTIME(),serie_asignada='" & estado & "' WHERE id_detalle='" & Val(Me.HfItem.TextMatrix(Me.HfItem.Row, 1)) & "' AND ruc='" & KEY_RUC & "'"


'strCadena = "UPDATE imp_producto_detalle SET serie='" & Trim(Me.txtnumeroserie.Text) & "',anio_fabricacion='" & Trim(Me.txtAñoFabricacion.Text) & "',anio_contenedor='" & Trim(Me.TxtAnioDua.Text) & "',nro_contenedor='" & Trim(Me.txtnumero_dua.Text) & "',nro_chasis='" & Trim(Me.txtseriechasis.Text) & "',nro_motor='" & Trim(Me.txtseriemotor.Text) & "',anio_modelo='" & Trim(Me.txtañomodelo.Text) & "',item='" & Trim(Me.txtitemdua.Text) & "',dni_save='" & KEY_USUARIO & "',fecha_mod=CURDATE(),hora_mod=CURTIME(),serie_asignada='" & estado & "' WHERE nro_chasis='" & Trim(Me.txtChasisG.Text) & "' and nro_motor='" & Trim(Me.txtMotorG.Text) & "' AND ruc='" & KEY_RUC & "'"
CnBd.Execute (strCadena)
 

strCadena = "SELECT * FROM kardex where nro_chasis='" & Trim(Me.txtChasisG.Text) & "' and nro_motor='" & Trim(Me.txtMotorG.Text) & "'"


If estado = "si" Then
           
           Me.HfItem.TextMatrix(Me.HfItem.Row, 6) = Chr(254)
            For j = 0 To 6
                Me.HfItem.col = j
                HfItem.Row = Me.HfItem.Row
                HfItem.CellBackColor = &HC0FFC0
            Next j
        Else
          
            Me.HfItem.TextMatrix(Me.HfItem.Row, 6) = Chr(168)
            For j = 0 To 6
                HfItem.col = j
                HfItem.Row = Me.HfItem.Row
                HfItem.CellBackColor = &HFFFFFF
            Next j
        End If
    If Val(Me.HfItem.TextMatrix(Me.HfItem.Row, 0)) < Val(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 4)) Then
        HfItem.Row = HfItem.Row + 1
        HfItem.col = 0
        HfItem.ColSel = 6
        HfItem.RowSel = HfItem.Row
        Me.txtitemdua.Text = Format(Val(Me.txtitemdua.Text) + 1, "0000")
        'Me.txtnumeroserie.Text=""
        'Me.txtseriechasis.Text = ""
        'Me.txtseriemotor.Text = ""
        Call Resalta(Me.txtnumeroserie)
        Exit Sub
    End If

End Sub

Private Sub CmdQuitar_Click()
If Me.HfdDetalle.Rows > 0 Then
Me.HfdDetalle.col = 0
Call Quitar(Me.HfdDetalle.Text)
End If
End Sub
Private Sub Quitar(ByVal codigo As String)
If Val(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 0)) > 0 Then
strCadena = "DELETE FROM movimiento_compra_temporal WHERE id_temporal='" & Val(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 0)) & "' AND dni_save='" & KEY_USUARIO & "' AND ruc='" & KEY_RUC & "'"
CnBd.Execute (strCadena)
 
Call llenarGrid_det(Me.HfdDetalle, Trim(Me.TxtNumeroDoc.Text), Trim(Me.DtcTipoDoc.BoundText), Trim(Me.TxtSerie.Text))
End If
End Sub



Private Sub cmdRecalcular_Click()
If MsgBox("ESTA SEGURO DE RECALCULAR", vbQuestion + vbYesNo, KEY_EMPRESA) = vbYes Then
Dim totalGastos As Double
Dim incremento As Double, tcosto As Double, tventa As Double, TUtilidad As Single, tcantidad As Double
If (Val(Me.lblImportacion.Text) + Val(Me.lblgastos.Text)) > 0 And Val(Me.LblCantidad.Caption) > 0 Then
    totalGastos = Val(Me.lblImportacion.Text) + Val(Me.lblgastos.Text)
    strCadena = "SELECT sum(cantidad) FROM movimiento_compra_temporal WHERE id_doc='" & Me.Txtdoc_cod.Text & "' AND serie='" & Me.TxtSeriaGuardada.Text & "' AND numero='" & Me.TxtNumeroGuardado.Text & "' AND dni_save='" & KEY_USUARIO & "' AND ruc='" & KEY_RUC & "'"
    Call ConfiguraRst(strCadena)
    If IsNull(rst(0)) = True Then
       tcantidad = 0
    Else
       tcantidad = rst(0)
        strCadena = "SELECT * FROM movimiento_compra_temporal WHERE id_doc='" & Me.Txtdoc_cod.Text & "' AND serie='" & Me.TxtSeriaGuardada.Text & "' AND numero='" & Me.TxtNumeroGuardado.Text & "' AND dni_save='" & KEY_USUARIO & "' AND ruc='" & KEY_RUC & "'"
        Call ConfiguraRst(strCadena)
        rst.MoveFirst
        For i = 0 To rst.RecordCount - 1
            tcosto = 0
            tventa = 0
            incremento = Format((rst("cantidad") * totalGastos / tcantidad) / rst("cantidad"), "###0.00")
            tcosto = rst("p_costo") + incremento
            TUtilidad = ((rst("p_venta") - rst("p_costo")) * 100 / rst("p_costo"))
            
            tventa = tcosto + (tcosto * TUtilidad) / 100
            strCadena = "UPDATE movimiento_compra_temporal SET otros='" & incremento * rst("cantidad") & "',p_costo='" & tcosto & "',p_venta='" & tventa & "' WHERE id_temporal='" & rst("id_temporal") & "' AND dni_save='" & KEY_USUARIO & "' AND ruc='" & KEY_RUC & "'"
            CnBd.Execute (strCadena)
             
            rst.MoveNext
        Next i
        Call llenarGrid_det(Me.HfdDetalle, Me.TxtNumeroDoc.Text, Me.DtcTipoDoc.BoundText, Me.TxtSerie.Text)
    End If
    Me.cmdRecalcular.Enabled = False
End If
End If
End Sub

Private Sub cmdReload_Click()
If Val(Me.TxtIdCompra.Text) > 0 Then
    Call buscar_comprobante(Val(Me.TxtIdCompra.Text))
End If
End Sub

Private Sub cmdRevertir_Click()
If Me.TxtCodProducto.Text <> "" Then
    If KEY_CON_IGV = "si" And Me.chkigv.Value = 1 Then
        exonerado = 0
        igv = Val(Me.TxtIgv.Text)
        valor_venta = Val(Me.txtvalorventa.Text)
        
    Else
        exonerado = Val(Me.TxtPrecioVenta.Text)
        igv = 0
        valor_venta = 0
    End If
    strCadena = "UPDATE movimiento_compra_temporal SET id_producto='" & Trim(Me.TxtCodProducto.Text) & "',cantidad='" & Val(Me.txtcantidad.Text) * Val(Me.TxtUnidades.Text) & "'," & _
    "c_unitario='" & Val(Me.TxtUnitario.Text) & "',dsto_soles='" & Val(Me.TxtDctoSoles.Text) & "',dsto_procentaje='" & Val(Me.TxtDstoporcentaje.Text) & "',total_descuento='" & Val(Me.TxtTotalDescuento.Text) & "'," & _
    "valor_neto='" & Val(Me.TxtValoerNeto.Text) & "',isc='" & Val(Me.txtisc.Text) & "',igv='" & igv & "',ivap='" & Val(Me.TxtIvap.Text) & "',otros='" & Val(Me.txtOtros.Text) & "',percepcion='" & Val(Me.txtOtros.Text) & "'," & _
    "exonerado='" & exonerado & "',valor_venta='" & valor_venta & "',precio_venta='" & Val(Me.TxtPrecioVenta.Text) & "',p_venta='" & Val(Me.TxtventaHoy.Text) & "',p_costo='" & Val(Me.TxtCostoHoy.Text) & "' WHERE dni_save='" & KEY_USUARIO & "' AND ruc='" & KEY_RUC & "' AND id_temporal='" & Val(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 0)) & "'"
    CnBd.Execute (strCadena)
     
    Call llenarGrid_det(Me.HfdDetalle, Me.TxtNumeroDoc.Text, Me.DtcTipoDoc.BoundText, Me.TxtSerie.Text)
End If
End Sub

Private Sub Command1_Click()

End Sub

Private Sub DtcAlmacen_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Me.DtcTipoDoc.SetFocus
End If
End Sub






Private Sub DtcDocumento_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Call Resalta(Me.TxtSerieG)
End If
End Sub

Private Sub DtcMoneda_Change()
If Me.DtcMoneda.BoundText = "00002" Then
   Me.lblcambio.Visible = True
   
   Me.chkConvertir.Visible = True
Else
    Me.lblcambio.Visible = True
   
    Me.chkConvertir.Visible = False
End If
End Sub

Private Sub DtcMoneda_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Call Resalta(Me.TxtTc)
End If
End Sub

Private Sub Dtcperiodo_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Call Resalta(Me.TxtRuc)
End If
End Sub

Private Sub DtcProveedor_Change()
'Me.TxtCodProveedor.text = Me.DtcProveedor.BoundText
Call buscarcliente
End Sub

Private Sub DtcRelacionado_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Me.TxtSerieR.SetFocus
End If
End Sub

Private Sub DtcTipoDoc_Change()
If Me.DtcTipoDoc.BoundText = "0007" Or Me.DtcTipoDoc.BoundText = "0040" Or Me.DtcTipoDoc.BoundText = "0091" Or Trim(Me.DtcTipoDoc.Text) = "DETRACCION" Then
    Me.Frame_Relacionado.Visible = True
    Me.TlbGrabar.Buttons(KEY_SAVE).Enabled = True
    
Else
    Me.Frame_Relacionado.Visible = False
End If
End Sub

Private Sub DtcTipoDoc_Click(Area As Integer)
doc_cod = Me.DtcTipoDoc.BoundText
Call VerificaIdentificacion(doc_cod)

End Sub
Private Sub VerificaIdentificacion(ByVal TipoDoc As String)
If TipoDoc = "0003" Then
   ' Me.LblIdentificacion.Caption = "DNI:"
Else
    'Me.LblIdentificacion.Caption = "Ruc:"
End If
End Sub
Private Sub DtcTipoDoc_KeyDown(KeyCode As Integer, Shift As Integer)
If KeyCode = vbKeyLeft Then
        Me.DtcAlmacen.SetFocus
End If
If KeyCode = vbKeyRight Then
    Call Resalta(Me.TxtSerie)
End If
End Sub

Private Sub DtcTipoDoc_KeyPress(KeyAscii As Integer)

If KeyAscii = 13 Then
    If Me.DtcTipoDoc.BoundText = "0007" Then
        Me.TlbGrabar.Buttons(KEY_SAVE).Enabled = True
    End If
    
    If (Me.DtcTipoDoc.BoundText = "0089") Then
        
strCadena = "SELECT serie,numero FROM  almacen_comprobante WHERE id_doc='" & Trim(Me.DtcTipoDoc.BoundText) & "' AND  id_alm='" & Trim(Me.DtcAlmacen.BoundText) & "' AND ruc='" & Trim(KEY_RUC) & "'"
 'StrCadena = "SELECT serie FROM Det_alm_com  WHERE doc_cod='" & Trim(Me.DtcTipoDoc.BoundText) & "' AND id_usuario='" & Trim(KEY_USUARIO) & "'"
        Call ConfiguraRst(strCadena)
        If rst.RecordCount < 1 Then
            MsgBox "USTED NO CUENTA CON NINGUNA SERIE ASIGNADA", vbInformation, "MENSAJE PARA EL USUARIO"
            Exit Sub
        End If
        
        'x = Rst.RecordCount
        Me.TxtSerie.Text = rst(0)
        Me.TxtNumeroDoc.Text = formato_item(rst(1), 8)
        
        '---
       
    
    strCadena = "SELECT serie,numero FROM movimiento_compra WHERE (numero='" & Trim(Me.TxtNumeroDoc.Text) & "' AND serie='" & Trim(Me.TxtSerie.Text) & "' AND id_doc='" & Trim(Me.DtcTipoDoc.BoundText) & "')"
    Call ConfiguraRst(strCadena)
    If rst.RecordCount < 1 Then
        Set rst = Nothing
        strCadena = "SELECT * FROM movimiento_compra_temporal WHERE (serie='" & Trim(Me.TxtSerie.Text) & "' AND id_doc='" & Trim(Me.DtcTipoDoc.BoundText) & "' AND numero='" & Trim(Me.TxtNumeroDoc.Text) & "' AND ruc='" & KEY_RUC & "')"
        Call ConfiguraRst(strCadena)
        If rst.RecordCount > 0 Then
        Call llenarGrid_det(Me.HfdDetalle, Me.TxtNumeroDoc.Text, Me.DtcTipoDoc.BoundText, Me.TxtSerie.Text)
        Me.TlbGrabar.Buttons(KEY_SAVE).Enabled = True
        End If
        Set rst = Nothing
        
        
        If IsDate(Me.TxtFecha_emision.Text) = False Then
            Me.TxtFecha_emision.Text = CVDate(KEY_FECHA)
        End If
        
        
        
        If Format(CVDate(Me.TxtFecha_emision.Text), "YYYY-mm-dd") <> KEY_FECHA Then
            If MsgBox("la Fecha no Coincide con la Fecha del Documento...Desea Continuar", vbInformation + vbYesNo, KEY_EMPRESA) = vbYes Then
                Me.TxtRuc.Text = ""
                Call Resalta(Me.TxtRuc)
            Else
                Call Resalta(Me.TxtFecha_emision)
            End If
        Else
                Me.TxtRuc.Text = ""
                Call Resalta(Me.TxtRuc)
        ProcendenciaGuia = NuevaGuia
    End If
End If
        '---
        
        Call Resalta(Me.TxtRuc)
        Set rst = Nothing
    Else
    Me.TxtSerie.Text = "0000"
    Me.TxtNumeroDoc.Text = "00000000"
    Call Resalta(Me.TxtSerie)
    End If
End If
End Sub








Private Sub DtTipoCompra_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    
    If Me.DtTipoCompra.BoundText = "01" Then
      ' Me.cmdGastos.Visible = True
        Me.cmdGastos.Caption = "GASTOS IMPORTACION"
    Else
        Me.cmdGastos.Caption = "OTROS GASTOS"
    End If
    Me.DtcMoneda.SetFocus
End If
End Sub

Private Sub Form_Activate()
FrmCompras.DtcTipoDoc.Locked = False
End Sub

Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
 If Shift = 2 And KeyCode = Asc("G") Then
    If Int(Me.lblTotal.Text) > 1 Then
        Call Save
        Exit Sub
    Else
        If MsgBox("Esta Intentado Grabar una Factura con Monto CERO" + Chr(13) + "Desea Continuar", vbQuestion + vbYesNo) = vbYes Then
            Call Save
            Exit Sub
        End If
  End If
End If

If KeyCode = 122 Then
    Me.DtTipoCompra.SetFocus
End If
End Sub
Private Sub Form_Load()
CenterForm Me
Me.Top = 10

Me.HfItem.SelectionMode = flexSelectionByRow
HfItem.FocusRect = flexFocusNone



Me.TxtTc.Text = KEY_CAMBIO
Me.TxtPecepcion.Text = 0
precio_unit = 0
rever = False
    Me.TxtFecha_emision.Mask = ""
    Me.TxtFecha_emision.Text = ""
    Me.TxtFecha_emision.Mask = "##/##/####"
    Me.txtfecha_Vencimiento.Mask = ""
    Me.txtfecha_Vencimiento.Text = ""
    Me.txtfecha_Vencimiento.Mask = "##/##/####"


Me.dtpFechaRegistro.Value = KEY_FECHA
Me.dtpFechaRegistro.Enabled = False
Me.ChkRecalcular.Value = 0
Me.Dtpproducto_vencimiento.Value = KEY_FECHA
 
 
 
 

 strCadena = "SELECT id_alm as Codigo, descripcion as Descripcion FROM almacen WHERE ruc='" & KEY_RUC & "'  ORDER BY id_alm"
  Call ConfiguraRst(strCadena)
  Call LlenaDataCombo(Me.DtcAlmacen)
  Me.DtcAlmacen.BoundText = KEY_ALM
  Me.DtcAlmacen.Enabled = False
  
  
  strCadena = "SELECT id as Codigo,CONCAT(Nombre,'-',Ejercicio) as Descripcion FROM con_periodo order by id"
  Call ConfiguraRst(strCadena)
  Call LlenaDataCombo(Me.DtcPeriodo)
  Me.DtcPeriodo.BoundText = get_periodo_actual(KEY_FECHA)
  
  
   
  
  
  strCadena = "SELECT id_tipoproducto as Codigo,descripcion as Descripcion FROM tipo_producto  WHERE ruc='" & KEY_RUC & "'"
  Call ConfiguraRst(strCadena)
  Call LlenaDataCombo(Me.DtcTipo)
  Me.DtcTipo.BoundText = "01"
   
  
  strCadena = "SELECT id_moneda as Codigo, descripcion as Descripcion FROM moneda ORDER BY id_moneda ASC"
  Call ConfiguraRst(strCadena)
  Call LlenaDataCombo(Me.DtcMoneda)
  Me.DtTipoCompra.BoundText = "01"
  
  strCadena = "SELECT tipo_compra as Codigo, descripcion as Descripcion FROM tipo_compra   ORDER BY tipo_compra ASC"
  Call ConfiguraRst(strCadena)
  Call LlenaDataCombo(Me.DtTipoCompra)
  Me.DtTipoCompra.BoundText = "03"
   
  strCadena = "SELECT id_doc as Codigo, doc_des as Descripcion FROM comprobantes ORDER BY doc_des"
  Call ConfiguraRst(strCadena)
  Call LlenaDataCombo(Me.DtcTipoDoc)
  Me.DtcTipoDoc.BoundText = "0001"
   
  strCadena = "SELECT id_doc as Codigo, doc_des as Descripcion FROM comprobantes ORDER BY doc_des"
  Call ConfiguraRst(strCadena)
  Call LlenaDataCombo(Me.DtcDocumento)
  Me.DtcDocumento.BoundText = "0110"
  
   strCadena = "SELECT id_doc as Codigo, doc_abrev as Descripcion FROM comprobantes  ORDER BY doc_des"
  Call ConfiguraRst(strCadena)
  Call LlenaDataCombo(Me.DtcRelacionado)
  Me.DtcRelacionado.BoundText = "0000"
  
  
  Me.DtcTipoDoc.Enabled = False
  Me.TxtSerie.Enabled = False
  Me.TxtNumeroDoc.Enabled = False
  
  Referencia = True
  Me.TlbAcciones.Buttons(KEY_EXIT).Enabled = True
  Me.TlbGrabar.Buttons(KEY_SAVE).Enabled = False
  Me.TlbGrabar.Buttons(KEY_PRINT).Enabled = False
  Me.TlbGrabar.Buttons(KEY_REVERTIR).Enabled = False
  
End Sub



Private Sub LblTotalParcial_KeyPress(KeyAscii As Integer)
Dim PrecioCompra As Double
Dim TotalParcial As Double
If KeyAscii = 13 Then
   ' TotalParcial = Me.LblTotalParcial.Text
    PrecioCompra = TotalParcial / Val(Me.txtcantidad.Text)
    'Me.TxtPrecio.Text = Format(PrecioCompra, "#,##0.00")
    Me.cmdagregar.SetFocus

End If
End Sub







Private Sub producto_numero_ingreso(ByVal id_compra As Double)

End Sub

Public Sub llenar_series_producto(ByVal id_detalle, ByVal Grilla As MSHFlexGrid)
Dim porcentaje As Single

Iniciar:
strCadena = "SELECT I.id_detalle,I.serie_asignada,D.id_producto,D.id_alm FROM imp_producto_detalle I,movimiento_compra_detalle D WHERE I.id_alm='" & Me.DtcAlmacen.BoundText & "' and  I.id_detalle_compra=D.id_detalle_compra AND I.id_detalle_compra='" & id_detalle & "' "
Call ConfiguraRstT(strCadena)
If rstT.RecordCount < 1 Then
    Grilla.Rows = 0
    
    If MsgBox("ITEMS INGRESADOS NO CUENTAN CON CADENA DE PRODUCCION" + Chr(13) + "DESEA INGRESARLOS ", vbQuestion + vbYesNo, KEY_VENDEDOR) = vbYes Then
        strCadena = "SELECT * FROM movimiento_compra_detalle WHERE id_compra='" & Val(Me.TxtIdCompra.Text) & "'"
        Call ConfiguraRst(strCadena)
        If rst.RecordCount > 0 Then
            rst.MoveFirst
            For i = 0 To rst.RecordCount - 1
                strCadena = "INSERT INTO imp_producto_detalle(`id_compra`,`id_detalle_compra`,`id_producto`,`id_alm`,`ruc`)VALUES " & _
                "('" & Val(Me.TxtIdCompra.Text) & "','" & rst("id_detalle_compra") & "','" & rst("id_producto") & "','" & Me.DtcAlmacen.BoundText & "','" & KEY_RUC & "')"
                CnBd.Execute (strCadena)
                rst.MoveNext
            Next i
            GoTo Iniciar
        End If
        
    End If
  Else
 '   Exit Sub
    
End If
   Grilla.Clear
   Grilla.Refresh
   Grilla.Rows = 0
       ReDim arrColWidth(1 To rstT.Fields.Count)
       
        For Each Campo In rstT.Fields
           Grilla.ColWidth(0) = 400
           Grilla.ColWidth(1) = 0
           Grilla.ColWidth(2) = 2800
           Grilla.ColWidth(3) = 1000
           Grilla.ColWidth(4) = 800
           Grilla.ColWidth(5) = 700
           Grilla.ColWidth(6) = 350
        Next
        cabecera = "ID" & vbTab & "IDPRODUCTO" & vbTab & "DESCRIPCION" & vbTab & "MODELO" & vbTab & "COLOR" & vbTab & "UNIDAD"
        Grilla.AddItem cabecera
         For k = 0 To 6
            Grilla.col = k
            Grilla.Row = 0
            Grilla.CellBackColor = &HDFDFE0
         Next k
        rstT.MoveFirst
        strCadena = "SELECT * FROM view_producto WHERE ruc='" & KEY_RUC & "' AND id_alm='" & rstT("id_alm") & "' AND id_producto='" & rstT("id_producto") & "'"
        Call ConfiguraRstL(strCadena)
        
            c = 6
            NumeroCampo = 6
            
        For i = 0 To rstT.RecordCount - 1
          If rstT("serie_asignada") = "si" Then
              estado = Chr(254)
          Else
              estado = Chr(168)
          End If
          Fila = Format(i + 1, "00") & vbTab & rstT("id_detalle") & vbTab & rstL("nombre_prod") & vbTab & rstL("modelo") & vbTab & rstL("color") & vbTab & rstL("unidad") & vbTab & estado
          Grilla.AddItem Fila
        
        If c = NumeroCampo Then
                        With Grilla
                            .Row = i + 1 ' se posiciona en la fila
                            .col = c '  .. en la columna
                            .CellFontName = "Wingdings"
                            .CellFontSize = 14
                            .CellAlignment = flexAlignCenterCenter
                           
                            
                        End With
        End If
        Fila = ""
          If rstT("serie_asignada") = "si" Then
            For j = 0 To 6
                Grilla.col = j
                Grilla.Row = i + 1
                Grilla.CellBackColor = &HC0FFC0
            Next j
        End If
          rstT.MoveNext
      Next i
      
      Me.FrameCaracteristicas.Visible = True
End Sub

Private Sub Frame5_DragDrop(Source As Control, x As Single, y As Single)

End Sub

Private Sub HfdDetalle_SelChange()
Dim utilidad As Single
If Val(Me.TxtIdCompra.Text) > 0 Then
    If Val(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 0)) > 0 Then
        Me.cmdIngresoSerie.Enabled = True
    Else
        Me.cmdIngresoSerie.Enabled = False
    End If
End If


If Val(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 0)) < 1 Then
    Me.TxtCodProducto.Text = ""
    Me.txtcantidad.Text = 0
    Me.TxtDescripcionProducto.Text = ""
    Me.txtunidad.Text = ""
    Me.txtCosto.Text = 0
    Me.TxtUnitario.Text = 0
    Me.TxtDctoSoles.Text = 0
    Me.TxtDstoporcentaje.Text = 0
    Me.txtOtros.Text = 0
    Me.TxtValoerNeto.Text = 0
    Me.TxtTotalDescuento.Text = 0
    Me.txtisc.Text = 0
    Me.TxtISC_p.Text = 0
    Me.TxtIvap.Text = 0
    Me.txtvalorventa.Text = 0
    Me.TxtIgv.Text = 0
    Me.txtIgv_Porcentaje.Text = 0
    Me.TxtPrecioVenta.Text = 0
    Me.txtPrecioVentaAnt.Text = 0
    Me.TxtCostoAnt.Text = 0
    Me.TxtCostoHoy.Text = 0
    Me.TxtUtilidadAnt.Text = 0
    Me.txtUtilidadhoy.Text = 0
    Me.TxtventaHoy.Text = 0
    Me.TxtCostoHoy.Text = 0
    Me.chkigv.Value = 0
    Me.cmdagregar.Enabled = True
    'If rever = True Then
    Me.cmdagregar.Enabled = True
    Me.CmdQuitar.Enabled = True
    Me.cmdRevertir.Visible = False
    'End If
    If Me.TlbGrabar.Buttons(KEY_SAVE).Enabled = True Then
    Call Resalta(Me.TxtCodProducto)
    End If
    Exit Sub
End If

       Me.TxtCodProducto.Enabled = True
       Me.txtcantidad.Enabled = True
       Me.TxtDescripcionProducto.Enabled = True
       Me.cmdagregar.Enabled = False
       If Me.TlbGrabar.Buttons(KEY_SAVE).Enabled = True Then
            Me.cmdRevertir.Visible = True
       End If
       TxtCodProducto.Text = Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 1)
       strCadena = "SELECT * FROM producto WHERE id_producto='" & Trim(Me.TxtCodProducto.Text) & "' AND ruc='" & KEY_RUC & "'"
       Call ConfiguraRst(strCadena)
       
       TxtDescripcionProducto.Text = Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 2)
       txtCosto.Text = Format(rst("precio_compra"), "###0.00")
       txtunidad.Text = Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 3)
       
       
       TxtCostoAnt.Text = Format(rst("precio_compra"), "###0.00")
       txtPrecioVentaAnt.Text = Format(rst("precio_venta"), "###0.00")
       If rst("precio_compra") = 0 Then
        Me.TxtUtilidadAnt.Text = Format(0, "###0.00")
       Else
        Me.TxtUtilidadAnt.Text = Format(Val(rst("precio_venta") - rst("precio_compra")) * 100 / rst("precio_compra"), "###0.00")
       End If
       
       
       TxtventaHoy.Text = Format(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 11), "###0.00")
       Me.TxtCostoHoy.Text = Format(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 12), "###0.00")
       If Val(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 12)) = 0 Then
            utilidad = Format(Val(Val(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 11)) - 0), "#,##0.00")
       Else
            utilidad = Format(Val(Val(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 11)) - Val(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 12))) * 100 / Val(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 12)), "#,##0.00")
       End If
       Me.txtUtilidadhoy.Text = Format(utilidad, "###0.00")
       
       Me.txtcantidad.Text = Format(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 4), "###0.00")
       Me.TxtUnidades.Text = 1
       Me.TxtUnitario.Text = Format(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 5), "###0.00")
       Me.TxtDctoSoles.Text = Format(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 8), "###0.00")
       If Val(Me.TxtUnitario.Text) = 0 Then
            Me.TxtDstoporcentaje.Text = Format(0, "#,##0.000")
       Else
            Me.TxtDstoporcentaje.Text = Format(Val(Me.TxtDctoSoles.Text) * 100 / Val(Me.TxtUnitario.Text), "#,##0.000")
       End If
       
       'Val (Me.TxtDctoSoles.text) * 100 / Val(Me.TxtUnitario.text)
       Me.txtOtros.Text = Format(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 7), "###0.00")
       Me.TxtValoerNeto.Text = Format(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 6), "###0.00")
       Me.txtvalorventa.Text = Format(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 13), "###0.00")
       Me.txtisc.Text = Format(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 9), "###0.00")
       Me.TxtIgv.Text = Format(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 14), "###0.00")
       If Val(Me.TxtIgv.Text) > 0 Then
            Me.chkigv.Value = 1
            Me.txtIgv_Porcentaje.Text = KEY_IGV * 100
        Else
            Me.chkigv.Value = 0
            Me.txtIgv_Porcentaje.Text = 0
        End If
       
       Me.TxtIvap.Text = Format(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 10), "###0.00")
       Me.TxtPrecioVenta.Text = Format(Me.HfdDetalle.TextMatrix(Me.HfdDetalle.Row, 15), "###0.00")
      ' Call Resalta(Me.TxtCodProducto)
       'Set rst = Nothing
    

End Sub



Private Sub MfGasto_SelChange()
'If Val(Me.MfGasto.TextMatrix(Me.MfGasto.Row, 0)) > 0 Then
 '   Me.CmdQuitarGasto.Visible = True
'Else
 '  Me.CmdQuitarGasto.Visible = False
'End If
End Sub

 Private Sub ActualizarImagen(ByVal id_detalle As Double, ByVal Grilla As MSHFlexGrid)
     Dim estado As String
      strCadena = "SELECT * FROM imp_producto_detalle WHERE id_detalle='" & id_detalle & "'  AND ruc='" & KEY_RUC & "'"
      Call ConfiguraRst(strCadena)
      If rst.RecordCount > 0 Then
        If rst("serie_asignada") = "si" Then
            estado = "si"
           Me.HfItem.TextMatrix(Me.HfItem.Row, 6) = Chr(254)
         '   For j = 0 To 6
             '   Me.HfItem.col = j
            '    HfItem.Row = Me.HfItem.Row
                'HfItem.CellBackColor = &HFFFFFF
                'HfItem.CellBackColor = &HC0FFC0
         '   Next j
        Else
            estado = "si"
            Me.HfItem.TextMatrix(Me.HfItem.Row, 6) = Chr(254)
           ' For j = 0 To 6
           '     HfItem.col = j
            '    HfItem.Row = Me.HfItem.Row
                'HfItem.CellBackColor = &HC0FFC0
          '  Next j
        End If
        
      End If
      strCadena = "UPDATE imp_producto_detalle SET serie_asignada='" & estado & "' WHERE id_detalle='" & Val(Me.HfItem.TextMatrix(Me.HfItem.Row, 1)) & "' AND ruc='" & KEY_RUC & "'"
      CnBd.Execute (strCadena)
       


      
      
      
      
      Me.txtseriechasis.Text = ""
      Me.txtseriemotor.Text = ""
      Me.txtitemdua.Text = ""
      
     Me.txtnumeroserie.Text = rst("serie")
     Me.txtseriechasis.Text = rst("nro_chasis")
     Me.txtseriemotor.Text = rst("nro_motor")
     
     Me.txtChasisG.Text = rst("nro_chasis")
     Me.txtMotorG.Text = rst("nro_motor")
      
      Me.txtitemdua.Text = rst("item")
      Call Resalta(Me.txtnumeroserie)
      
    End Sub

Private Sub Text1_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
  '  if trim(me.txtc)
End If
End Sub

Private Sub HfItem_Click()
If Val(Me.HfItem.TextMatrix(Me.HfItem.Row, 1)) > 0 Then
    Call ActualizarImagen(Me.HfItem.TextMatrix(Me.HfItem.Row, 1), Me.HfItem)
End If
End Sub

Private Sub lblotros_Change()
Me.lblTotal.Text = Val(Me.lblTotal.Text)
End Sub

Private Sub TlbAcciones_ButtonClick(ByVal Button As MSComctlLib.Button)
Select Case Button.key
    Case KEY_NEW
        Call nuevo
    Case KEY_UPDATE
    Case KEY_ANULAR
         If MsgBox(MSGANULAR, vbQuestion + vbYesNo, MSGVERIFICACION) = vbYes Then
            Procedencia = anular
            FrmSeguridad.Show
        End If
    Case "(Buscar)"
         Procedencia = buscar
         FrmBusquedaCompras.Show
    Case KEY_DELETE
      If MsgBox(MSGELIMINAR, vbQuestion + vbYesNo, MSGVERIFICACION) = vbYes Then
        Procedencia = Eliminar
        FrmSeguridad.Show
     End If
    Case KEY_EXIT
      Procedencia = Neutro
      Unload Me
      Exit Sub
  End Select
End Sub
Public Sub nuevo()
Dim cCompra As Double
    strCadena = "DELETE FROM movimiento_compra_temporal WHERE dni_save='" & Trim(KEY_USUARIO) & "' AND ruc='" & KEY_RUC & "'"
    CnBd.Execute (strCadena)
     
   ' cCompra = IdInsert("DocumentoCompra")
    
    If Me.DtcTipoDoc.BoundText = "0089" Then
        strCadena = "SELECT * FROM  almacen_comprobante WHERE id_doc='" & Trim(Me.DtcTipoDoc.BoundText) & "' AND  serie='" & Trim(Me.TxtSerie.Text) & "' AND ruc='" & Trim(KEY_RUC) & "' AND id_alm='" & KEY_ALM & "'"
        Call ConfiguraRst(strCadena)
        If rst.RecordCount > 0 Then
        Me.TxtSerie.Text = rst("serie")
        Me.TxtNumeroDoc.Text = formato_item(rst("numero"), 8)
        End If
    Else
    
    Me.TxtSerie.Text = "000"
    Me.TxtNumeroDoc.Text = "00000000"
    
    End If
    Me.HfdDetalle.Rows = 0
    rever = False
    Me.cmdReload.Visible = False
    Me.TxtFecha_emision.Mask = ""
    Me.TxtFecha_emision.Text = ""
    Me.TxtFecha_emision.Mask = "##/##/####"
    Me.txtfecha_Vencimiento.Mask = ""
    Me.txtfecha_Vencimiento.Text = ""
    Me.txtfecha_Vencimiento.Mask = "##/##/####"
    

   
    Me.cmdRevertir.Visible = False
    Me.cmdactualizar.Visible = False
    Me.cmdRecalcular.Visible = False
    Me.TxtSerie.Enabled = True
    
    
    Me.txtnumero_dua.Text = ""
    Me.txtAñoFabricacion.Text = ""
    Me.TxtAnioDua.Text = ""
    Me.txtañomodelo.Text = ""
    
    
    Me.txtnumero_dua.Locked = False
    Me.txtAñoFabricacion.Locked = False
    Me.TxtAnioDua.Locked = False
    Me.txtañomodelo.Locked = False
    
    
    Me.TxtAnioDua.Locked = False
    Me.txtAñoFabricacion.Locked = False
    Me.txtañomodelo.Locked = False
    
    
    Me.TxtNumeroDoc.Enabled = True
    Me.DtTipoCompra.Locked = False
    Me.DtcMoneda.Locked = False
    Me.DtcTipoDoc.Enabled = True
    Me.cmdGastos.Visible = False
    Me.DtcTipoDoc.SetFocus
    Me.TxtRuc.Text = ""
    Me.TxtProveedor.Text = "CLIENTE"
    Me.txtdireccion.Text = KEY_DIR_PUBLIC
    Me.lblIMPBruto.Text = ""
    Me.txtobservacion.Text = ""
    Me.TxtDescripcionProducto.Text = ""
    Me.ChkPercepcion.Value = 0
    Me.txtisc.Text = 0#
    Me.lblISC.Text = 0#
    Me.lblImportacion.Text = 0#
    Me.lblgastos.Text = 0#
    Me.TxtISC_p.Text = 0#
    Me.lblExonerado.Text = 0#
    Me.txtRedondeo.Text = 0#
    Me.lblTotal.Text = 0#
    Me.TxtUtilidadAnt.Text = 0#
    Me.txtUtilidadhoy.Text = 0#
    Me.txtPrecioVentaAnt.Text = 0#
    Me.TxtventaHoy.Text = 0#
    Me.lblDescuento.Text = 0#
    Me.TxtCodProducto = "00000"
    Me.TxtValoerNeto.Text = 0
    Me.txtvalorventa.Text = 0
    Me.TxtPrecioVenta.Text = 0
    Me.chkigv.Value = 0
    Me.TxtDescripcionProducto.Text = ""
    Me.TxtDctoSoles.Text = 0#
    Me.TxtDstoporcentaje.Text = 0#
    Me.txtOtros.Text = 0#
    Me.TxtTotalDescuento.Text = 0#
    Me.txtCosto.Text = 0#
    Me.TxtCostoAnt.Text = 0#
    Me.TxtCostoHoy.Text = 0#
    Me.txtIgv_Porcentaje.Text = 0#
    Me.txtcantidad.Text = 0
    Me.TxtIgv.Text = 0
    Me.txtIgv_Porcentaje.Text = 0
    Me.TxtUnitario.Text = 0#
    Me.LblIgv.Text = 0#
    Me.TxtUnidades.Text = 1
    Me.LblPercepcion.Text = ""
    Me.lblTotal.Text = ""
    Me.LblValorVenta.Text = ""
    Me.LblCantidad.Caption = "0"
    Me.TxtSerieG.Text = ""
    Me.TxtNumeroG.Text = ""
    Me.TxtTransporte.Text = ""
    Me.txtchofer.Text = ""
    Me.TxtLicencia.Text = ""
    Me.txtInicial.Text = ""
    Me.txtfinal.Text = ""
    Me.Txtrecorrido.Text = ""
    Me.txtdias.Text = ""
    Me.HfPersonal.Rows = 1
    Me.HfPersonal.Clear
    Me.HfGastos.Rows = 1
    Me.HfGastos.Clear
    Me.TxtCodProducto.Enabled = True
    Me.TxtDescripcionProducto.Enabled = True
    Me.txtcantidad.Enabled = True
    Me.cmdagregar.Enabled = True
    Me.CmdQuitar.Enabled = True
    Me.lblAnulado.Visible = False
     
    Me.TlbGrabar.Buttons(KEY_SAVE).Enabled = False
    Me.TlbGrabar.Buttons(KEY_PRINT).Enabled = False
    Me.TlbGrabar.Buttons(KEY_REVERTIR).Enabled = False
    Me.HfdDetalle.Clear
    
    
    
    Set rst = Nothing
End Sub

Sub verifica(ByVal doc_deta As String)
    Select Case Val(doc_deta)
        Case 1
           ' Call Doc_Referencia(True, Val(doc_deta))
        Case 3
           ' Call Doc_Referencia(False, Val(doc_deta))
        Case 7
           ' Call Doc_Referencia(True, Val(doc_deta))
        Case 8
            'Call Doc_Referencia(True, Val(doc_deta))
        Case 9
            
            'Call Doc_Referencia(True, Val(doc_deta))
        Case 88
            'Call Doc_Referencia(False, Val(doc_deta))
        Case 89
            'Call Doc_Referencia(False, Val(doc_deta))
        Case 90
            'Call Doc_Referencia(False, Val(doc_deta))
        Case 95
            'Call Doc_Referencia(False, Val(doc_deta))
        Case 96
            'Call Doc_Referencia(True, Val(doc_deta))
    End Select
    
End Sub



Private Sub TlbAgregar_ButtonClick(ByVal Button As MSComctlLib.Button)
Select Case Button.key
    Case KEY_AGREGAR
        Call AgregarGrilla
    Case KEY_QUITAR
        'Call Quitar
    
  End Select
End Sub

Private Sub TlbGrabar_ButtonClick(ByVal Button As MSComctlLib.Button)
On Error GoTo Error
  Select Case Button.key
    Case KEY_SAVE
      Dim in_mes As Integer
      Dim in_anio As String
      in_mes = Month(CVDate(Me.TxtFecha_emision.Text))
      in_anio = Year(CVDate(Me.TxtFecha_emision.Text))
      If validar_periodo(in_mes, in_anio, Me.DtcPeriodo.BoundText) = False Then
         MsgBox "INCONSISTENCIA EN PERIODO Y FECHA DE EMISION", vbInformation, KEY_VENDEDOR
         Exit Sub
      End If
        
        
        
        
      Call Save
    Case KEY_PRINT
       MsgBox "Ingrese el Formato de Impresion", vbInformation, "Mensaje para el Usuario"
    Case KEY_REVERTIR
     Procedencia = revertir
     FrmSeguridad.Show
     rever = True
  End Select
  Exit Sub
Error:
  MsgBox Err.Number & " " & Err.Description, vbCritical, MSGERROR
  Set rst = Nothing
Exit Sub
End Sub
Private Function CodigoKardex() As String
strCadena = "SELECT int_Kardex FROM Kardex ORDER BY int_kardex DESC"
    Call ConfiguraRst(strCadena)
    CodigoKardex = GeneraCodigos()
    Set rst = Nothing
End Function
Private Sub Imprimir()
If Me.DtcTipoDoc.BoundText = KEY_INGALMA Then
Dim i As Integer, j As Integer
Dim laVenta, espacios
Dim MES As String
Dim Ans As Boolean
Dim cantidad As String, Und As String, descripcion As String, precio As String
Dim Total As String, SUBTOTAL As String, igv As String
Dim totalPar As String
Dim Descuento As String
Dim GranTotal As String
Dim totalletras As String
Dim Peso As Double
Dim inc As Single
Dim codigo As String, Unidad As String, PesoTotal As Double
Dim Toneladas As String
    Printer.CurrentX = 0
    Printer.CurrentY = 0
    Printer.Print ""
    Printer.Print ""
    Printer.Print ""
    Printer.Print ""
    Printer.Print ""
    Printer.CurrentY = Printer.CurrentY + 0.5
    
    Printer.Print Tab(20); "PROVEEDOR:" + Space(1) + Me.TxtProveedor.Text
    Printer.Print Tab(20); "DIRECCION:" + Space(1) + Me.txtdireccion.Text
    Printer.Print Tab(20); "RUC      :" + Space(1) + Me.TxtRuc.Text
   ' Printer.Print Tab(20); "FACTURA"; Space(2); Mid(Me.TxtSerie_Ref.Text + Space(50), 1, 4) & Space(2) & "-" & Space(2) & Me.TxtNumero_Ref.Text + Space(6) + "INGALMA"; Space(2); Mid(Me.TxtSerie.Text + Space(50), 1, 4) & Space(2) & "-" & Space(2) & Me.TxtNumeroDoc.Text
    Printer.Print ""
    Printer.CurrentY = Printer.CurrentY + 0.5
strCadena = "SELECT Detalle_DocumentoCompra.cProducto, Detalle_DocumentoCompra.cantidad, Unidad.sAbreviatura, Producto.DescripcionProducto, " & _
            "Detalle_DocumentoCompra.precio , Detalle_DocumentoCompra.TOTAL, DocumentoCompra.nTotalCompra FROM DocumentoCompra INNER JOIN " & _
            "Detalle_DocumentoCompra ON DocumentoCompra.cDocumentoCompra = Detalle_DocumentoCompra.cDocumentoCompra AND " & _
            "DocumentoCompra.Alm_cod = Detalle_DocumentoCompra.Alm_cod AND " & _
            "DocumentoCompra.doc_cod = Detalle_DocumentoCompra.doc_cod AND " & _
            "DocumentoCompra.sSerie = Detalle_DocumentoCompra.sSerie INNER JOIN " & _
            "Producto ON Detalle_DocumentoCompra.cProducto = Producto.cProducto INNER JOIN " & _
            "Unidad ON Producto.cUnidad = Unidad.cUnidad " & _
            "WHERE (Detalle_DocumentoCompra.doc_cod='" & Trim(Me.DtcTipoDoc.BoundText) & "' AND Detalle_DocumentoCompra.sSerie='" & Trim(Me.TxtSerie.Text) & "' " & _
            "AND Detalle_DocumentoCompra.cDocumentoCompra='" & Trim(Me.TxtNumeroDoc.Text) & "')"
    Call ConfiguraRst(strCadena)
    rst.MoveFirst
    Printer.CurrentY = Printer.CurrentY + 0.2
            For j = 0 To rst.RecordCount - 1
                codigo = Mid(rst(0) + Space(50), 1, 4)
                cantidad = Mid(str(rst(1)) + Space(10), 1, 4)
                Und = rst(2)
                descripcion = Mid(rst(3) + Space(80), 1, 48)
                precio = Mid(Format(str(rst(4)), "###0.00") + Space(4), 1, 8)
                totalPar = Mid(Format(str(rst(5)), "###0.00") + Space(4), 1, 8)
                'Printer.Print Tab(2); Codigo & Space(7) & Cantidad & Space(1) & Und & Space(6) & descripcion & precio & Space(4) & totalPar
                Printer.Print Tab(5); codigo & Space(2) & cantidad & Space(1) & Und & Space(2) & descripcion & precio & Space(4) & totalPar
                Printer.CurrentY = Printer.CurrentY + 0.2
                rst.MoveNext
            Next j
            inc = 0.5
            Do While (Val(Printer.CurrentY) <= 19)
                Printer.CurrentY = Printer.CurrentY + inc
            Loop
    rst.MoveFirst
    Total = Format(str(rst(6)), "###0.00")
    Descuento = Format(str(KEY_DSCTO), "###0.00")
    totalletras = UCase(EnLetras(Total))
    Set rst = Nothing
    '---- fin totales
    Printer.CurrentY = Printer.CurrentY + 0.8
    Printer.Print Tab(10); Mid(totalletras + Space(100), 1, 100)
    Printer.Print Tab(55); Mid(Total & Space(20), 1, 13) & Descuento & Space(15) & Total
    Printer.EndDoc
    
    Exit Sub
End If
End Sub

Public Sub Prender()

Me.TlbAcciones.Enabled = True
Me.DtcAlmacen.Enabled = True
Me.DtcTipoDoc.Enabled = True
Me.TxtSerie.Enabled = True
Me.TxtNumeroDoc.Enabled = True
Call llenarGrid_det(Me.HfdDetalle, "", "", "")
Me.DtcTipoDoc.SetFocus
End Sub

Private Sub Resalta(ByVal texto As TextBox)
texto.SelStart = 0
texto.SelLength = Len(Trim(texto))
texto.Text = texto.SelText
texto.SetFocus
End Sub

Private Sub txtañocontenedor_Change()

End Sub

Private Sub txtañocontenedor_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Call Resalta(Me.txtañomodelo)
End If
End Sub

Private Sub TxtAnioDua_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Call Resalta(txtañomodelo)
End If
End Sub

Private Sub txtañofabricacion_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Call Resalta(Me.txtnumero_dua)
End If
End Sub

Private Sub txtcantidad_KeyPress(KeyAscii As Integer)
Dim TotalP As Single
If KeyAscii = 13 And Val(Me.txtcantidad.Text) > 0 Then
   
    Call Resalta(Me.TxtUnidades)

End If
End Sub





Private Sub TxtCostoHoy_Change()
Dim costo As Single
If rever = False Then
    costo = Val(Me.TxtCostoHoy.Text)
    Me.TxtventaHoy.Text = Format(costo + costo * Val(Me.txtUtilidadhoy.Text) / 100, "###0.00")
Else
    If Val(Me.TxtCostoHoy.Text) > 0 Then
    utilidad = Val(Me.txtUtilidadhoy.Text)  '(Val(Me.TxtventaHoy.Text) - Val(Me.TxtCostoHoy.Text)) * 100 / Val(Me.TxtCostoHoy.Text)
    Me.txtUtilidadhoy.Text = Format(utilidad, "###0.00")
    Me.TxtventaHoy.Text = Format(Val(Me.TxtCostoHoy.Text) + Val(Me.TxtCostoHoy.Text) * Val(Me.txtUtilidadhoy.Text) / 100, "###0.00")
    End If
End If

End Sub

Private Sub TxtCostoHoy_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Me.TxtCostoHoy.Text = Format(Me.TxtCostoHoy.Text, "###0.00")
    Call Resalta(Me.txtUtilidadhoy)
End If
End Sub









Private Sub TxtDctoSoles_KeyPress(KeyAscii As Integer)
Dim totalneto As Single
totalneto = Me.TxtPrecioVenta.Text
If KeyAscii = 13 Then
   
    If Val(Me.TxtDctoSoles.Text) > 0 Then
        FrmDescuentos.lblUnitario.Caption = Format(Val(Me.TxtDctoSoles.Text), "###0.00")
        FrmDescuentos.lblTotal.Caption = Format(Val(Me.TxtDctoSoles.Text) * Val(Me.txtcantidad.Text), "###0.00")
        FrmDescuentos.Show
        Exit Sub
    Else
    Me.TxtDctoSoles.Text = Format(Val(Me.TxtDctoSoles.Text), "###0.00")
    Me.TxtDstoporcentaje.Text = Format(Val(Me.TxtDctoSoles.Text), "###0.00")
    Call Resalta(Me.TxtDstoporcentaje)
    End If
End If
End Sub

Public Sub llenar_descuento()
totalneto = Val(Me.TxtValoerNeto.Text)
If FrmDescuentos.Procedencia = unitario Then
    Me.TxtDctoSoles.Text = Format(Val(FrmDescuentos.lblUnitario.Caption), "###0.00")
   Me.TxtTotalDescuento.Text = Format(Val(FrmDescuentos.lblUnitario.Caption) * Val(Me.txtcantidad.Text), "###0.00")
Else
    
   Me.TxtTotalDescuento.Text = Format(Val(Me.TxtDctoSoles.Text) * Val(Me.txtcantidad.Text), "###0.00")
End If
        

If Me.chkigv.Value = 1 Then
            
            If Val(Me.TxtUnitario.Text) > 0 Then
                Me.TxtDstoporcentaje.Text = Format(Val(Me.TxtDctoSoles.Text) * 100 / Val(Me.TxtUnitario.Text), "##0.00")
                
            Else
                Me.TxtDstoporcentaje.Text = Format(Val(Me.TxtDctoSoles.Text) * 100, "##0.00")
            End If
            Me.TxtCostoHoy.Text = Format(Val(Me.TxtCostoHoy.Text) * (1 + KEY_IGV) - Val(Me.TxtTotalDescuento.Text) / Val(Me.txtcantidad.Text), "##0.00")
            Me.TxtPrecioVenta.Text = Format(totalneto * (1 + KEY_IGV) - Val(Me.TxtTotalDescuento.Text), "###0.00")
            Me.txtvalorventa.Text = Format(Val(Me.TxtValoerNeto.Text) - Val(Me.TxtTotalDescuento.Text), "##0.00")
    Else
        
      
        If Val(Me.TxtUnitario.Text) > 0 Then
            If Val(TxtDstoporcentaje) = 0 Then
                Me.TxtDstoporcentaje.Text = Format(Val(Me.TxtDctoSoles.Text) * 100 / Val(Me.TxtUnitario.Text), "##0.00")
            End If
        Else
            Me.TxtDstoporcentaje.Text = Format(Val(Me.TxtDctoSoles.Text) * 100, "###0.00")
        End If
        
        Me.TxtCostoHoy.Text = Format(Val(Me.TxtCostoHoy.Text) - Val(Me.TxtTotalDescuento.Text) / Val(Me.txtcantidad.Text), "##0.00")
        Me.txtvalorventa.Text = Format(Val(Me.TxtValoerNeto.Text) - Val(Me.TxtTotalDescuento.Text), "###0.00")
        Me.TxtPrecioVenta.Text = Format(totalneto - Val(Me.TxtTotalDescuento.Text), "###0.00")
    End If
    
    Me.TxtDstoporcentaje.Text = Format(Val(Me.TxtDstoporcentaje.Text), "#,##0.00")
    Call Resalta(Me.txtOtros)
End Sub


Private Sub TXtDetalleG_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    'Me.CmdAgregarG.SetFocus
End If
End Sub

Private Sub TxtDstoporcentaje_KeyPress(KeyAscii As Integer)
Dim totalneto As Single
totalneto = Me.TxtValoerNeto.Text
If KeyAscii = 13 Then
If Me.chkigv.Value = 1 Then
          Me.TxtDctoSoles.Text = Format(Val(Me.TxtUnitario.Text) * Val(Me.TxtDstoporcentaje.Text) / 100, "###0.00")
          Me.TxtDstoporcentaje.Text = Format(Me.TxtDstoporcentaje.Text, "#,#0.0000")
                If FrmDescuentos.Procedencia = unitario Then
                    Me.TxtTotalDescuento.Text = Format(Val(Me.TxtDctoSoles.Text), "#,##0.000")
                Else
                    Me.TxtTotalDescuento.Text = Format(Val(Me.TxtDctoSoles.Text) * Val(Me.txtcantidad.Text), "###0.00")
                End If
            Me.TxtPrecioVenta.Text = Format(totalneto * (1 + KEY_IGV) - Val(Me.TxtTotalDescuento.Text), "###0.000")
            Me.TxtCostoHoy.Text = Format(Val(Me.TxtUnitario.Text) * (1 + KEY_IGV) - Val(Me.TxtDctoSoles.Text) + Val(Me.txtOtros.Text) / (Val(Me.txtcantidad.Text) * Val(Me.TxtUnidades.Text)), "###0.00")
    Else
         FrmDescuentos.lblUnitario.Caption = Format(Val(Me.TxtUnitario.Text) * Val(Me.TxtDstoporcentaje.Text) / 100, "###0.000")
         FrmDescuentos.lblTotal.Caption = Format((Val(Me.TxtUnitario.Text) * Val(Me.TxtDstoporcentaje.Text) / 100) * Val(Me.txtcantidad.Text), "###0.000")
         FrmDescuentos.Show
         Exit Sub
        Me.TxtDctoSoles.Text = Format(Val(Me.TxtUnitario.Text) * Val(Me.TxtDstoporcentaje.Text) / 100, "###0.00")
        Me.TxtDstoporcentaje.Text = Format(Me.TxtDstoporcentaje.Text, "###0.00")
                If FrmDescuentos.Procedencia = unitario Then
                    Me.TxtTotalDescuento.Text = Format(Val(Me.TxtDctoSoles.Text), "###0.00")
                    Me.TxtCostoHoy.Text = Format(Val(Me.TxtUnitario.Text) - Val(Me.TxtDctoSoles.Text) / Val(Me.txtcantidad.Text), "###0.00")
                    Me.txtvalorventa.Text = Format(Val(Me.TxtValoerNeto.Text) - Val(Me.TxtTotalDescuento.Text), "###0.00")
                Else
                    Me.TxtTotalDescuento.Text = Format(Val(Me.TxtDctoSoles.Text) * Val(Me.txtcantidad.Text), "###0.00")
                    Me.TxtCostoHoy.Text = Format(Val(Me.TxtUnitario.Text) - Val(Me.TxtDctoSoles.Text) + Val(Me.txtOtros.Text) / (Val(Me.txtcantidad.Text) * Val(Me.TxtUnidades.Text)), "###0.00")
                End If
                Me.TxtPrecioVenta.Text = Format(totalneto - Val(Me.TxtTotalDescuento.Text), "###0.00")
                
       
    End If
    FrmDescuentos.Procedencia = vacio
    Call Resalta(Me.txtOtros)
    If KEY_CON_IGV = "si" Then
        Me.chkigv.Value = 1
    End If
End If
End Sub

Private Sub TxtFecha_emision_KeyPress(KeyAscii As Integer)
On Error GoTo salir
If KeyAscii = 13 Then
     If IsDate(Trim(Me.TxtFecha_emision.Text)) = False Then
        Me.TxtFecha_emision.Text = CVDate(KEY_FECHA)
     End If
        
    Me.TxtTc.Text = cambio(CVDate(Me.TxtFecha_emision.Text))
    Me.txtfecha_Vencimiento.SetFocus
End If
Exit Sub
salir:
    MsgBox "Ingrese Una Fecha Correcta", vbInformation, KEY_USUARIO
    Exit Sub
End Sub

Private Sub txtfecha_Vencimiento_KeyPress(KeyAscii As Integer)
On Error GoTo salir
If KeyAscii = 13 Then
    If IsDate(Trim(Me.txtfecha_Vencimiento.Text)) = False Then
        Me.txtfecha_Vencimiento.Text = CVDate(Me.TxtFecha_emision.Text)
        If Me.DtcPeriodo.Enabled = True Then
            Me.DtcPeriodo.SetFocus
        End If
        Exit Sub
    Else
        If Me.DtcPeriodo.Enabled = True Then
            Me.DtcPeriodo.SetFocus
        End If
    End If
End If
Exit Sub
salir:
MsgBox "Ingrese Una Fecha Correcta", vbInformation, KEY_USUARIO
    Exit Sub
End Sub

Private Sub TxtIGV_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
Dim igv_t As Single
    Me.TxtIgv.Text = Val(Me.TxtIgv.Text)

    Call Resalta(Me.txtIgv_Porcentaje)
End If
End Sub

Private Sub TxtISC_KeyPress(KeyAscii As Integer)
On Error GoTo salir
Dim isc_v As Single
Dim tprecioventa As Single
Dim igv_v As Single
If KeyAscii = 13 Then
    
    
    isc_v = Val(Me.txtisc.Text)
    If isc_v > 0 Then
     tprecioventa = Val(Me.TxtValoerNeto.Text) - Val(Me.TxtTotalDescuento.Text)
    igv_v = Me.TxtIgv.Text
    Me.txtisc.Text = Format(isc_v, "###0.00")
    
    
    If (Me.chkigv.Value = 1) Then
        Me.TxtIgv.Text = Format(igv_v + KEY_IGV * isc_v, "###0.00")
        Me.TxtPrecioVenta.Text = Format(tprecioventa + isc_v + KEY_IGV * isc_v + igv_v, "###0.00")
        Me.TxtISC_p.Text = Format(isc_v * 100 / Val(Me.TxtPrecioVenta.Text), "###0.00")
    Else
        
        Me.TxtPrecioVenta.Text = Format(tprecioventa + isc_v, "###0.00")
        If (Val(tprecioventa) > 0) Then
            Me.TxtISC_p.Text = Format(isc_v * 100 / Val(tprecioventa), "###0.00")
        Else
            Me.TxtISC_p.Text = Format(isc_v * 100, "###0.00")
        End If
    End If
    End If
    
    Call Resalta(Me.TxtISC_p)
End If
Exit Sub
salir: MsgBox "Debe Ingresar un Valor Positivo"
End Sub

Private Sub TxtISC_p_KeyPress(KeyAscii As Integer)
Dim valorneto As Single
Dim isc_v As Single
Dim isc_p As Single
If KeyAscii = 13 Then
    
    valorneto = Val(Me.TxtValoerNeto.Text) - Val(Me.TxtTotalDescuento.Text)
    isc_p = Val(Me.TxtISC_p.Text)
    If isc_p > 0 Then
    isc_v = Format(valorneto * isc_p / 100, "###0.00")
    Me.txtisc.Text = isc_v
    igv_v = Me.TxtIgv.Text
        
    If (Me.chkigv.Value = 1) Then
        Me.TxtIgv.Text = Format(igv_v + KEY_IGV * isc_v, "#,#00.000")
        Me.TxtPrecioVenta.Text = Format(valorneto + isc_v + KEY_IGV * isc_v + igv_v, "###0.00")
    Else
        
        Me.TxtPrecioVenta.Text = Format(valorneto + isc_v, "###0.00")
    End If
    End If
    Call Resalta(Me.TxtIvap)
    
    
End If
End Sub

Private Sub txtitemdua_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Me.txtitemdua.Text = Format(Trim(Me.txtitemdua.Text), "0000")
    Me.cmdprocesar.SetFocus
End If
End Sub

Private Sub TxtIvap_KeyPress(KeyAscii As Integer)
Dim totalneto As Single
totalneto = Me.TxtPrecioVenta.Text
If KeyAscii = 13 Then
    Me.TxtIvap.Text = Format(Val(Me.TxtIvap.Text), "###0.00")
    Me.TxtPrecioVenta.Text = Format(totalneto + Val(Me.TxtIvap.Text), "###0.00")
    Call Resalta(Me.TxtPrecioVenta)
End If
End Sub
Public Sub Ordencompra()
Dim fecha_inicial As Date
Dim fecha_final As Date
Dim Orden As Double
 Me.TxtNumeroG.Text = formato_item(Me.TxtNumeroG.Text, 10)
    strCadena = "SELECT * FROM OrdenCompra WHERE serie='" & Trim(Me.TxtSerieG.Text) & "' AND numero='" & Trim(Me.TxtNumeroG.Text) & "'"
    Call ConfiguraRst(strCadena)
    If rst.RecordCount > 0 Then
        strCadena = "SELECT * FROM MiTransporte WHERE id_transporte='" & Val(rst("id_transporte")) & "' AND Ruc='" & KEY_RUC & "'"
        Call ConfiguraRstT(strCadena)
        If rstT.RecordCount > 0 Then
            Me.TxtTransporte.Text = rstT("marca") + Space(1) + "PLACA:" + rstT("placa")
            If IsNull(rst("id_Cisterna")) = False Then
                strCadena = "SELECT * FROM MiTransporte WHERE id_transporte='" & Val(rst("id_Cisterna")) & "' AND Ruc='" & KEY_RUC & "'"
                Call ConfiguraRstT(strCadena)
                If rstT.RecordCount > 0 Then
                    Me.TxtTransporte.Text = Me.TxtTransporte.Text + "/" + rstT("placa")
                End If
            End If
            
            strCadena = "SELECT * FROM Persona WHERE cPersona='" & rst("cConductor") & "'"
            Call ConfiguraRstT(strCadena)
            If rst.RecordCount > 0 Then
                Me.txtchofer.Text = rstT("NombrePersona")
                Me.TxtLicencia.Text = rstT("licencia")
            End If
            strCadena = "SELECT * FROM Ocurrencias WHERE idOrden='" & rst("idOrden") & "' AND idsalidaingreso='1'"
            Call ConfiguraRstT(strCadena)
            If rstT.RecordCount > 0 Then
                    Me.txtInicial.Text = Format(rstT("kilometraje"), "###0.00")
                    fecha_inicial = CVDate(rstT("fecha"))
            End If
            strCadena = "SELECT * FROM Ocurrencias WHERE idOrden='" & rst("idOrden") & "' AND idsalidaingreso='2'"
            Call ConfiguraRstT(strCadena)
            If rstT.RecordCount > 0 Then
                    Me.txtfinal.Text = Format(rstT("kilometraje"), "###0.00")
                    fecha_final = CVDate(rstT("fecha"))
                    Me.txtdias.Text = DateDiff("d", fecha_inicial, fecha_final)
                    Me.Txtrecorrido.Text = Format(Val(Me.txtfinal.Text) - Val(Me.txtInicial.Text), "###0.00")
                     If rever = True Then
                    descuentoRecorrido = Val(Me.Txtrecorrido.Text) / Val(Me.txtcantidad.Text)
                    Me.TxtCostoHoy.Text = Format(Val(Me.TxtCostoAnt.Text) + descuentoRecorrido, "###0.00")
                    End If
            End If
          
        End If
        Orden = rst("idorden")
        Call llenarGridUsuarios(Me.HfPersonal, Orden)
        Call llenarGridGastos(Me.HfGastos, Orden)
    Else
        MsgBox "Orden de Compra no registrada", vbInformation, Mid(KEY_EMPRESA, 1, 35)
        Exit Sub
    End If
End Sub






Private Sub txtnumero_dua_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Call Resalta(Me.TxtAnioDua)
End If
End Sub

Private Sub TxtNumeroG_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
   Call Ordencompra
End If
End Sub
Private Sub llenarGridUsuarios(ByVal Grilla As MSHFlexGrid, ByVal idOrden As Double)
Dim sueldodia As Single
On Error GoTo salir
strCadena = "SELECT Persona.cPersona, Persona.NombrePersona, Persona.sueldo_mensual FROM  OcurrenciasPersonal INNER JOIN " & _
"Persona ON OcurrenciasPersonal.cPersona = Persona.cPersona INNER JOIN " & _
"Ocurrencias ON OcurrenciasPersonal.idOcurrencia = Ocurrencias.idOcurrencia WHERE idOrden='" & idOrden & "' AND idSalidaingreso='1'"
Call ConfiguraRst(strCadena)
If rst.RecordCount < 1 Then
    Grilla.Rows = 1
    Grilla.Clear
    Exit Sub
End If
  N = 1
   Grilla.Clear
   Grilla.Refresh
   Grilla.Rows = 0
      ' Me.HfdGrilla.Rows = rst.RecordCount - 2
       ReDim arrColWidth(1 To rst.Fields.Count)
       For Each Campo In rst.Fields
            ' -- almacena el ancho de los campos
           Grilla.ColWidth(0) = 500
           Grilla.ColWidth(1) = 2500
           Grilla.ColWidth(2) = 800
           Grilla.ColWidth(3) = 500
           Grilla.ColWidth(4) = 800
       Next
         cabecera = "COD" & vbTab & "DESCRIPCION" & vbTab & "SUELDO" & vbTab & "DIAS" & vbTab & "TOTAL"
         Grilla.AddItem cabecera
         For k = 0 To 4
                                Grilla.col = k
                                Grilla.Row = 0
                                Grilla.CellBackColor = &HDFDFE0
                            Next k
        sueldodia = 0
        rst.MoveFirst
        For i = 1 To rst.RecordCount
             Fila = Fila & rst("cPersona") & vbTab & rst("NombrePersona") & vbTab & rst("sueldo_mensual") & vbTab & Val(Me.txtdias.Text) & vbTab & Format(rst("sueldo_mensual") / 30 * Val(Me.txtdias.Text), "###0.00")
            If (Fila = "") Then
                x = 1
            End If
            sueldodia = sueldodia + rst("sueldo_mensual") / 30 * Val(Me.txtdias.Text)
           Grilla.AddItem Fila

        Fila = ""
        rst.MoveNext
        Next i
         Fila = "" & vbTab & "TOTAL PAGO PERSONAL" & vbTab & "" & vbTab & "" & vbTab & "" & Format(sueldodia, "###0.00")
         Grilla.AddItem Fila
         For k = 0 To 4
                                Grilla.col = k
                                Grilla.Row = i
                                Grilla.CellBackColor = &HC0FFFF
        Next k
        If rever = True Then
        descuentoPersonal = sueldodia / Val(Me.txtcantidad.Text)
        Me.TxtCostoHoy.Text = Format(Val(Me.TxtCostoAnt.Text) + descuentoRecorrido + descuentoPersonal, "###0.00")
        End If
Exit Sub
salir: MsgBox "Por Favor Digite Correctamente", vbInformation, "Mensaje para el usuario"
End Sub
Private Sub llenarGridGastos(ByVal Grilla As MSHFlexGrid, ByVal idOrden As Double)
Dim totalGasto As Single
On Error GoTo salir
strCadena = "SELECT     (Comprobantes.doc_abrev +':'+ SolicitudViaticosComprobantes.serie +'-'+ SolicitudViaticosComprobantes.numero) AS comprobante, " & _
" SolicitudViaticosComprobantes.total FROM SolicitudViaticos INNER JOIN SolicitudViaticosComprobantes ON SolicitudViaticos.id_Solicitud = SolicitudViaticosComprobantes.idSolicitud INNER JOIN " & _
" Comprobantes ON SolicitudViaticosComprobantes.doc_cod = Comprobantes.doc_cod WHERE idOrden='" & idOrden & "' AND  Ruc='" & KEY_RUC & "'"
Call ConfiguraRst(strCadena)
If rst.RecordCount < 1 Then
    Grilla.Rows = 1
    Grilla.Clear
    Exit Sub
End If
  N = 1
   Grilla.Clear
   Grilla.Refresh
   Grilla.Rows = 0
      ' Me.HfdGrilla.Rows = rst.RecordCount - 2
       ReDim arrColWidth(1 To rst.Fields.Count)
       For Each Campo In rst.Fields
            ' -- almacena el ancho de los campos
           Grilla.ColWidth(0) = 500
           Grilla.ColWidth(1) = 2500
           Grilla.ColWidth(2) = 800
         
          
       Next
         cabecera = "COD" & vbTab & "COMPROBANTE" & vbTab & "MONTO"
         Grilla.AddItem cabecera
         For k = 0 To 2
                                Grilla.col = k
                                Grilla.Row = 0
                                Grilla.CellBackColor = &HDFDFE0
                            Next k
        totalGasto = 0
        rst.MoveFirst
        For i = 1 To rst.RecordCount
             Fila = Fila & i & vbTab & rst("comprobante") & vbTab & Format(rst("total"), "###0.00")
            If (Fila = "") Then
                x = 1
            End If
            totalGasto = totalGasto + rst("total")
           Grilla.AddItem Fila

        Fila = ""
        rst.MoveNext
        Next i
         Fila = "" & vbTab & "" & vbTab & "" & Format(totalGasto, "###0.00")
         Grilla.AddItem Fila
         For k = 0 To 2
                                Grilla.col = k
                                Grilla.Row = i
                                Grilla.CellBackColor = &HC0FFFF
        Next k
        If rever = True Then
        descuentoViaticos = totalGasto / Val(Me.txtcantidad.Text)
        Me.TxtCostoHoy.Text = Format(Val(Me.TxtCostoAnt.Text) + descuentoRecorrido + descuentoPersonal + descuentoViaticos, "###0.00")
        End If
Exit Sub
salir: MsgBox "Por Favor Digite Correctamente", vbInformation, "Mensaje para el usuario"
End Sub

Private Sub TxtNumeroR_KeyPress(KeyAscii As Integer)
Dim cPersona As String
If KeyAscii = 13 Then
    Me.TxtNumeroR.Text = formato_item(Me.TxtNumeroR.Text, 8)
    strCadena = "SELECT * FROM movimiento_compra WHERE id_doc='" & Trim(Me.DtcRelacionado.BoundText) & "' AND serie='" & Trim(Me.TxtSerieR.Text) & "' AND  numero='" & Trim(Me.TxtNumeroR.Text) & "' AND ruc='" & KEY_RUC & "'"
    Call ConfiguraRst(strCadena)
    If rst.RecordCount > 0 Then
        Me.TxtRuc.Text = rst("id_proveedor")
        Me.TxtFechaEmision.Text = str(rst("fecha_emision"))
        strCadena = "SELECT id_proveedor as Codigo,nproveedor as Descripcion FROM movimiento_compra WHERE id_compra='" & rst("id_compra") & "' AND ruc='" & KEY_RUC & "'"
        Call ConfiguraRst(strCadena)
        Call LlenaDataCombo(Me.DtcProveedor)
        strCadena = "SELECT * FROM persona WHERE dni='" & Trim(Me.TxtRuc.Text) & "'"
        Call ConfiguraRstT(strCadena)
        If rstT.RecordCount > 0 Then
            Me.TxtProveedor.Text = UCase(rstT("nombre_completo"))
            Me.txtdireccion.Text = UCase(rstT("direccion"))
        End If
    Else
        Me.DtcProveedor.Text = "COMPROBANTE NO REGISTRADO"
    End If
    Set rst = Nothing
    Me.TxtCodProducto.SetFocus
End If
End Sub

Private Sub txtnumeroserie_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    
    Me.txtseriechasis.Text = Trim(Me.txtnumeroserie.Text)
    Call Resalta(Me.txtseriemotor)
    
    Exit Sub
    
End If
End Sub

Private Sub txtOtros_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
 Me.txtOtros.Text = Format(Val(Me.txtOtros.Text), "###0.00")
 If Me.chkigv.Value = 0 Then
    Me.TxtPrecioVenta.Text = Format(Val(Me.TxtPrecioVenta.Text) + Val(Me.txtOtros.Text), "###0.00")
Else
    Me.TxtPrecioVenta.Text = Format(Val(Me.TxtPrecioVenta.Text) + (Val(Me.txtOtros.Text)) * (KEY_IGV + 1), "###0.00")
 End If
    Call Resalta(Me.TxtValoerNeto)
   
End If
End Sub

Private Sub TxtPecepcion_Change()
Dim valortotal As Single
Dim total_percepcion As Single
Dim percepcion As Single
valortotal = Val(Me.lblTotal.Text)
percepcion = Val(Me.TxtPecepcion.Text)
Me.LblPercepcion.Text = Format(valortotal + percepcion, "###0.00")

If Me.chkigv.Value = 1 And Val(Me.txtcantidad.Text) > 0 Then
    costo = (Val(Me.TxtUnitario.Text) - Val(Me.TxtTotalDescuento.Text) / Val(Me.txtcantidad.Text)) * (1 + KEY_IGV) + Val(percepcion) / Val(Me.txtcantidad.Text)
Else
   If Val(Me.txtcantidad.Text) > 0 Then
     costo = (Val(Me.TxtUnitario.Text) - Val(Me.TxtTotalDescuento.Text) / Val(Me.txtcantidad.Text)) + Val(percepcion) / Val(Me.txtcantidad.Text)
   End If
End If

Me.TxtCostoHoy.Text = Format(costo, "###0.00")

End Sub

Private Sub TxtPecepcion_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    
End If
End Sub

Private Sub txtPorcentajeGastos_Change()
Dim costo As Single
Dim venta As Single
Dim utilidad As Single
Dim venta_actual As Single
Me.TxtGastoAdminHoy.Text = Format(Val(Me.TxtCostoHoy.Text) * Val(Me.txtPorcentajeGastos.Text) / 100, "###0.00")

costo = Val(Me.TxtCostoHoy.Text)
utilidad = Val(Me.txtUtilidadhoy.Text)
venta = Val(Me.TxtGastoAdminHoy.Text) + costo + costo * utilidad / 100

If rever = False Then
    Me.TxtventaHoy.Text = Format(venta, "###0.00")
Else
    If Val(Me.TxtCostoHoy.Text) > 0 Then
    Me.TxtventaHoy.Text = Format(Val(Me.TxtCostoHoy.Text) + Val(Me.TxtCostoHoy.Text) * Val(Me.txtUtilidadhoy.Text) / 100, "#,##0.00")
    'Me.txtUtilidadhoy.text = Format(utilidad, "###0.00")
    End If
End If

End Sub

Private Sub txtPorcentajeGastos_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Call Resalta(Me.txtUtilidadhoy)
End If
End Sub

Private Sub TxtPrecioVenta_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    If KEY_CON_IGV = "si" Then
        Me.chkigv.Value = 1
    Else
        Me.chkigv.Value = 0
    End If
    If Val(Me.TxtUnidades.Text) > 1 Then
        Me.chkModo.Value = 1
    End If
    
    If Val(Me.TxtPrecioVenta.Text) = 0 Then
        Me.TxtCostoHoy.Text = Format(Val(Me.TxtCostoAnt.Text), "#,##0.00")
        Me.TxtventaHoy.Text = Format(Val(Me.txtPrecioVentaAnt.Text), "#,##0.00")
    End If
    'Call Resalta(Me.txtUtilidadhoy)
    Call Resalta(Me.txtPorcentajeGastos)
    
    
    
End If




End Sub

Private Sub TxtProveedor_KeyDown(KeyCode As Integer, Shift As Integer)
If KeyCode = vbKeyLeft Then
        Call Resalta(Me.TxtRuc)
End If

End Sub

Private Sub TxtProveedor_KeyPress(KeyAscii As Integer)
Call Mayusculas(KeyAscii)
If KeyAscii = 13 Then
        Call Resalta(Me.txtdireccion)
                
End If
End Sub

Private Sub TxtCodProveedor_KeyDown(KeyCode As Integer, Shift As Integer)
If KeyCode = vbKeyLeft Then
        Call Resalta(Me.TxtNumeroDoc)
End If
If KeyCode = vbKeyRight Then
    Call Resalta(Me.TxtProveedor)
End If
End Sub
Private Sub buscarcliente()
If (Trim(Me.TxtRuc.Text) = "") Then
    Procedencia = Selecionar
    FrmPersona.Show
    Exit Sub
End If


    strCadena = "SELECT *  FROM persona WHERE dni='" & Trim(Me.TxtRuc.Text) & "'"
    Call ConfiguraRst(strCadena)
    If rst.RecordCount < 1 Then
        Procedencia = 1
        FrmDetallePersona.Show
        FrmDetallePersona.TxtRuc.Text = Trim(Me.TxtRuc.Text)
        FrmDetallePersona.chkProveedor.Value = 1
        Call FrmDetallePersona.precionar
        Exit Sub
    Else
        Me.TxtRuc.Text = rst("dni")
        Me.TxtProveedor.Text = rst("nombre_completo")
        Me.txtdireccion.Text = rst("direccion")
        Me.DtTipoCompra.SetFocus
        strCadena = "SELECT * FROM movimiento_compra WHERE id_doc='" & Me.DtcTipoDoc.BoundText & "' AND serie='" & Me.TxtSerie.Text & "' AND numero='" & Me.TxtNumeroDoc.Text & "' AND id_proveedor='" & Trim(Me.TxtRuc.Text) & "' ANd ruc='" & KEY_RUC & "'"
        Call ConfiguraRst(strCadena)
        If rst.RecordCount > 0 Then
            MsgBox "Documento ya Registrado. ", vbInformation, KEY_EMPRESA
            Call buscar_comprobante(rst("id_compra"))
            Exit Sub
        End If
        Exit Sub
       
    End If

End Sub

Private Sub TxtCodProveedor_KeyPress(KeyAscii As Integer)


End Sub

Private Sub TxtCodProducto_KeyDown(KeyCode As Integer, Shift As Integer)
If KeyCode = vbKeyLeft Then
        Call Resalta(Me.txtcantidad)
End If
If KeyCode = vbKeyRight Then
    Call Resalta(Me.txtobservacion)
End If
End Sub

Private Sub TxtCodProducto_KeyPress(KeyAscii As Integer)

 If KeyAscii = 13 Then
    If Trim(Me.TxtCodProducto.Text) = "" Then
     Procedencia = Selecionar
        FrmProducto.Show
     Exit Sub
     End If
    Me.TxtDctoSoles.Text = 0
    Me.TxtDstoporcentaje.Text = 0
    Me.TxtIgv.Text = 0
    Me.txtIgv_Porcentaje.Text = 0
    Me.TxtValoerNeto.Text = 0
    Me.TxtPrecioVenta.Text = 0
    Me.txtisc.Text = 0
    Me.TxtIvap.Text = 0
    Me.txtOtros.Text = 0
    Me.txtvalorventa.Text = 0
    Me.TxtventaHoy.Text = 0#
    Me.TxtTotalDescuento.Text = 0
    Me.TxtUnitario.Text = 0
    Me.TxtCostoHoy.Text = 0
    Me.TxtventaHoy.Text = 0
    
    If Me.chkigv.Value = 1 Then
        Me.chkigv.Value = 0
    End If
    
    If KEY_BARRAS = "si" Then
        strCadena = "SELECT B.cod_barra,P.nombre_prod,P.precio_compra,P.precio_venta,U.abreviatura,B.id_producto FROM producto_barras B,producto P,unidad U WHERE B.id_producto=P.id_producto AND B.ruc='" & KEY_RUC & "' AND P.ruc='" & KEY_RUC & "' AND P.id_unidad=U.id_und AND U.id_usu='" & KEY_RUC & "' AND B.cod_barra='" & Trim(Me.TxtCodProducto.Text) & "'"
    Else
      Me.TxtCodProducto.Text = formato_item(Trim(Me.TxtCodProducto.Text), 5)
      strCadena = "SELECT A.id_producto,P.nombre_prod,U.descripcion as abreviatura,A.stock,A.precio_compra,A.precio_venta FROM almacen_producto A,producto P,unidad U WHERE A.id_producto=P.id_producto AND A.ruc='" & KEY_RUC & "' AND P.ruc='" & KEY_RUC & "' AND P.id_unidad=U.id_und AND U.id_usu='" & KEY_RUC & "' AND A.id_alm='" & Trim(FrmCompras.DtcAlmacen.BoundText) & "' AND A.id_producto='" & Trim(Me.TxtCodProducto.Text) & "'"
  End If
     
     
    
       Call ConfiguraRst(strCadena)
    If rst.RecordCount > 0 Then
        codigoP = rst("id_producto")
        Me.TxtDescripcionProducto.Text = UCase(rst("nombre_prod"))
        Me.txtCosto.Text = rst("precio_compra")
        Me.txtPrecioVentaAnt.Text = rst("precio_venta")
        Me.TxtCostoAnt.Text = rst("precio_compra")
        
        
        If rst("precio_compra") > 0 Then
            Me.TxtUtilidadAnt.Text = Format((rst("precio_venta") - rst("precio_compra")) * 100 / rst("precio_compra"), "#,##0.00")
        End If
        'Me.TxtventaHoy.text = rst("precio_venta")
        Me.txtunidad.Text = rst("abreviatura")
        Me.txtcantidad.Text = 0
        Me.TxtUnidades.Text = 1
        Call Resalta(Me.txtcantidad)
        Set rst = Nothing
        
    Else
        Procedencia = Selecionar
        FrmProducto.Show
    End If
    
End If
End Sub

Private Sub TxtDireccion_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Call Me.DtTipoCompra.SetFocus
End If
End Sub


Private Sub Llenar_Temporal()
'Dim RstTemporal As New ADODB.Recordset
'Dim rstDetalle As New ADODB.Recordset
'Dim i As Integer
'StrCadena = "SELECT * FROM Detalle_DocumentoCompra WHERE (cDocumentoCompra='" & Trim(Me.TxtNumero_guia.Text) & "' AND doc_cod='" & Trim(Me.DtcComprobanteGuia.BoundText) & "' AND " & _
'"sSerie='" & Trim(Me.TxtSeri_guia.Text) & "') "
'rstDetalle.Open StrCadena, CnBd, adOpenKeyset, adLockOptimistic
'StrCadena = "SELECT * FROM Temporal_Compras"
'RstTemporal.Open StrCadena, CnBd, adOpenKeyset, adLockOptimistic
'rstDetalle.MoveFirst

 'For i = 0 To rstDetalle.RecordCount - 1
  ' StrCadena = "SELECT cTemporal FROM Temporal_Compras ORDER BY cTemporal DESC "
   ' RstTemporal.AddNew
    'RstTemporal.Fields(0) = GeneraCodTemporal
    'RstTemporal.Fields(1) = Trim(Me.TxtNumeroDoc.Text)
    ''RstTemporal.Fields(2) = Trim(Me.DtcTipoDoc.BoundText)
    'RstTemporal.Fields(3) = Trim(Me.TxtSerie.Text)
    'RstTemporal.Fields(4) = rstDetalle.Fields(4)
    'RstTemporal.Fields(5) = rstDetalle.Fields(5)
    'RstTemporal.Fields(6) = rstDetalle.Fields(6)
    'RstTemporal.Fields(7) = rstDetalle.Fields(7)
    'RstTemporal.Update
    'rstDetalle.MoveNext
       
 'Next i
'Set RstTemporal = Nothing
'Set rstDetalle = Nothing
End Sub

Private Sub TxtNumeroDoc_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
       Me.TxtNumeroDoc.Text = formato_item(Me.TxtNumeroDoc.Text, 8)
       Me.TxtFecha_emision.SetFocus
        'Call llenarGrid_det(Me.HfdDetalle, "", "", "")
End If

End Sub


Public Sub buscar_comprobante(Optional idCompra As Double)
On Error GoTo Validar
    Me.TxtIdCompra.Text = idCompra
    Me.TxtNumeroDoc.Text = FormatosCeros(Me.TxtNumeroDoc.Text, 8)
    strCadena = "SELECT * FROM movimiento_compra WHERE (numero='" & Trim(Me.TxtNumeroDoc.Text) & "' AND serie='" & Trim(Me.TxtSerie.Text) & "' AND id_doc='" & Trim(Me.DtcTipoDoc.BoundText) & "' AND ruc='" & KEY_RUC & "' AND id_proveedor='" & Trim(Me.TxtRuc.Text) & "')"
    If FrmBusquedaCompras.Procedencia = buscar Then
        strCadena = "SELECT * FROM movimiento_compra WHERE id_compra='" & idCompra & "' AND ruc='" & KEY_RUC & "'"
        FrmBusquedaCompras.Procedencia = Neutro
    End If
    Call ConfiguraRst(strCadena)
    If rst.RecordCount < 1 Then
        strCadena = "SELECT * FROM movimiento_compra_temporal WHERE (serie='" & Trim(Me.TxtSerie.Text) & "' AND id_doc='" & Trim(Me.DtcTipoDoc.BoundText) & "' AND dni_save='" & KEY_USUARIO & "' AND ruc='" & KEY_RUC & "')"
        Call ConfiguraRst(strCadena)
        If rst.RecordCount > 0 Then
        Call llenarGrid_det(Me.HfdDetalle, Me.TxtNumeroDoc.Text, Me.DtcTipoDoc.BoundText, Me.TxtSerie.Text)
        Me.TlbGrabar.Buttons(KEY_SAVE).Enabled = True
        End If
        Set rst = Nothing
        
        
        
        'Me.TxtRuc.text = "00000000"
        Me.TxtProveedor.Text = "PUBLICO EN GENERAL"
        Me.txtdireccion.Text = KEY_DIR_PUBLIC
        If Trim(Me.DtcTipoDoc.BoundText) = "0007" Then
            Me.DtcRelacionado.SetFocus
        Else
            Call Resalta(Me.TxtRuc)
        End If
        'ProcendenciaGuia = NuevaGuia
  
    Else
        
        
        
     If FrmListadoFacturasCompra.Procedencia = buscar Then
        FrmListadoFacturasCompra.Procedencia = Neutro
        GoTo saltara
     End If
     
    ' If MsgBox("Comprobante ya Registrado !!" + Chr(13) + Chr(13) + "SI  ..... Para Visualizarlo" + Chr(13) + "NO ..... Para Crear Nuevo Comprobante", vbQuestion + vbYesNo, KEY_EMPRESA) = vbYes Then
       If idCompra = 0 Then
            idCompra = rst("id_compra")
        End If
       If rst("anulado") = "si" Then
            Me.lblAnulado.Visible = True
        Else
            Me.lblAnulado.Visible = False
        
        End If
saltara:
        Me.DtcAlmacen.BoundText = rst("id_alm")
        Me.DtTipoCompra.BoundText = rst("id_tipo_compra")
        Me.DtTipoCompra.Locked = True
        Me.DtcMoneda.BoundText = rst("id_moneda")
        Me.DtcMoneda.Locked = True
        Me.TxtTc.Text = rst("tc")
        '----- datos dua
       


        
        Me.txtAñoFabricacion.Text = rst("anio_fabricacion")
        Me.txtAñoFabricacion.Locked = True
        Me.txtnumero_dua.Text = rst("numero_dua")
        Me.txtnumero_dua.Locked = True
        Me.TxtAnioDua.Text = rst("anio_dua")
        Me.TxtAnioDua.Locked = True
        txtañomodelo.Text = rst("anio_modelo")
        Me.txtañomodelo.Locked = True
        '------ fin datos dua
        
        Me.dtpFechaRegistro.Value = rst("fecha_registro")
        Me.TxtFecha_emision.Text = CVDate(rst("fecha_emision"))
        Me.txtfecha_Vencimiento.Text = CVDate(rst("fecha_cancelacion"))
        If rst("percepcion") > 0 Then
            Me.ChkPercepcion.Value = 1
            Me.TxtPecepcion.Text = Format(rst("percepcion"), "###0.00")
        Else
            Me.ChkPercepcion.Value = 0
        End If
        
        
        Me.DtcPeriodo.BoundText = rst("id_periodo")
        
        Call LlenarDatosCliente(idCompra)
        Call llenarGrid_Comprobante(Me.HfdDetalle, idCompra)
        Call VerificaAnulado(idCompra)
        Call otros_gastos(idCompra)
        Me.Txtdoc_cod.Text = Me.DtcTipoDoc.BoundText
        Me.TxtSeriaGuardada.Text = Me.TxtSerie.Text
        Me.TxtNumeroGuardado.Text = Me.TxtNumeroDoc.Text
        Me.TxtAlmacenGuardado.Text = Me.DtcAlmacen.BoundText
        Me.TxtProveedorGuardado.Text = Me.TxtRuc.Text
        Me.DtcDocumento.Enabled = False
        Me.TxtSerieG.Enabled = False
        Me.TxtNumeroG.Enabled = False
        Me.DtcTipoDoc.Enabled = False
        Me.TxtSerie.Enabled = False
        Me.TxtNumeroDoc.Enabled = False
        Me.TxtCodProducto.Enabled = False
        Me.TxtDescripcionProducto.Enabled = False
        Me.cmdagregar.Enabled = False
        Me.CmdQuitar.Enabled = False
        
        Me.TlbAcciones.Buttons(KEY_DELETE).Enabled = True
        Me.TlbGrabar.Buttons(KEY_REVERTIR).Enabled = True
        Me.txtcantidad.Enabled = False
        Set rst = Nothing
    'Else
   ' Call Resalta(Me.TxtRuc)
    'End If
    End If
    
    
    Exit Sub
Validar:
        MsgBox "Ocurrio un problema en la lectura del comprobante", vbInformation
End Sub
Public Sub otros_gastos(ByVal id_compra As Double)
strCadena = "SELECT sum(monto) FROM movimiento_compra_gasto WHERE id_compra='" & id_compra & "' AND ruc='" & KEY_RUC & "'"
Call ConfiguraRstT(strCadena)
If IsNull(rstT(0)) = False Then
    Me.lblgastos.Text = Format(rstT(0), "###0.00")
Else
    Me.lblgastos.Text = Format(0, "###0.00")
End If
strCadena = "SELECT sum(ad_valorem+sobretasa+isc+igv+ipm+serv_despacho+percepcion_igv+derecho_especifico+almacenaje_descarga+gastos_operativos+terminal+gremios_maritimos+cias_navieras_gastos+conduccion+gastos_despacho+flete+certifi_gases+comision+igv_comision) FROM movimiento_compra_importacion WHERE id_compra='" & id_compra & "' AND ruc='" & KEY_RUC & "'"
Call ConfiguraRstT(strCadena)
If IsNull(rstT(0)) = False Then
    Me.lblImportacion.Text = Format(rstT(0), "###0.00")
Else
    Me.lblImportacion.Text = Format(0, "###0.00")
End If



End Sub

Private Sub LlenarDatosCliente(ByVal idCompra As Double)

strCadena = "SELECT * FROM persona WHERE dni='" & Trim(Me.TxtRuc.Text) & "'"
Call ConfiguraRstT(strCadena)
    
        If rstT.RecordCount > 0 Then
        Me.TxtProveedor.Text = rstT("nombre_completo")
        Me.txtdireccion.Text = rstT("direccion")
        
    End If
  Set rstT = Nothing
End Sub
Private Sub TxtObservacion_KeyPress(KeyAscii As Integer)
Call Mayusculas(KeyAscii)
If KeyAscii = 13 Then
    If Me.TxtCodProducto.Enabled = True Then
        Call Resalta(Me.TxtCodProducto)
    End If
    
End If
End Sub



Private Sub TxtPrecio_KeyDown(KeyCode As Integer, Shift As Integer)
If KeyCode = vbKeyLeft Then
        Call Resalta(Me.TxtDescripcionProducto)
       
End If
If KeyCode = vbKeyRight Then
     Me.cmdagregar.SetFocus
End If
End Sub

Private Sub txtPrecio_KeyPress(KeyAscii As Integer)
Dim TotalP As Single
If KeyAscii = 13 Then
        
       ' TotalP = Val(Me.TxtCantidad.Text) * Val(Me.TxtPrecio.Text)
        'Me.LblTotalParcial.Text = Format(TotalP, "#,##0.000")
        Me.cmdagregar.SetFocus
End If
End Sub
Private Sub Save()
'On Error GoTo salir
Dim i As Integer
Dim CodReferencia As String, cod_identidad As String * 1
Dim tSaldo As Double
Dim TotalFactura As Double
Dim ValorCompra As Double
Dim igv As Double
Dim Descuento As Single
Dim percepcion As Single
Dim rstVerifica As New ADODB.Recordset
Dim Ordencompra As Double


If IsDate(CVDate(Me.TxtFecha_emision.Text)) = False Then
   Me.TxtFecha_emision.Text = CVDate(KEY_FECHA)
End If
If IsDate(Me.txtfecha_Vencimiento.Text) = False Then
   Me.txtfecha_Vencimiento.Text = CVDate(KEY_FECHA)
End If



TotalFactura = Val(Me.lblTotal.Text) + Val(Me.TxtPecepcion.Text)
If Len(Trim(Me.TxtRuc.Text)) = 8 Then
    cod_identidad = 1
End If
If Len(Trim(Me.TxtRuc.Text)) = 11 Then
    cod_identidad = 6
End If
If Len(Trim(Me.TxtRuc.Text)) <> 8 And Len(Trim(Me.TxtRuc.Text)) <> 11 Then
    cod_identidad = 0
End If
ValorCompra = Val(Me.LblValorVenta.Text)
igv = Val(Me.LblIgv.Text)
Descuento = Val(Me.lblDescuento.Text)
If Me.ChkPercepcion.Value = 1 Then
    percepcion = Me.TxtPecepcion.Text
Else
    percepcion = 0
End If

If Me.DtcTipoDoc.BoundText = "0091" Then
    GoTo esquivar
End If
If (Trim(Me.TxtRuc.Text) = "" Or Trim(Me.TxtProveedor.Text) = "") Then
    MsgBox "INGRESE UN PROVEEDOR DE LA LISTA DE PROVEEDORES", vbInformation, "Documento No Guardado"
    Call Resalta(TxtRuc)
    Exit Sub
End If

If Val(Me.TxtNumeroDoc.Text) <= 0 Then
    MsgBox "INGRESE UN COMPROBANTE VALIDO", vbInformation, "Mensaje para el Usuario"
    Call Resalta(Me.TxtSerie)
    Exit Sub
End If
esquivar:
'01----------------guardar en Documento Compra---------------------
If rever = True Then
strCadena = "SELECT * FROM movimiento_compra WHERE numero='" & Trim(Me.TxtNumeroGuardado.Text) & "' AND serie='" & Trim(Me.TxtSeriaGuardada.Text) & "' " & _
" AND id_doc='" & Trim(Me.Txtdoc_cod.Text) & "' AND  id_alm='" & Trim(Me.TxtAlmacenGuardado.Text) & "' AND id_proveedor='" & Trim(Me.TxtProveedorGuardado.Text) & "' AND ruc='" & KEY_RUC & "'"
Else
strCadena = "SELECT * FROM movimiento_compra WHERE numero='" & Trim(Me.TxtNumeroDoc.Text) & "' AND serie='" & Trim(Me.TxtSerie.Text) & "' " & _
" AND id_doc='" & Trim(Me.DtcTipoDoc.BoundText) & "' AND  id_alm='" & Trim(Me.DtcAlmacen.BoundText) & "' AND id_proveedor='" & Trim(Me.TxtRuc.Text) & "' AND ruc='" & KEY_RUC & "'"
End If


Call ConfiguraRst(strCadena)
If rst.RecordCount > 0 Then
   idCompra = rst("id_compra")
    If MsgBox("ESTA SEGURO DE MODIFICAR ESTE COMPROBANTE DE COMPRA", vbQuestion + vbYesNo, KEY_EMPRESA) = vbYes Then
    
    If (Trim(Me.Txtdoc_cod.Text) <> Trim(Me.DtcTipoDoc.BoundText) Or Trim(Me.TxtSeriaGuardada.Text) <> Trim(Me.TxtSerie.Text) Or Trim(Me.TxtNumeroGuardado.Text) <> Trim(Me.TxtNumeroDoc.Text) Or Trim(Me.TxtProveedorGuardado.Text) <> Trim(Me.TxtRuc.Text)) Then
        strCadena = "SELECT * FROM movimiento_compra WHERE numero='" & Trim(Me.TxtNumeroDoc.Text) & "' AND serie='" & Trim(Me.TxtSerie.Text) & "' " & _
        " AND id_doc='" & Trim(Me.DtcTipoDoc.BoundText) & "' AND  id_alm='" & Trim(Me.DtcAlmacen.BoundText) & "' AND id_proveedor='" & Trim(TxtRuc.Text) & "' and ruc='" & KEY_RUC & "'"
        rstVerifica.Open strCadena, CnBd, adOpenKeyset, adLockOptimistic
        If rstVerifica.RecordCount > 0 Then
            MsgBox "Imposible Grabar Este Documento ya esta Registrado para Este Proveedor", vbInformation, KEY_EMPRESA
            Set rstVerifica = Nothing
            Exit Sub
        End If
        Set rstVerifica = Nothing
    End If
    
     If Me.TxtSerieG.Text <> "" And Me.TxtNumeroG.Text <> "" Then
        strCadena = "SELECT * FROM OrdenCompra WHERE doc_cod='0110' AND serie='" & Trim(Me.TxtSerieG.Text) & "' AND numero='" & Trim(Me.TxtNumeroG.Text) & "'"
        Call ConfiguraRstT(strCadena)
        If rstT.RecordCount > 0 Then
            Ordencompra = rstT("idOrden")
        Else
            Ordencompra = 0
        End If
     End If
     
     strCadena = "UPDATE movimiento_compra SET fecha_emision='" & Format(CVDate(Me.TxtFecha_emision.Text), "YYYY-mm-dd") & "',fecha_cancelacion='" & Format(CVDate(Me.txtfecha_Vencimiento.Text), "YYYY-mm-dd") & "',id_tipo_compra='" & Me.DtTipoCompra.BoundText & "', " & _
     "id_moneda='" & Me.DtcMoneda.BoundText & "',anio_fabricacion='" & Trim(Me.txtAñoFabricacion.Text) & "',numero_dua='" & Trim(Me.txtnumero_dua.Text) & "',id_mes='" & formato_item(Month(KEY_FECHA), 2) & "',id_anio='" & Year(KEY_FECHA) & "',id_alm='" & Me.DtcAlmacen.BoundText & "',id_doc='" & Me.DtcTipoDoc.BoundText & "'," & _
     "serie='" & Me.TxtSerie.Text & "',numero='" & Me.TxtNumeroDoc.Text & "',tipo_doc_identidad='" & cod_identidad & "',id_proveedor='" & Me.TxtRuc.Text & "',anio_modelo='" & Trim(Me.txtañomodelo.Text) & "',anio_dua='" & Trim(Me.TxtAnioDua.Text) & "',nproveedor='" & Trim(Me.TxtProveedor.Text) & "'," & _
     "tc='" & Val(Me.TxtTc.Text) & "',valor_venta='" & Val(Me.LblValorVenta.Text) & "',igv='" & Val(Me.LblIgv.Text) & "',isc='" & Val(Me.lblISC.Text) & "',percepcion='" & Val(Me.TxtPecepcion.Text) & "',exonerado='" & Val(Me.lblExonerado.Text) & "',total='" & Val(Me.lblTotal.Text) & "',saldo='" & Val(Me.lblTotal.Text) & "',anulado='no' WHERE id_compra='" & idCompra & "' AND ruc='" & KEY_RUC & "'"
     CnBd.Execute (strCadena)
     
     
     strCadena = "UPDATE movimiento_compra_temporal SET numero='" & Trim(Me.TxtNumeroDoc.Text) & "',id_doc='" & Trim(Me.DtcTipoDoc.BoundText) & "',serie='" & Trim(Me.TxtSerie.Text) & "'" & _
     " WHERE numero='" & Trim(Me.TxtNumeroGuardado.Text) & "' AND serie='" & Trim(Me.TxtSeriaGuardada.Text) & "' AND id_doc='" & Trim(Me.Txtdoc_cod.Text) & "' AND dni_save='" & KEY_USUARIO & "' and ruc='" & KEY_RUC & "'"
     CnBd.Execute (strCadena)
     
     
     
     
     strCadena = "DELETE FROM movimiento_compra_detalle WHERE id_compra='" & idCompra & "' AND ruc='" & KEY_RUC & "'"
     CnBd.Execute (strCadena)
     Call SaveDetalleDocumentoCompra(idCompra)
     
     strCadena = "SELECT * FROM imp_producto_detalle_temp WHERE id_compra='" & idCompra & "'"
     Call ConfiguraRstZ(strCadena)
     If rstZ.RecordCount > 0 Then
        rstZ.MoveFirst
        For m = 0 To rstZ.RecordCount - 1
            strCadena = "UPDATE imp_producto_detalle SET  serie='" & rstZ("serie") & "',id_estado='" & rstZ("id_estado") & "',id_estado_detalle='" & rstZ("id_estado_detalle") & "',id_alm='" & rstZ("id_alm") & "',anio_fabricacion='" & Trim(Me.txtAñoFabricacion.Text) & "',anio_contenedor='" & Trim(Me.TxtAnioDua.Text) & "',nro_contenedor='" & Trim(Me.txtnumero_dua.Text) & "',nro_chasis='" & rstZ("nro_chasis") & "',nro_motor='" & rstZ("nro_motor") & "',anio_modelo='" & Trim(Me.TxtAnioDua.Text) & "',item='" & rstZ("item") & "',serie_asignada='" & rstZ("serie_asignada") & "',vendido='" & rstZ("vendido") & "' WHERE id_compra='" & idCompra & "' and id_orden='" & rstZ("id_orden") & "' and id_producto='" & rstZ("id_producto") & "'  "
            CnBd.Execute (strCadena)
             
            rstZ.MoveNext
        Next m
     End If
     
     strCadena = "DELETE FROM imp_producto_detalle_temp where id_compra='" & idCompra & "'"
     CnBd.Execute (strCadena)
     
     
     Me.TxtCodProducto.Enabled = False
     Me.TxtDescripcionProducto.Enabled = False
     Me.txtcantidad.Enabled = False
     Me.txtCosto.Enabled = False
     Me.cmdagregar.Enabled = False
     Me.CmdQuitar.Enabled = False
     
     Me.TxtAnioDua.Locked = True
     Me.txtAñoFabricacion.Locked = True
     Me.txtañomodelo.Locked = True
     Me.txtnumero_dua.Locked = True
     
     Me.TlbGrabar.Buttons(KEY_SAVE).Enabled = False
     Me.TlbGrabar.Buttons(KEY_REVERTIR).Enabled = True
     Me.TlbGrabar.Buttons(KEY_PRINT).Enabled = False
     rever = False
     Exit Sub
     Else
        Exit Sub
   End If
    rever = False
 
End If
        
        If KEY_CONTABILIDAD = "si" Then
           If put_verifica_cuenta_contable(Me.DtcTipoDoc.BoundText, Trim(Me.TxtSerie.Text), Trim(Me.TxtNumeroDoc.Text)) = False Then
              Exit Sub
           End If
        End If
        

        
        strCadena = "P_insert_compra_iii('" & Me.DtcTipoDoc.BoundText & "','" & Me.DtcAlmacen.BoundText & "','" & Format(CVDate(Me.TxtFecha_emision.Text), "YYYY-mm-dd") & "','" & Format(CVDate(Me.txtfecha_Vencimiento.Text), "YYYY-mm-dd") & "','02'," & _
        "'" & Me.DtTipoCompra.BoundText & "','','" & Me.DtcMoneda.BoundText & "','" & formato_item(Month(KEY_FECHA), 2) & "','" & Year(KEY_FECHA) & "','" & Trim(Me.TxtSerie.Text) & "'," & _
        "'" & Format(Trim(Me.TxtNumeroDoc.Text), "00000000") & "','" & cod_identidad & "','" & Trim(Me.TxtRuc.Text) & "','" & UCase(Me.TxtProveedor.Text) & "','" & Trim(Me.TxtTc.Text) & "'," & _
        "'0','" & Val(Me.LblValorVenta.Text) & "','" & Val(Me.LblIgv.Text) & "','" & Val(Me.lblISC.Text) & "','0','" & Val(Me.TxtPecepcion.Text) & "','0','" & Val(Me.lblExonerado.Text) & "','0','" & Val(Me.lblTotal.Text) & "','" & Val(Me.lblTotal.Text) & "','" & KEY_USUARIO & "','" & Trim(Me.txtobservacion.Text) & "','" & Me.DtcTipo.BoundText & "','" & Me.DtcPeriodo.BoundText & "','" & KEY_RUC & "')"
        CnBd.Execute (strCadena)
        
        id_compra = LastRegistroRUC("movimiento_compra", "id_compra")
        Me.TxtIdCompra.Text = id_compra
        strCadena = "p_update_proveedor('" & Trim(Me.TxtRuc.Text) & "','" & KEY_RUC & "')"
        CnBd.Execute (strCadena)
        
        

        strCadena = "UPDATE movimiento_compra SET  fecha_registro=CURDATE() ,`anio_fabricacion`='" & Trim(Me.txtAñoFabricacion.Text) & "',`numero_dua`='" & Trim(Me.txtnumero_dua.Text) & "',`anio_modelo`='" & Me.TxtAnioDua.Text & "',anio_dua='" & Trim(Me.TxtAnioDua.Text) & "' WHERE id_compra='" & Val(Me.TxtIdCompra.Text) & "'  and ruc='" & KEY_RUC & "'"
        CnBd.Execute (strCadena)
        
        
        
        Me.cmdReload.Visible = True
        
        'NOTA DE CREDITO
        If Me.DtcTipoDoc.BoundText = "0007" Then
            strCadena = "UPDATE movimiento_compra SET valor_venta='" & Val(Me.LblValorVenta.Text) * -1 & "',igv='" & Val(Me.LblIgv.Text) * -1 & "',isc='" & Val(Me.lblISC.Text) * -1 & "',percepcion='" & Val(Me.TxtPecepcion.Text) * -1 & "',exonerado='" & Val(Me.lblExonerado.Text) * -1 & "',total='" & Val(Me.lblTotal.Text) * -1 & "',fecha_fact='" & Format(Me.TxtFechaEmision.Text, "YYYY-mm-dd") & "',id_doc_fact='" & Me.DtcRelacionado.BoundText & "',serie_fact='" & Trim(Me.TxtSerieR.Text) & "',numero_fact='" & Trim(Me.TxtNumeroR.Text) & "' WHERE id_compra='" & id_compra & "' AND ruc='" & KEY_RUC & "'"
            CnBd.Execute (strCadena)
             
        End If
        
        If Me.DtTipoCompra.BoundText = "01" Then
            strCadena = "INSERT INTO movimiento_compra_importacion(id_compra,ruc)VALUES('" & id_compra & "','" & KEY_RUC & "')"
            CnBd.Execute (strCadena)
            
        End If
'02----------------guardar en detalle documento Compra-----------
 Call SaveDetalleDocumentoCompra(id_compra)
 If KEY_CONTABILIDAD = "si" Then
    strCadena = "p_insert_compra_emitido('" & id_compra & "')"
    Call Execute_Sql(strCadena)
 End If
 If Trim(Me.DtcTipoDoc.BoundText) = "0089" Then
    num = formato_item(Val(Me.TxtNumeroDoc.Text) + 1, 6)
    strCadena = "UPDATE almacen_comprobante SET numero='" & num & "' WHERE id_doc='" & Me.DtcTipoDoc.BoundText & "' AND serie='" & Trim(Me.TxtSerie.Text) & "' AND id_alm='" & KEY_ALM & "' AND ruc='" & KEY_RUC & "'"
    CnBd.Execute (strCadena)
    
 End If
'02-------------------------------------------------------------
                Me.TxtCodProducto.Enabled = False
                Me.TxtDescripcionProducto.Enabled = False
                Me.txtcantidad.Enabled = False
                Me.txtCosto.Enabled = False
                 Me.cmdagregar.Enabled = False
                Me.CmdQuitar.Enabled = False
                Me.TlbGrabar.Buttons(KEY_SAVE).Enabled = False
                Me.TlbGrabar.Buttons(KEY_PRINT).Enabled = False
                Exit Sub
'salir:
    MsgBox "No se Guardo este Documento, Disculpe las Molestias", vbInformation, KEY_EMPRESA


End Sub
Private Sub save_seriales(ByVal in_compra As String, ByVal in_detalle_compra As String, ByVal in_producto As String, ByVal in_cantidad As Integer)
strCadena = "SELECT * FROM producto p, linea l WHERE l.produccion='si' and  p.id_producto='" & in_producto & "' and  p.id_linea=l.id_linea and p.ruc=l.id_usu and p.ruc='" & KEY_RUC & "'"
Call ConfiguraRst(strCadena)
If rst.RecordCount > 0 Then
    For i = 0 To in_cantidad - 1
        strCadena = "INSERT INTO imp_producto_detalle (`id_compra`,`id_detalle_compra`,`id_producto`,`id_alm`, " & _
        "`anio_fabricacion`,`anio_contenedor`,`nro_contenedor`,`anio_modelo`,`ruc`)VALUES " & _
        "('" & in_compra & "','" & in_detalle_compra & "','" & in_producto & "','" & KEY_ALM & "','" & Trim(Me.txtAñoFabricacion.Text) & "'," & _
        "'" & Trim(Me.TxtAnioDua.Text) & "','" & Trim(Me.txtnumero_dua.Text) & "','" & Trim(Me.txtañomodelo.Text) & "','" & KEY_RUC & "')"
        CnBd.Execute (strCadena)
    Next i
End If
End Sub
Private Sub SaveDetalleDocumentoCompra(ByVal id_compra As Double)
'******************************* INICIO PROCESO*************************
 strCadena = "SELECT * FROM movimiento_compra_temporal WHERE numero='" & Trim(Me.TxtNumeroDoc.Text) & "' AND id_doc='" & Trim(Me.DtcTipoDoc.BoundText) & "' AND serie='" & Trim(Me.TxtSerie.Text) & "' AND ruc='" & KEY_RUC & "' AND dni_save='" & KEY_USUARIO & "' ORDER BY id_temporal ASC"
    Call ConfiguraRstT(strCadena)
    If rstT.RecordCount > 0 Then
       rstT.MoveFirst
       For i = 0 To rstT.RecordCount - 1
           strCadena = "INSERT INTO movimiento_compra_detalle(id_compra,id_producto,cantidad,c_unitario,dsto_soles,dsto_procentaje,total_descuento,valor_neto,isc,igv,ivap,otros,percepcion, " & _
           "valor_venta,exonerado,total,p_venta,p_costo,id_alm,ruc) VALUES ('" & id_compra & "','" & rstT("id_producto") & "','" & rstT("cantidad") & "','" & rstT("c_unitario") & "'," & _
           "'" & rstT("dsto_soles") & "','" & rstT("dsto_procentaje") & "','" & rstT("total_descuento") & "','" & rstT("valor_neto") & "','" & rstT("isc") & "','" & rstT("igv") & "', " & _
           "'" & rstT("ivap") & "','" & rstT("otros") & "','" & rstT("percepcion") & "','" & rstT("valor_venta") & "','" & rstT("exonerado") & "','" & rstT("precio_venta") & "','" & rstT("p_venta") & "','" & rstT("p_costo") & "','" & rstT("id_alm") & "','" & KEY_RUC & "')"
           CnBd.Execute (strCadena)
           strCadena = "SELECT * FROM movimiento_compra_detalle WHERE ruc='" & KEY_RUC & "' ORDER BY id_detalle_compra DESC LIMIT 1"
           Call ConfiguraRst(strCadena)
           If rst.RecordCount > 0 Then
            Call save_seriales(id_compra, rst("id_detalle_compra"), rstT("id_producto"), rstT("cantidad"))
          End If
           rstT.MoveNext
        Next i
    End If
    
    strCadena = "DELETE FROM movimiento_compra_temporal WHERE (numero='" & Trim(Me.TxtNumeroDoc.Text) & "' AND id_doc='" & Trim(Me.DtcTipoDoc.BoundText) & "' AND serie='" & Trim(Me.TxtSerie.Text) & "' AND ruc='" & KEY_RUC & "' AND dni_save='" & KEY_USUARIO & "')"
    CnBd.Execute (strCadena)
    
'******************************* FINISH PROCESO*************************
End Sub
Private Function CodigoDetalleCompra() As String
    strCadena = "SELECT int_det_documentoCompra FROM Detalle_DocumentoCompra ORDER BY int_det_documentoCompra DESC"
    Call ConfiguraRst(strCadena)
    CodigoDetalleCompra = GeneraCodigos()
    Set rst = Nothing
End Function
Private Sub save_preciocompra(ByVal codigo As String, ByVal precio As Double)
Dim consecutivo As String
strCadena = "SELECT * FROM Producto_precio WHERE cProducto='" & Trim(codigo) & "'"
Call ConfiguraRst(strCadena)
consecutivo = GeneraCodigo(10)



End Sub

Private Sub txtRedondeo_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
Dim redondeo As Single
Dim Total As Single
redondeo = Val(Me.txtRedondeo.Text)
Total = Val(Me.LblIgv.Text) + Val(Me.LblValorVenta.Text) + redondeo
Me.lblTotal.Text = Format(Total, "###0.00")
End If
End Sub

Private Sub txtruc_KeyPress(KeyAscii As Integer)
On Error GoTo errohandler
 If KeyAscii = 13 Then
   Call buscarcliente

End If
Exit Sub
errohandler: MsgBox "Hubo un Error Digite Nuevamente", vbInformation, "Mensaje para el usuario"
End Sub

Private Sub TxtSerie_KeyDown(KeyCode As Integer, Shift As Integer)
If KeyCode = vbKeyLeft Then
        Me.DtcTipoDoc.SetFocus
End If
If KeyCode = vbKeyRight Then
        Call Resalta(Me.TxtNumeroDoc)
End If
End Sub
Private Sub TxtSerie_KeyPress(KeyAscii As Integer)

If KeyAscii = 13 Then
    If (Me.DtcTipoDoc.BoundText = "0089") Then
    Me.TxtSerie.Text = formato_item(Me.TxtSerie.Text, 4)
    strCadena = "SELECT * FROM almacen_comprobante WHERE id_doc='" & Trim(Me.DtcTipoDoc.BoundText) & "' AND id_alm='" & Me.DtcAlmacen.BoundText & "' AND ruc='" & KEY_RUC & "' AND serie='" & Trim(Me.TxtSerie.Text) & "'"
    Call ConfiguraRst(strCadena)
    If rst.RecordCount > 0 Then
        Me.TxtNumeroDoc.Text = formato_item(rst("numero"), 8)
        Call Resalta(Me.TxtRuc)
        End If
    Else
        Me.TxtSerie.Text = formato_item(Me.TxtSerie.Text, 4)
        Call Resalta(Me.TxtNumeroDoc)
    End If
    
        
    End If

End Sub

Private Sub VerificaAnulado(ByVal idCompra As String)
'strCadena = "Select anulado FROM movimiento_compra WHERE  id_compra='" & idCompra & "' AND ruc='" & KEY_RUC & "'"
'Call ConfiguraRstT(strCadena)
'If rst.RecordCount > 0 Then
 '   If Trim(rstT("anulado")) = "si" Then
  '      Me.lblAnulado.Visible = True
        
   '     Me.TlbAcciones.Buttons(KEY_ANULAR).Enabled = False
    '    Me.TlbAcciones.Buttons(KEY_DELETE).Enabled = False
    'Else
     '   Me.TlbAcciones.Buttons(KEY_ANULAR).Enabled = True
    'End If
'End If
'Set rstT = Nothing
End Sub







Private Sub TxtSerieG_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Me.TxtSerieG.Text = formato_item(Me.TxtSerieG.Text, 4)
    Call Resalta(Me.TxtNumeroG)
End If
End Sub

Private Sub txtseriemotor_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Call Resalta(Me.txtitemdua)
End If

End Sub

Private Sub TxtSerieR_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Me.TxtSerieR.Text = FormatosCeros(Me.TxtSerieR, 3)
    Me.TxtNumeroR.SetFocus
End If
End Sub

Private Sub txtTC_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Call Resalta(Me.txtobservacion)
End If
End Sub

Private Sub TxtTotalDescuento_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
        
        Call Resalta(Me.txtisc)
End If
End Sub

Private Sub TxtUnidades_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Call Resalta(Me.TxtUnitario)
End If
End Sub

Private Sub TxtUnitario_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    Dim utilidad As Single
    Dim costo As Single
    Dim venta As Single
    Dim unidades As Single
    
    
    
    
    venta = Val(Me.txtPrecioVentaAnt.Text)
    unidades = Val(Me.TxtUnidades.Text)
    precio_unit = Val(Me.TxtUnitario.Text)
    If Val(Me.TxtUnitario.Text) <= 0 Then
        Call Resalta(Me.TxtUnitario)
        Exit Sub
    End If
    
    If Me.DtcMoneda.BoundText = "00002" And Me.chkConvertir.Value = 1 Then
        Me.TxtUnitario.Text = Format(Val(Me.TxtUnitario.Text) * Val(Me.TxtTc.Text), "###0.0000")
    
    End If
    
     costo = Val(Me.TxtUnitario.Text)
     
     Me.TxtUnitario.Text = Format(costo, "###0.00")
     Me.TxtCostoHoy.Text = Format(costo, "###0.00")
     
    If Me.chkigv.Value = 1 Then
        Me.TxtValoerNeto.Text = Format(Val(Me.txtcantidad.Text) * costo, "###0.00")
        Me.TxtPrecioVenta.Text = Format(Val(Me.txtcantidad.Text) * costo * (1 + KEY_IGV), "###0.00")
        utilidad = 15 '(costo - costo) * 100 / costo
        Me.txtUtilidadhoy.Text = Format(utilidad, "###0.00")
        costo = Val(Me.TxtCostoHoy.Text) * (1 + KEY_IGV)
         Me.TxtCostoHoy.Text = Format(costo, "###0.00")
        utilidad = Val(Me.txtUtilidadhoy.Text)
        venta = costo + costo * utilidad / 100
        Me.TxtventaHoy.Text = Format(venta, "###0.00")
    Else
        Me.TxtValoerNeto.Text = Format(Val(Me.txtcantidad.Text) * costo, "###0.00")
        Me.TxtPrecioVenta.Text = Format(Val(Me.txtcantidad.Text) * costo, "###0.00")
        Me.txtvalorventa.Text = Format(Val(Me.TxtValoerNeto.Text) - Val(Me.TxtTotalDescuento.Text), "##0.00")
        utilidad = 15 '(costo - costo) * 100 / costo
        Me.txtUtilidadhoy.Text = Format(utilidad, "###0.00")
        costo = Val(Me.TxtCostoHoy.Text)
         Me.TxtCostoHoy.Text = Format(costo, "###0.00")
        utilidad = Val(Me.txtUtilidadhoy.Text)
        venta = costo + costo * utilidad / 100
        Me.TxtventaHoy.Text = Format(venta, "###0.00")
    End If
   
    Call Resalta(Me.TxtDctoSoles)
End If




End Sub

Private Sub txtUtilidadhoy_Change()
Dim costo As Single
Dim venta As Single
Dim utilidad As Single
Dim venta_actual As Single


costo = Val(Me.TxtCostoHoy.Text)
utilidad = Val(Me.txtUtilidadhoy.Text)
venta = Val(Me.TxtGastoAdminHoy.Text) + costo + costo * utilidad / 100
If rever = False Then
    Me.TxtventaHoy.Text = Format(venta, "###0.00")
Else
    If Val(Me.TxtCostoHoy.Text) > 0 Then
    Me.TxtventaHoy.Text = Format(Val(Me.TxtCostoHoy.Text) + Val(Me.TxtCostoHoy.Text) * Val(Me.txtUtilidadhoy.Text) / 100, "#,##0.00")
    'Me.txtUtilidadhoy.text = Format(utilidad, "###0.00")
    End If
End If
End Sub

Private Sub txtUtilidadhoy_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    If Val(Me.TxtUnitario.Text) = 0 Or Val(Me.TxtCostoHoy.Text) <> Val(Me.TxtCostoAnt.Text) Then
        If MsgBox("PROMEDIO MOVIL DE COSTOS", vbQuestion + vbYesNo, KEY_EMPRESA) = vbYes Then
           FrmBonificaciones.Show
           Exit Sub
        End If
    End If
    Call Resalta(Me.TxtventaHoy)
End If
End Sub

Private Sub TxtValoerNeto_KeyDown(KeyCode As Integer, Shift As Integer)
 If KeyCode = 37 Then
       Call Resalta(Me.txtisc)
 End If
End Sub

Private Sub TxtValoerNeto_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
Me.TxtValoerNeto.Text = Format(Val(Me.TxtValoerNeto.Text), "###0.00")
    Call Resalta(Me.TxtTotalDescuento)
End If
End Sub

Private Sub TxtventaHoy_KeyPress(KeyAscii As Integer)
Dim costo As Single
Dim utilidad As Single
If KeyAscii = 13 Then
costo = Val(Me.TxtCostoHoy.Text) + Val(Me.TxtGastoAdminHoy.Text)
venta = Val(Me.TxtventaHoy.Text)
If costo > 0 Then
utilidad = (venta - costo) * 100 / costo
Me.txtUtilidadhoy.Text = Format(utilidad, "###0.00")
'If Me.cmdRevertir.Visible = True Then
 '   Me.cmdRevertir.SetFocus
'Else
Me.TxtventaHoy.Text = venta
    Me.cmdagregar.Enabled = True
    Me.cmdagregar.SetFocus
'End If

End If
End If
End Sub



